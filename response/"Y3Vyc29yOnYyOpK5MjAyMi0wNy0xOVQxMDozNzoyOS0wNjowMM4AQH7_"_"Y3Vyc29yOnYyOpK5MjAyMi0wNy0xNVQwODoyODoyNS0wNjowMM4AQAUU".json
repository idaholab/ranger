{
  "discussions": {
    "pageInfo": {
      "hasNextPage": true,
      "endCursor": "Y3Vyc29yOnYyOpK5MjAyMi0wNy0xNVQwODoyODoyNS0wNjowMM4AQAUU"
    },
    "edges": [
      {
        "node": {
          "title": "Issues installing Libmesh on cluster",
          "author": {
            "login": "TheGreatCid"
          },
          "bodyText": "Hi All,\nI am installing Libmesh on a cluster with the following modules activated.\ncmake/3.19.3-rhel8\nPython/3.8.1\nGCC/9.3.0\nMPICH/3.2.1\nOpenMPI/4.0.5-rhel8\n\nI am able to install Petsc without any issues.\nTo install libmesh I am using the update_and_rebuild_libmesh.sh script that comes with MOOSE.\nI am able to configure libmesh, but the script fails when it tries to run make install\nI receive the following error:\nMaking install in include\nmake[1]: Entering directory '/hpc/group/dolbowlab/det12/raccoon/moose/libmesh/build/include'\nMaking install in libmesh\nmake[2]: Entering directory '/hpc/group/dolbowlab/det12/raccoon/moose/libmesh/build/include/libmesh'\nmake  install-am\nmake[3]: Entering directory '/hpc/group/dolbowlab/det12/raccoon/moose/libmesh/build/include/libmesh'\nmake[4]: Entering directory '/hpc/group/dolbowlab/det12/raccoon/moose/libmesh/build/include/libmesh'\nmake[4]: Nothing to be done for 'install-exec-am'.\nmake[4]: Nothing to be done for 'install-data-am'.\nmake[4]: Leaving directory '/hpc/group/dolbowlab/det12/raccoon/moose/libmesh/build/include/libmesh'\nmake[3]: Leaving directory '/hpc/group/dolbowlab/det12/raccoon/moose/libmesh/build/include/libmesh'\nmake[2]: Leaving directory '/hpc/group/dolbowlab/det12/raccoon/moose/libmesh/build/include/libmesh'\nmake[2]: Entering directory '/hpc/group/dolbowlab/det12/raccoon/moose/libmesh/build/include'\nmake[3]: Entering directory '/hpc/group/dolbowlab/det12/raccoon/moose/libmesh/build/include'\nmake[3]: Nothing to be done for 'install-exec-am'.\n /usr/bin/mkdir -p '/usr/local/include/libmesh'\n/usr/bin/mkdir: cannot create directory \u2018/usr/local/include/libmesh\u2019: Permission denied\nmake[3]: *** [Makefile:1150: install-includeHEADERS] Error 1\nmake[3]: Leaving directory '/hpc/group/dolbowlab/det12/raccoon/moose/libmesh/build/include'\nmake[2]: *** [Makefile:1344: install-am] Error 2\nmake[2]: Leaving directory '/hpc/group/dolbowlab/det12/raccoon/moose/libmesh/build/include'\nmake[1]: *** [Makefile:1177: install-recursive] Error 1\nmake[1]: Leaving directory '/hpc/group/dolbowlab/det12/raccoon/moose/libmesh/build/include'\nmake: *** [Makefile:32937: install-recursive] Error 1\n\nLibmesh is trying to write in a directory that I do not have access to.\nIs there any way to avoid this?\nI have run this script successfully on this cluster before, so I am unsure of what has changed in how the script executes.\nThank you in advance!",
          "url": "https://github.com/idaholab/moose/discussions/21596",
          "updatedAt": "2022-07-28T16:21:29Z",
          "publishedAt": "2022-07-15T14:51:40Z",
          "category": {
            "name": "Q&A Getting Started"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\nSo first you should only have one MPI library loaded\nMPICH/3.2.1\nOpenMPI/4.0.5-rhel8\n\nare both MPIs\nThis is odd. What does env return? We're looking for an environment variable that is changing the install path\nGuillaume",
                  "url": "https://github.com/idaholab/moose/discussions/21596#discussioncomment-3157494",
                  "updatedAt": "2022-07-15T14:56:09Z",
                  "publishedAt": "2022-07-15T14:56:07Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "TheGreatCid"
                          },
                          "bodyText": "Ah good point\nHere is the relevant section of env return\nI still have an old Conda install, but it should be deactivated. I don't believe it would interfere with the script.\nCONDA_EXE=/hpc/home/det12/mambaforge3/bin/conda\nSSH_CONNECTION=10.237.17.196 36324 152.3.100.191 22\nMODULES_RUN_QUARANTINE=LD_LIBRARY_PATH LD_PRELOAD\nLANG=en_US.UTF-8\nHISTCONTROL=ignoreboth\nHOSTNAME=dcc-login-02\nCONDA_PREFIX=/hpc/home/det12/mambaforge3\nS_COLORS=auto\n_CE_M=\nwhich_declare=declare -f\nCC=mpicc\nXDG_SESSION_ID=26752\nMODULES_CMD=/usr/share/Modules/libexec/modulecmd.tcl\nUSER=det12\nSELINUX_ROLE_REQUESTED=\nPWD=/hpc/group/dolbowlab/det12/raccoon\nSSH_ASKPASS=/usr/libexec/openssh/gnome-ssh-askpass\nHOME=/hpc/home/det12\nCONDA_PYTHON_EXE=/hpc/home/det12/mambaforge3/bin/python\nSSH_CLIENT=10.237.17.196 36324 22\nF77=mpif77\nSELINUX_LEVEL_REQUESTED=\n_CE_CONDA=\nLOADEDMODULES=\nFC=mpif90\nCONDA_PROMPT_MODIFIER=(base) \nSSH_TTY=/dev/pts/16\nMAIL=/var/spool/mail/det12\nCXX=mpicxx\nTERM=xterm-256color\nSHELL=/bin/bash\nSELINUX_USE_CURRENT_RANGE=\nSHLVL=1\nMANPATH=::/opt/puppetlabs/puppet/share/man\nF90=mpif90\nMODULEPATH=/etc/scl/modulefiles:/opt/apps/modulefiles\nLOGNAME=det12\nDBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/1357470/bus\nXDG_RUNTIME_DIR=/run/user/1357470\nPATH=/hpc/home/det12/mambaforge3/bin:/hpc/home/det12/mambaforge3/condabin:/hpc/home/det12/.local/bin:/hpc/home/det12/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/opt/puppetlabs/bin:/opt/slurm/bin\nPS1=(base) ${debian_chroot:+($debian_chroot)}\\[\\033[01;33m\\]\\u\\[\\033[01;33m\\]@\\[\\033[01;33m\\]\\h\\[\\033[00m\\]:\\[\\033[35m\\]\\w\\[\\033[00m\\]$ \nDEBUGINFOD_URLS=https://debuginfod.centos.org/ \nMODULESHOME=/usr/share/Modules\nCONDA_DEFAULT_ENV=base\nHISTSIZE=1000\nLESSOPEN=||/usr/bin/lesspipe.sh %s",
                          "url": "https://github.com/idaholab/moose/discussions/21596#discussioncomment-3157518",
                          "updatedAt": "2022-07-15T14:59:01Z",
                          "publishedAt": "2022-07-15T14:58:55Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Seems fine.\nwhich mpi ended up being used? Try which mpicc to know",
                          "url": "https://github.com/idaholab/moose/discussions/21596#discussioncomment-3157578",
                          "updatedAt": "2022-07-15T15:06:32Z",
                          "publishedAt": "2022-07-15T15:06:27Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "TheGreatCid"
                          },
                          "bodyText": "I cannot check that since I submitted this as a batch job. So I don't have access to that particular environment anymore.\nI can rerun this which a single mpi module and let you know if that fixed anything.\nWhich module is the preferred one?",
                          "url": "https://github.com/idaholab/moose/discussions/21596#discussioncomment-3157600",
                          "updatedAt": "2022-07-15T15:08:35Z",
                          "publishedAt": "2022-07-15T15:08:35Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "ok make sure to gather the environment then too\nopenmpi is slower but more reliable",
                          "url": "https://github.com/idaholab/moose/discussions/21596#discussioncomment-3157624",
                          "updatedAt": "2022-07-15T15:12:07Z",
                          "publishedAt": "2022-07-15T15:12:02Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "TheGreatCid"
                          },
                          "bodyText": "I just submitted the job\nHere is the environment it is working with\nCONDA_SHLVL=1\nSLURM_MEM_PER_CPU=10240\nLD_LIBRARY_PATH=/opt/apps/rhel8/openmpi-4.0.5/lib:/opt/apps/rhel7/gcc-9.3.0/libexec/gcc/x86_64-pc-linux-gnu/9.3.0:/opt/apps/rhel7/gcc-9.3.0/lib64:/opt/apps/rhel7/compatlib:/opt/apps/rhel7/libffi-3.3/lib64\nLS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:\nCONDA_EXE=/hpc/home/det12/mambaforge3/bin/conda\nSLURM_NODEID=0\nSLURM_TASK_PID=235526\nSSH_CONNECTION=10.237.17.196 36324 152.3.100.191 22\nSLURM_PRIO_PROCESS=0\nMODULES_RUN_QUARANTINE=LD_LIBRARY_PATH LD_PRELOAD\nLANG=en_US.UTF-8\nSLURM_SUBMIT_DIR=/hpc/group/dolbowlab/det12/raccoon\nHISTCONTROL=ignoreboth\nHOSTNAME=dcc-dolbowlab-01\nOLDPWD=/hpc/group/dolbowlab/det12/raccoon/moose\nENVIRONMENT=BATCH\nPATH_modshare=/opt/apps/rhel8/openmpi-4.0.5/bin:1:/opt/apps/rhel8/cmake-3.19.3/bin:1:/hpc/home/det12/.local/bin:1:/hpc/home/det12/bin:1:/usr/bin:1:/usr/share/Modules/bin:1:/usr/local/bin:1:/opt/puppetlabs/bin:1:/hpc/home/det12/mambaforge3/condabin:1:/opt/slurm/bin:1:/opt/apps/rhel7/python-3.8.1/bin:1:/hpc/home/det12/mambaforge3/bin:1:/usr/sbin:1:/usr/local/sbin:1:/opt/apps/rhel7/gcc-9.3.0/bin:1\nLOADEDMODULES_modshare=OpenMPI/4.0.5-rhel8:1:cmake/3.19.3-rhel8:1:GCC/9.3.0:1:Python/3.8.1:1\nPETSC_ARCH=arch-linux-c-opt\nCONDA_PREFIX=/hpc/home/det12/mambaforge3\nSLURM_PROCID=0\nSLURM_JOB_GID=1000000\nSLURM_CPU_BIND=none\nSLURMD_NODENAME=dcc-dolbowlab-01\nSLURM_TASKS_PER_NODE=1\nS_COLORS=auto\nMOOSE_DIR=/hpc/group/dolbowlab/det12/raccoon/moose\n_CE_M=\nwhich_declare=declare -f\nLD_LIBRARY_PATH_modshare=/opt/apps/rhel7/compatlib:1:/opt/apps/rhel8/openmpi-4.0.5/lib:1:/opt/apps/rhel7/libffi-3.3/lib64:1:/opt/apps/rhel7/gcc-9.3.0/libexec/gcc/x86_64-pc-linux-gnu/9.3.0:1:/opt/apps/rhel7/gcc-9.3.0/lib64:1\nCC=mpicc\nXDG_SESSION_ID=26752\nMODULES_CMD=/usr/share/Modules/libexec/modulecmd.tcl\nSLURM_NNODES=1\nUSER=det12\nSELINUX_ROLE_REQUESTED=\nPWD=/hpc/group/dolbowlab/det12/raccoon\nSSH_ASKPASS=/usr/libexec/openssh/gnome-ssh-askpass\nSLURM_JOB_NODELIST=dcc-dolbowlab-01\nMODULES_LMCONFLICT_modshare=Python/3.8.1&Python:1:OpenMPI/4.0.5-rhel8&OpenMPI:1:cmake/3.19.3-rhel8&CMAKE:1:GCC/9.3.0&GCC:1\nHOME=/hpc/home/det12\nSLURM_CLUSTER_NAME=dcc\nCONDA_PYTHON_EXE=/hpc/home/det12/mambaforge3/bin/python\nSLURM_NODELIST=dcc-dolbowlab-01\nSSH_CLIENT=10.237.17.196 36324 22\nSLURM_NTASKS=1\nSELINUX_LEVEL_REQUESTED=\nF77=mpif77\nSLURM_JOB_CPUS_PER_NODE=1\nSLURM_TOPOLOGY_ADDR=dcc-dolbowlab-01\n_LMFILES__modshare=/opt/apps/modulefiles/OpenMPI/4.0.5-rhel8:1:/opt/apps/modulefiles/cmake/3.19.3-rhel8:1:/opt/apps/modulefiles/GCC/9.3.0:1:/opt/apps/modulefiles/Python/3.8.1:1\n_CE_CONDA=\nSLURM_WORKING_CLUSTER=dcc:dcc-sched-01:6817:9472:101\nSLURM_JOB_NAME=make_libmesh\nTMPDIR=/tmp\nSLURM_JOBID=9522116\nSLURM_CONF=/var/spool/slurmd/conf-cache/slurm.conf\nLOADEDMODULES=cmake/3.19.3-rhel8:Python/3.8.1:GCC/9.3.0:OpenMPI/4.0.5-rhel8\nFC=mpif90\nSLURM_NODE_ALIASES=(null)\nSLURM_JOB_QOS=normal\nSLURM_TOPOLOGY_ADDR_PATTERN=node\nCONDA_PROMPT_MODIFIER=(base) \nSSH_TTY=/dev/pts/16\nMODULES_LMCONFLICT=cmake/3.19.3-rhel8&CMAKE:Python/3.8.1&Python:GCC/9.3.0&GCC:OpenMPI/4.0.5-rhel8&OpenMPI\nMAIL=/var/spool/mail/det12\nSLURM_CPUS_ON_NODE=1\nCXX=mpicxx\nSLURM_JOB_NUM_NODES=1\nSHELL=/bin/bash\nTERM=xterm-256color\nSLURM_JOB_UID=1357470\nSLURM_JOB_PARTITION=dolbowlab\nSELINUX_USE_CURRENT_RANGE=\nSLURM_JOB_USER=det12\nSLURM_NPROCS=1\nSHLVL=2\nSLURM_SUBMIT_HOST=dcc-login-02\nSLURM_JOB_ACCOUNT=dolbowlab\nMANPATH=::/opt/puppetlabs/puppet/share/man\nF90=mpif90\nMODULEPATH=/etc/scl/modulefiles:/opt/apps/modulefiles\nSLURM_GTIDS=0\nLOGNAME=det12\nDBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/1357470/bus\nXDG_RUNTIME_DIR=/run/user/1357470\nPATH=/opt/apps/rhel8/openmpi-4.0.5/bin:/opt/apps/rhel7/gcc-9.3.0/bin:/opt/apps/rhel7/python-3.8.1/bin:/opt/apps/rhel8/cmake-3.19.3/bin:/hpc/home/det12/mambaforge3/bin:/hpc/home/det12/mambaforge3/condabin:/hpc/home/det12/.local/bin:/hpc/home/det12/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/opt/puppetlabs/bin:/opt/slurm/bin\nSLURM_JOB_ID=9522116\n_LMFILES_=/opt/apps/modulefiles/cmake/3.19.3-rhel8:/opt/apps/modulefiles/Python/3.8.1:/opt/apps/modulefiles/GCC/9.3.0:/opt/apps/modulefiles/OpenMPI/4.0.5-rhel8\nDEBUGINFOD_URLS=https://debuginfod.centos.org/ \nMODULESHOME=/usr/share/Modules\nCONDA_DEFAULT_ENV=base\nPETSC_DIR=/hpc/group/dolbowlab/det12/petsc\nHISTSIZE=1000\nSLURM_LOCALID=0\nSLURM_WHOLE=1\nLESSOPEN=||/usr/bin/lesspipe.sh %s",
                          "url": "https://github.com/idaholab/moose/discussions/21596#discussioncomment-3157653",
                          "updatedAt": "2022-07-15T15:15:32Z",
                          "publishedAt": "2022-07-15T15:15:30Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "It's picking up another PETSC than the one you installed:\nPETSC_ARCH=arch-linux-c-opt\nPETSC_DIR is set to /hpc/group/dolbowlab/det12/petsc\nYou ll need to set those two to your local PETSC before building libmesh\nPETSC_ARCH=arch-moose\nPETSC_DIR=/path/to/moose/petsc",
                          "url": "https://github.com/idaholab/moose/discussions/21596#discussioncomment-3157690",
                          "updatedAt": "2022-07-15T15:19:48Z",
                          "publishedAt": "2022-07-15T15:19:47Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "TheGreatCid"
                          },
                          "bodyText": "Oh, I should have mentioned that. That is intentional. That version of petsc should work fine with MOOSE.\nHowever, I have run this with the version of petsc in moose and with those environment variables and have run into the same issue that I posted originally. So I don't believe that would fix this particular issue.",
                          "url": "https://github.com/idaholab/moose/discussions/21596#discussioncomment-3157722",
                          "updatedAt": "2022-07-15T15:23:14Z",
                          "publishedAt": "2022-07-15T15:23:13Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "TheGreatCid"
                          },
                          "bodyText": "The libmesh script just failed.\nThe same error occurs, even with having the single MPI module activated. So it was unrelated to that.",
                          "url": "https://github.com/idaholab/moose/discussions/21596#discussioncomment-3158750",
                          "updatedAt": "2022-07-15T18:12:56Z",
                          "publishedAt": "2022-07-15T18:12:56Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "TheGreatCid"
                          },
                          "bodyText": "Does the script normally try to write to /usr/local/include or is that something going awry?",
                          "url": "https://github.com/idaholab/moose/discussions/21596#discussioncomment-3158758",
                          "updatedAt": "2022-07-15T18:14:04Z",
                          "publishedAt": "2022-07-15T18:14:04Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "weirdly it seems like it?\n\nBy default, `make install' will install all the files in\n`/usr/local/bin', `/usr/local/lib' etc.  You can specify\nan installation prefix other than `/usr/local' using `--prefix',\nfor instance `--prefix=$HOME'.\n\ncan you try the prefix?",
                          "url": "https://github.com/idaholab/moose/discussions/21596#discussioncomment-3160158",
                          "updatedAt": "2022-07-16T00:28:58Z",
                          "publishedAt": "2022-07-16T00:28:58Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "PorousFlow and Units",
          "author": {
            "login": "Flolaffel"
          },
          "bodyText": "Hello,\nI have a question regarding units in PorousFlow.\nThe unit system I usually use is mm, 1e3 kg, s, N, MPa.\nInside the FluidProperties-Module all units have to be SI, so m, kg, s, N, Pa. But PorousFlowSingleComponentFluid allows the user to set pressure_unit = MPa. Does that mean FluidProperties stays in SI and only the pressure parameters get multiplied by 10^6? Can I keep my normal unit system with mm and MPa or do I have to look out for anything else? For example is the unit for my permeability still mm^4 afterwards or do I have to change it?",
          "url": "https://github.com/idaholab/moose/discussions/21551",
          "updatedAt": "2022-07-18T21:47:54Z",
          "publishedAt": "2022-07-11T17:09:57Z",
          "category": {
            "name": "Q&A Modules: General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "WilkAndy"
                  },
                  "bodyText": "This is explained fully at https://mooseframework.inl.gov/source/materials/PorousFlowSingleComponentFluid.html .   I'm glad you're using PorousFlow.   What are you modelling?",
                  "url": "https://github.com/idaholab/moose/discussions/21551#discussioncomment-3124298",
                  "updatedAt": "2022-07-11T20:47:52Z",
                  "publishedAt": "2022-07-11T20:47:51Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "Traiwit"
                          },
                          "bodyText": "just a quick question @WilkAndy\nif I use time_unit = years\ndoes this mean my BC [PorousFlowPiecewiseLinearSink] flux_function is in m/years ?\nThanks!",
                          "url": "https://github.com/idaholab/moose/discussions/21551#discussioncomment-3126023",
                          "updatedAt": "2022-07-12T04:11:59Z",
                          "publishedAt": "2022-07-12T04:11:58Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "WilkAndy"
                          },
                          "bodyText": "Yep, that's correct @Traiwit",
                          "url": "https://github.com/idaholab/moose/discussions/21551#discussioncomment-3126156",
                          "updatedAt": "2022-07-12T04:47:35Z",
                          "publishedAt": "2022-07-12T04:47:34Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "Flolaffel"
                          },
                          "bodyText": "@WilkAndy I actually read that page and just wanted to make sure that I got it right, before making some silly mistakes. Did I get it right?\nI'm modelling a porous cylinder that has a permeable top surface and gets pushed on by an indenter. So the goal is to restrict fluid outflow in the contact area and make fluid flow free in no-contact zones. It's running but it's a bit unstable sometimes.",
                          "url": "https://github.com/idaholab/moose/discussions/21551#discussioncomment-3127558",
                          "updatedAt": "2022-07-12T09:00:38Z",
                          "publishedAt": "2022-07-12T08:57:42Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "WilkAndy"
                          },
                          "bodyText": "You're probably doing the right thing, @Flolaffel .   Yes, permeability should be written in mm^2 units.  Remember your boundary tractions and pressures (for the indenter or confining pressures) must be specified in MPa.  Also, applying a force or pressure to an outer boundary is usually less stable than applying a displacement, which might be the reason for your occasional instability.  You could always trial standard units just to check you've done nothing wrong - the most painful aspect will probably be regenerating your mesh on the metre scale instead of mm.",
                          "url": "https://github.com/idaholab/moose/discussions/21551#discussioncomment-3132650",
                          "updatedAt": "2022-07-12T21:21:12Z",
                          "publishedAt": "2022-07-12T21:21:11Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "WilkAndy"
                          },
                          "bodyText": "Oh, i just noticed you wrote \"mm^4\" for permeability - not sure if that was a typo, but permeability should be in mm^2.  Also, Newtons = Pa.m^2 = MPa.mm^2, so if you're applying a force with the indenter you won't need to worry about its numerical value changing from standard SI units.",
                          "url": "https://github.com/idaholab/moose/discussions/21551#discussioncomment-3132668",
                          "updatedAt": "2022-07-12T21:26:45Z",
                          "publishedAt": "2022-07-12T21:26:44Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "Flolaffel"
                          },
                          "bodyText": "Thanks for your help.\nMy permeability unit wasn't a typo. I guess I just mixed some things up and ended up with a wrong unit.\nI don't use any external Force BCs, I use the Contact Module to indent my cylinder. As a proof of concept you could say. I'm not exactly sure what about my simulation introduces the \"disturbances\" I'm getting but contact could be one of them. Still to be tested.",
                          "url": "https://github.com/idaholab/moose/discussions/21551#discussioncomment-3136054",
                          "updatedAt": "2022-07-13T09:32:52Z",
                          "publishedAt": "2022-07-13T09:32:52Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "WilkAndy"
                          },
                          "bodyText": "Oh yes, contact is a really difficult thing to simulate.  As an alternative, could you just apply a FunctionDirichletBC to control the displacement of a node or group of nodes, with the function approximating the indenter's movement?  At least that'd tell you whether the contact was the chief problem, or something wrong with your cylinder model.",
                          "url": "https://github.com/idaholab/moose/discussions/21551#discussioncomment-3141288",
                          "updatedAt": "2022-07-13T21:45:30Z",
                          "publishedAt": "2022-07-13T21:45:30Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "Flolaffel"
                          },
                          "bodyText": "Well I tried and: the convergence is problematic but the results seem as expected.\nWhen using contact the convergence is fine actually but the results not so much. There are unexpected jumps in the porepressure. The cylinder is getting compressed all the time and still sometimes porepressure reduces and then jumps back up the next timestep. This doesn't happen with a displacement controlled simulation.\nDo you have experience with combining PorousFlow and Contact in MOOSE? For example is there a way to make the indenter non-porous? Because right now he is porous with 0 permeability.",
                          "url": "https://github.com/idaholab/moose/discussions/21551#discussioncomment-3147264",
                          "updatedAt": "2022-07-14T13:38:42Z",
                          "publishedAt": "2022-07-14T13:38:41Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "WilkAndy"
                          },
                          "bodyText": "I haven't done anything like you're doing, sorry @Flolaffel .  Yes, you certainly can block-restrict PorousFlow, so its Variables live only on the cylinder, however that means you have to use the Kernels and Materials with block = cylinder because PorousFlow's Actions (eg PorousFlowFullySaturated don't have that functionality).  However, a cheap way of doing it is to set porosity = 0 and permeability = 0.  That way (unless you're using unusual Kernels) all the PorousFlow residuals will be zero on the indenter.  That means porepressure will remain fixed in the indenter.  (Porepressure is physically meaningless in the indenter, of course, but you'll still see it there in paraview and MOOSE.)   Currently, with permeability = 0 only, PorousFlow will keep the fluid mass fixed at each indenter node, which may actually be quite numerically difficult if you have realistic fluid properties, since porepressure could rise dramatically as the indenter squashes a bit.\nRegarding convergence: have you read https://mooseframework.inl.gov/modules/porous_flow/convergence.html and https://mooseframework.inl.gov/modules/porous_flow/nonlinear_convergence_problems.html ?   I wonder whether you've tried SimpleFluidProperties because that almost always removes any problems related to fluid properties (eg, if you're inadvertently going through a phase transition).   I wonder whether you could share your mesh + input file, just for the \"no-indenter\" (DirichletBC) case?\nTo me, the porepressure jumping around sounds like the simulation hasn't converged properly, or fluid is flowing to/from the indenter or other boundaries?\na",
                          "url": "https://github.com/idaholab/moose/discussions/21551#discussioncomment-3150353",
                          "updatedAt": "2022-07-14T21:09:36Z",
                          "publishedAt": "2022-07-14T21:09:35Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "Flolaffel"
                          },
                          "bodyText": "Interesting...in my experience setting permeability = 0 converges while porosity = 0 completely destroys convergence. Something along the lines of failed factorization of Jacobian. How could that be? Maybe I'll have to resort to using all Kernels without any actions.\nI haven't seen the pages you mentioned yet. But my PorousFlow part is single-phase, fully saturated, SimpleFluidProperties without any temperature or phase changes. And I'm using a PiecewiseLinearSink. The convergence criteria article is interesing, but I had to set mine very high in order to make the simulation go through. Maybe that is part of the problem. You'll see in my input, I have the absolute and relative criteria at 1e-3. But: the DirichletBC input I attached is the one where porepressure actually does what I expect it to, even with mentioned tolerances. In the contact input I had tolerances at 1e-7 and still got the weird behaviour. I don't know whether I can set them even lower than that and still expect convergence. Contact is not exactly easy to get to converge.\n[Mesh]\n  [cube]\n    type = GeneratedMeshGenerator\n    dim = 2\n    ymin = 0\n    ymax = 0.5\n    nx = 30\n    ny = 10\n  []\n  [sideset_left]\n    type = SideSetsFromBoundingBoxGenerator\n    input = cube\n    bottom_left = '-0.1 0.4 0'\n    top_right = '0.5 0.6 0'\n    block_id = 0\n    boundary_id_old = top\n    boundary_id_new = 110\n  []\n  [sideset_right]\n    type = SideSetsFromBoundingBoxGenerator\n    input = sideset_left\n    bottom_left = '0.5 0.4 0'\n    top_right = '1.1 0.6 0'\n    block_id = 0\n    boundary_id_old = top\n    boundary_id_new = 111\n  []\n  patch_update_strategy = auto\n[]\n\n[Problem]\n  coord_type = RZ\n[]\n\n[GlobalParams]\n  displacements = 'disp_x disp_y'\n  gravity = '0 0 0'\n  PorousFlowDictator = dictator\n  volumetric_locking_correction = true\n[]\n\n[Variables]\n  [porepressure]\n  []\n[]\n\n[Functions]\n  [tdisp_y]\n    type = PiecewiseLinear\n    x = '0  10   100'\n    y = '0 -0.1 -0.1'\n  []\n[]\n\n[Modules]\n  [TensorMechanics/Master]\n    [all]\n      add_variables = true\n      strain = FINITE\n    []\n  []\n  [FluidProperties]\n    [simple_fluid]\n      type = SimpleFluidProperties\n      bulk_modulus = 1e7 #Pa\n      density0 = 1000 #rho in kg/m\u00b3\n      thermal_expansion = 0\n      viscosity = 1e-3 #mu in Pa*s\n    []\n  []\n[]\n\n[PorousFlowFullySaturated]\n  coupling_type = HydroMechanical\n  porepressure = porepressure\n  biot_coefficient = 0.8\n  displacements = 'disp_x disp_y'\n  fp = simple_fluid\n  stabilization = Full\n  pressure_unit = MPa\n[]\n\n[BCs]\n  [confinex]\n    type = DirichletBC\n    variable = disp_x\n    value = 0\n    boundary = 'left bottom'\n  []\n  [confiney]\n    type = DirichletBC\n    variable = disp_y\n    value = 0\n    boundary = 'bottom'\n  []\n  [topload]\n    type = FunctionDirichletBC\n    variable = disp_y\n    function = tdisp_y\n    boundary = 110\n  []    \n  [outflow]\n    type = PorousFlowPiecewiseLinearSink\n    variable = porepressure\n    boundary = 111\n    pt_vals = '-1e9 1e9'\n    multipliers = '-1e9 1e9'\n    PT_shift = 0\n    flux_function = 10\n    fluid_phase = 0\n    use_mobility = true\n    use_relperm = true\n  []\n[]\n\n[Materials]\n  [elasticity_cube]\n    type = ComputeIsotropicElasticityTensor\n    shear_modulus = 0.5\n    bulk_modulus = 320\n  []\n  [stress]\n    type = ComputeFiniteStrainElasticStress\n  []\n  [porosity_cube]\n    type = PorousFlowPorosity\n    fluid = true\n    mechanical = true\n    porosity_zero = 0.5 \n    biot_coefficient = 0.8 \n    solid_bulk = 320\n  []\n  [permeability_cube]\n    type = PorousFlowPermeabilityConst\n    permeability = '0.25e-9 0 0   0 0.25e-9 0   0 0 0.25e-9'\n  []\n[]\n\n[Preconditioning]\n  [andy]\n    type = SMP\n    full = true\n    petsc_options_iname = '-pc_type -pc_factor_mat_solver_package'\n    petsc_options_value = 'lu       mumps'\n    \n    #petsc_options_iname = '-pc_type -pc_hypre_type'\n    #petsc_options_value = 'hypre boomeramg'\n    \n    #petsc_options_iname = '-ksp_type -pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap'\n    #petsc_options_value = 'gmres      asm      lu           NONZERO                   2             '\n  []\n[]\n\n[Executioner]\n  type = Transient\n  solve_type = Newton\n  start_time = 0\n  end_time = 10\n  dt = 0.5  \n  nl_max_its = 100\n  nl_abs_tol = 1e-3\n  nl_rel_tol = 1e-3\n[]\n\n[Outputs]\n  csv = true\n  exodus = true\n[]\n\nLast but not least: Fluid should not be able to reach the indenter since it has no permeability and I restrict the outflow where contact is happening with a Sink (the process of restricting outflow on the left half of the top boundary while using contact differs from the input I attached here). Maybe there is a problem with the sink in the contact simulation. But the effect only happens with \"high\" bulk moduli for the porous media. Using up to a few MPa is no Problem but at around 10 MPa it starts acting weird. You can see I used over 300 MPa with the Dirichlet-Input and it worked fine.",
                          "url": "https://github.com/idaholab/moose/discussions/21551#discussioncomment-3155503",
                          "updatedAt": "2022-07-15T10:28:06Z",
                          "publishedAt": "2022-07-15T10:27:16Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "Export displacements as a vector variable.",
          "author": {
            "login": "Edward-Eth"
          },
          "bodyText": "Hi, I'm trying to use VTK or Tecplot outputs to get around Exodus's inability to have elements of disparate types in the same block, however, when viewing a VTK or tecplot file, Paraview does not automatically detect and combine the three displacment variables into a vector to all the mesh to be displaced/deformed. I have attempted to solve this by making a LAGRANGE_VEC aux variable, but have been unable to find the correct aux kernel for combining a number of LAGRANGE variables into a LAGRANGE_VEC. BuildArrayVariableAux does not allow for the use of vectors, and if I use an array instead then the same issue persists where paraview reads the components as three separate variables instead of a vector.",
          "url": "https://github.com/idaholab/moose/discussions/21608",
          "updatedAt": "2022-07-28T16:21:58Z",
          "publishedAt": "2022-07-18T13:55:05Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "BuildArrayVariableAux is for array variables not vector variables.\nYou may just name your variables\nvar_x\nvar_y\nvar_z\nto get Paraview to recognize them as vectors.\nYou could also add a BuildVectorVariableAux to the framework, we'd be happy to have this\nGuillaume",
                  "url": "https://github.com/idaholab/moose/discussions/21608#discussioncomment-3172965",
                  "updatedAt": "2022-07-18T15:35:27Z",
                  "publishedAt": "2022-07-18T15:35:25Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": []
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "RuntimeError: Multi-download failed when install moose-tools",
          "author": {
            "login": "DaijunHU"
          },
          "bodyText": "Hi,\nI am trying to install moose on a machine with Ubuntu 18.04.5 LTS following the instructions on\nhttps://mooseframework.inl.gov/getting_started/installation/conda.html\nHowever, when I move to  mamba install moose-tools moose-libmesh\nthe error occurs as follows:\n> # >>>>>>>>>>>>>>>>>>>>>> ERROR REPORT <<<<<<<<<<<<<<<<<<<<<<\n> \n>     Traceback (most recent call last):\n>       File \"/home/hdj2/mambaforge3/lib/python3.9/site-packages/conda/exceptions.py\", line 1082, in __call__\n>         return func(*args, **kwargs)\n>       File \"/home/hdj2/mambaforge3/lib/python3.9/site-packages/mamba/mamba.py\", line 951, in exception_converter\n>         raise e\n>       File \"/home/hdj2/mambaforge3/lib/python3.9/site-packages/mamba/mamba.py\", line 945, in exception_converter\n>         exit_code = _wrapped_main(*args, **kwargs)\n>       File \"/home/hdj2/mambaforge3/lib/python3.9/site-packages/mamba/mamba.py\", line 901, in _wrapped_main\n>         result = do_call(args, p)\n>       File \"/home/hdj2/mambaforge3/lib/python3.9/site-packages/mamba/mamba.py\", line 763, in do_call\n>         exit_code = install(args, parser, \"install\")\n>       File \"/home/hdj2/mambaforge3/lib/python3.9/site-packages/mamba/mamba.py\", line 507, in install\n>         index = load_channels(pool, channels, repos)\n>       File \"/home/hdj2/mambaforge3/lib/python3.9/site-packages/mamba/utils.py\", line 122, in load_channels\n>         index = get_index(\n>       File \"/home/hdj2/mambaforge3/lib/python3.9/site-packages/mamba/utils.py\", line 103, in get_index\n>         is_downloaded = dlist.download(api.MAMBA_DOWNLOAD_FAILFAST)\n>     **RuntimeError: Multi-download failed.**\n> \n> `$ /home/hdj2/mambaforge3/bin/mamba install moose-tools moose-libmesh`\n> \n>   environment variables:\n>                  CIO_TEST=<not set>\n>         CONDA_DEFAULT_ENV=moose\n>                 CONDA_EXE=/home/hdj2/mambaforge3/bin/conda\n>              CONDA_PREFIX=/home/hdj2/mambaforge3/envs/moose\n>     CONDA_PROMPT_MODIFIER=(moose)\n>          CONDA_PYTHON_EXE=/home/hdj2/mambaforge3/bin/python\n>                CONDA_ROOT=/home/hdj2/mambaforge3\n>               CONDA_SHLVL=1\n>            CURL_CA_BUNDLE=<not set>\n>                      PATH=/home/hdj2/mambaforge3/bin:/home/hdj2/mambaforge3/envs/moose/bin:/home\n>                           /hdj2/mambaforge3/condabin:/home/hdj2/.local/bin:/usr/local/sbin:/usr/\n>                           local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/s\n>                           nap/bin\n>        REQUESTS_CA_BUNDLE=<not set>\n>             SSL_CERT_FILE=<not set>\n>                WINDOWPATH=2\n> \n>      active environment : moose\n>     active env location : /home/hdj2/mambaforge3/envs/moose\n>             shell level : 1\n>        user config file : /home/hdj2/.condarc\n>  populated config files : /home/hdj2/mambaforge3/.condarc\n>                           /home/hdj2/.condarc\n>           conda version : 4.12.0\n>     conda-build version : not installed\n>          python version : 3.9.13.final.0\n>        virtual packages : __linux=5.4.0=0\n>                           __glibc=2.27=0\n>                           __unix=0=0\n>                           __archspec=1=x86_64\n>        base environment : /home/hdj2/mambaforge3  (writable)\n>       conda av data dir : /home/hdj2/mambaforge3/etc/conda\n>   conda av metadata url : None\n>            channel URLs : https://conda.software.inl.gov/public/linux-64\n>                           https://conda.software.inl.gov/public/noarch\n>                           https://conda.anaconda.org/idaholab/linux-64\n>                           https://conda.anaconda.org/idaholab/noarch\n>                           https://conda.anaconda.org/conda-forge/linux-64\n>                           https://conda.anaconda.org/conda-forge/noarch\n>                           https://repo.anaconda.com/pkgs/main/linux-64\n>                           https://repo.anaconda.com/pkgs/main/noarch\n>                           https://repo.anaconda.com/pkgs/r/linux-64\n>                           https://repo.anaconda.com/pkgs/r/noarch\n>           package cache : /home/hdj2/mambaforge3/pkgs\n>                           /home/hdj2/.conda/pkgs\n>        envs directories : /home/hdj2/mambaforge3/envs\n>                           /home/hdj2/.conda/envs\n>                platform : linux-64\n>              user-agent : conda/4.12.0 requests/2.27.1 CPython/3.9.13 Linux/5.4.0-72-generic ubuntu/18.04.5 glibc/2.27\n>                 UID:GID : 1000:1000\n>              netrc file : None\n> idaholab/linux-64                                    3.0kB @   6.6kB/s 404 failed  0.5s\n> idaholab/noarch                                      3.0kB @   6.6kB/s 404 failed  0.5s\n\nThen I searched for this in our forum and find sth similar as in this link: #20437\nBut things are different when I input  conda config --show channels\nit occurs like:\n(moose) hdj2@hdj2-Precision-T3610:~$ conda config --show channels\nchannels:\n  - https://conda.software.inl.gov/public\n  - idaholab\n  - conda-forge\n  - defaults\n\nI also found this discussion from mamba forum  mamba-org/mamba#496\nmaybe it is something about mamba and curl,  but I still did not get the point on how to solve this.\nCould you please help have a look at this installation problem?\nThank you very much in advance!\nBest regards,\nDaijun",
          "url": "https://github.com/idaholab/moose/discussions/21607",
          "updatedAt": "2022-07-18T13:45:23Z",
          "publishedAt": "2022-07-18T10:46:38Z",
          "category": {
            "name": "Q&A Getting Started"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\nplease remove the idaholab channel then try again. It s deprecated\nguillaume",
                  "url": "https://github.com/idaholab/moose/discussions/21607#discussioncomment-3171789",
                  "updatedAt": "2022-07-18T13:27:19Z",
                  "publishedAt": "2022-07-18T13:27:19Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "DaijunHU"
                          },
                          "bodyText": "Hi guillaume\nThank you! It works fine now.\nBest regards,\nDaijun",
                          "url": "https://github.com/idaholab/moose/discussions/21607#discussioncomment-3171961",
                          "updatedAt": "2022-07-18T13:45:24Z",
                          "publishedAt": "2022-07-18T13:45:23Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "Summer 2022 MOOSE Workshop",
          "author": {
            "login": "cticenhour"
          },
          "bodyText": "Idaho National Laboratory (INL) will be hosting a MOOSE workshop June 6th and 7th, 2022. Attendance to the workshop is free of charge, but you must register by filling out the Google form (https://bit.ly/3rVLuNL).\nThe workshop will run from 8:30 a.m. to 4:30 p.m MT on Mon. and Tues. We will be hosting guest speakers for lunch time talks. After registering you can expect to receive additional details regarding the workshop via email as the dates approach. For more information about MOOSE see mooseframework.inl.gov and if you have questions, please contact @permcody at cody.permann@inl.gov.\nThis training covers the basic operation of MOOSE, focusing on the development of a multi-physics MOOSE-based application. The training aims to provide the basics of MOOSE such that attendees will have the necessary skills to begin developing a MOOSE-based application to meet their own needs.\nIn Person Attendance will be capped and INL Requires ~30 days to clear international staff members who would like to attend. Please register at your earliest convenience.\nNOTE: We do not automatically send a confirmation of your registration but rest assured we've got it. We'll contact you with more details as the workshop approaches.\nOnce again, the registration form can be found at: https://bit.ly/3rVLuNL",
          "url": "https://github.com/idaholab/moose/discussions/20894",
          "updatedAt": "2022-07-18T03:44:20Z",
          "publishedAt": "2022-04-27T21:52:36Z",
          "category": {
            "name": "News"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "thomas-allard"
                  },
                  "bodyText": "Is there an estimate on when we can watch the recording from the training last week?",
                  "url": "https://github.com/idaholab/moose/discussions/20894#discussioncomment-2941662",
                  "updatedAt": "2022-06-13T20:21:40Z",
                  "publishedAt": "2022-06-13T20:21:35Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "CGH20171006"
                          },
                          "bodyText": "can we watch the recording?",
                          "url": "https://github.com/idaholab/moose/discussions/20894#discussioncomment-3168161",
                          "updatedAt": "2022-07-18T03:44:20Z",
                          "publishedAt": "2022-07-18T03:44:19Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "How to add the value of variable in other nodes into the kernel in the current node",
          "author": {
            "login": "Ethan-xj"
          },
          "bodyText": "Suppose that there are two one-dimensional curves which is divided into n elements. One is block1 and the other is block2.\nI want to add this equation into block1 and block2's kernel.\n\nw is the main variable in this equation, U(coupled variable) is the average velocity of block1 and block2, In block1, pn(coupled variable) is the pressure of block2, and in block2, pn is the pressure of block1.\nI dont know whether this can be done within moose, can anyone tell me?\nBest regards,\nEthan",
          "url": "https://github.com/idaholab/moose/discussions/21584",
          "updatedAt": "2022-07-21T07:38:26Z",
          "publishedAt": "2022-07-14T03:39:44Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\nAre the elements where this coupling exists adjacent?\nGuillaume",
                  "url": "https://github.com/idaholab/moose/discussions/21584#discussioncomment-3142879",
                  "updatedAt": "2022-07-14T03:56:48Z",
                  "publishedAt": "2022-07-14T03:56:47Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "like the two 1D lines, how are they positioned?",
                          "url": "https://github.com/idaholab/moose/discussions/21584#discussioncomment-3142904",
                          "updatedAt": "2022-07-14T04:03:55Z",
                          "publishedAt": "2022-07-14T04:03:54Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "Ethan-xj"
                          },
                          "bodyText": "The lines are parallel and the length the number of elements are all the same. And the equation need to be solved involves two lines' parameters(in detail: line1's first element and line2's first element). In geometry, these two elements are not adjacant. The main variable(w) in this equation is like a average value in form, but it need to be obtained by solving PDE. I'm not sure if I should add this equation into some line's kernel to solve this PDE, or maybe there's any other way?",
                          "url": "https://github.com/idaholab/moose/discussions/21584#discussioncomment-3144259",
                          "updatedAt": "2022-07-14T07:46:33Z",
                          "publishedAt": "2022-07-14T07:46:33Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "We dont have \"line\" kernels, we have elemental and nodal kernels.\nIf you have sums over multiple elements that are not adjacent, it will be a little tricky to get the contributions to the Jacobian right for Newton's method. You can compute the sums using the postprocessor system, which will get you the contribution to the residual.\nwith this one for example\nhttps://mooseframework.inl.gov/source/postprocessors/ElementIntegralVariablePostprocessor.html\nCan the two lines just the same line or is there any reason they must be separate?\nIf they are the same lines with all the variables living on that same 1D mesh, it's much easier to write each variable into the other variable's equation.",
                          "url": "https://github.com/idaholab/moose/discussions/21584#discussioncomment-3149361",
                          "updatedAt": "2022-07-14T18:05:57Z",
                          "publishedAt": "2022-07-14T18:05:53Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "Ethan-xj"
                          },
                          "bodyText": "Thank you for your relpy!\nThe two lines have the same variables(p, v and T) and in geometry and mesh they are same too. But the value of the variables should be different. I'm not sure if this could be called \"they are the same lines with all the variables living on that same 1D mesh\".\nSo if the two lines are the same how can I write each variable into the other variable's equation?",
                          "url": "https://github.com/idaholab/moose/discussions/21584#discussioncomment-3154633",
                          "updatedAt": "2022-07-15T08:59:14Z",
                          "publishedAt": "2022-07-15T08:59:12Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "You may use the Coupleable interface to write the local variable value of each variable into the equation.\nhttps://mooseframework.inl.gov/moose/source/interfaces/Coupleable.html\nFor non local values it's more complicated. I would do a first try with an integral postprocessor. Then if that doesnt work we can explore constraints, mortar and other non-local methods",
                          "url": "https://github.com/idaholab/moose/discussions/21584#discussioncomment-3157456",
                          "updatedAt": "2022-07-15T14:50:41Z",
                          "publishedAt": "2022-07-15T14:50:40Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "Ethan-xj"
                          },
                          "bodyText": "OK I will have a try. Thanks for your patient solution!",
                          "url": "https://github.com/idaholab/moose/discussions/21584#discussioncomment-3167800",
                          "updatedAt": "2022-07-18T01:37:11Z",
                          "publishedAt": "2022-07-18T01:37:11Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "FEM thermal radiation",
          "author": {
            "login": "Gallasd"
          },
          "bodyText": "Hi, I want to use moose as my solver for structural optimization. The optimization problem is first to determine the governing equations.\nI study heat conduction under radiation boundaries.\nThe governing equation is the heat conduction equation, and the boundary condition is the radiation boundary, that is, the fourth power of temperature, similar to this:\n\nIf it is a convection boundary, the weighted margin method is directly used, and the integration is sufficient. For the radiation boundary, this highly nonlinear problem is very difficult to deal with by the finite element method.\nMany literatures simplify the radiation boundary to a certain extent, such as linear approximation of radiation heat transfer and equivalent heat transfer. But there must be a general simplification, because software cannot simplify equations for every simplified physical problem.\nSo I would like to ask you how moose performs finite element processing of radiation boundaries.",
          "url": "https://github.com/idaholab/moose/discussions/21595",
          "updatedAt": "2022-08-13T16:16:58Z",
          "publishedAt": "2022-07-15T14:14:31Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\nMOOSE has a non-linear solver so we typically can solve these boundary conditions exactly. We have various objects for dealing with radiative heat transfer:\nhttps://mooseframework.inl.gov/source/actions/ThermalContactAction.html\nis for radiation / conduction and convection at interfaces, which may be disjoint.\nhttps://mooseframework.inl.gov/syntax/GrayDiffuseRadiation/index.html\nis for \"exact\" treatment of radiation using ray tracing. This is more expensive to set up.\nhttps://mooseframework.inl.gov/source/bcs/ADFunctionRadiativeBC.html\nhttps://mooseframework.inl.gov/source/bcs/ADInfiniteCylinderRadiativeBC.html\nare meant to have radiation boundary conditions at the outer boundary of the mesh (or of the temperature variable in the mesh)\nThey effectively implement different approximation (radiative surface shape of a plane in front or a cylinder in front respectively)\nGuillaume",
                  "url": "https://github.com/idaholab/moose/discussions/21595#discussioncomment-3157539",
                  "updatedAt": "2022-07-15T15:01:04Z",
                  "publishedAt": "2022-07-15T15:00:59Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "Gallasd"
                          },
                          "bodyText": "Hello, maybe you didn't understand my question, I hope you can read it patiently.\nQ1:I'm not sure how you deal with the radiation boundary conditions above on finite elements, such as ADFunctionRadiation. Here is a document I found that puts the effect of radiation boundaries into the stiffness matrix, simplifying this highly nonlinear question.\n\nTheoretically, the role of the radiation boundary should be in the load matrix.\nSo I would like to confirm with you how moose calculates the ADFunctionRadiation, which is a problem of the fourth power of heat flux, and whether it adopts the method used in the above literature.\nQ2: I have another question. In the calculation example provided by ADFunctionRadiation, there is such a passage:\n# If we assume that epsilon*sigma*(T_inf^4-T_s^4) is approximately equal to\n# epsilon*sigma*4*T_inf^3*(T_inf-T_s), that form is equivalent to\n# h*(T_inf-T_s), the convective flux bc. So, the radiative and convective\n# flux bcs should give nearly the same answer if the leading terms are equal.\n\nI don't understand why this can be so simplified, why T_inf can be brought up, and why there is an extra 4. In addition, is the radiation problem so simplified in moose?",
                          "url": "https://github.com/idaholab/moose/discussions/21595#discussioncomment-3160439",
                          "updatedAt": "2022-07-16T20:54:59Z",
                          "publishedAt": "2022-07-16T02:55:53Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Q1: no we dont do this approach. We form the residual with the current solution values for all variables, then either do Newton or PJFNK. Forming this load and stiffness matrix is for a custom numerical scheme\nQ2: Factorize (T_inf^4-T_s^4) by (T_inf-T_s) and look at the resulting polynomial. You can approximate T_s by T_inf in the rest of the factorization and get what the text says\nThe radiation problem is not so simplified in MOOSE, this is just a sanity check.\nYou may look at the code at your convenience to convince yourself",
                          "url": "https://github.com/idaholab/moose/discussions/21595#discussioncomment-3163397",
                          "updatedAt": "2022-07-16T21:00:44Z",
                          "publishedAt": "2022-07-16T21:00:44Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "Gallasd"
                  },
                  "bodyText": "Hi, thanks for your reply.\nI learned about the radiation part of ANSYS and moose, and basically understood the principle of radiation calculation. It is found that the radiation problem for a surface, that is, the temperature without surface radiation exchange, should also be solved by the theory of Gray Diffuse Radiative Exchange.\nThis is my geometry, obviously, there is no heat radiation between the surfaces:\n\nAfter carefully studying the radiation theory in moose, I think that in moose,The radiation boundary condition becomes a constant heat flow boundary condition,here J is a constant in this equation\uff1a\n\nFor J  in the formula, calculate by the following formula:\n\nHere, through the Newton or PJFNK you mentioned, to solve the nonlinear equation system of  Equation 2.Constantly exchange information with the thermal conductivity control equation, perform iterations, and finally determine the converged J and T.\nSo Newton or PJFNK solve for the variables on the radiation boundary, not the overall variables\uff1f\nthank you for your reply\uff01",
                  "url": "https://github.com/idaholab/moose/discussions/21595#discussioncomment-3165648",
                  "updatedAt": "2022-07-17T14:01:57Z",
                  "publishedAt": "2022-07-17T14:01:56Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "It's not a local solve on the boundary, it's for all variables at the same time. The boundary temperature is converged at the same time, there is no separate treatment afaik\nThe equations for each implementation of the radiation BC are in their respective documentation. It's indeed a heat flux, but it's not constant. Most of them vary as T^4 - T_inf^4",
                          "url": "https://github.com/idaholab/moose/discussions/21595#discussioncomment-3166209",
                          "updatedAt": "2022-07-17T16:41:49Z",
                          "publishedAt": "2022-07-17T16:41:48Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "How to add gravity to airflow FEM simulation",
          "author": {
            "login": "brandon-barclay"
          },
          "bodyText": "Hello, I am attempting to use MOOSE to simulate radionuclide deposition with FEM, however, I am struggling to add a kernel to represent gravitational settling of the particle through the domain before it reaches the boundary. I have tried to index the gradients for the Z gradient component however the residual contribution seems to be 0. It appears that using vector variables / kernels would make this a simpler task however all of my kernels are for non vector variables so I am hoping there is a possible workaround.\nThanks for reading and for your assistance.",
          "url": "https://github.com/idaholab/moose/discussions/21495",
          "updatedAt": "2022-08-13T16:17:21Z",
          "publishedAt": "2022-07-04T18:27:16Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\nWhat does the equation look like for this problem? And which term is the gravitational settling?\nVector variables/kernels are never required, they're only done for simplicity or efficiency\nHappy 4th,\nGuillaume",
                  "url": "https://github.com/idaholab/moose/discussions/21495#discussioncomment-3080783",
                  "updatedAt": "2022-07-04T23:56:56Z",
                  "publishedAt": "2022-07-04T23:56:56Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "brandon-barclay"
                          },
                          "bodyText": "I have attached the weak form of the equation I am attempting to model, with the deposition term highlighted.\nThank you for your interest in helping me solve this problem.",
                          "url": "https://github.com/idaholab/moose/discussions/21495#discussioncomment-3086668",
                          "updatedAt": "2022-07-05T17:00:19Z",
                          "publishedAt": "2022-07-05T17:00:18Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "so what do you have for computeQpResidual currently?\nI would see something like:\n-_nu_s[_qp] * _test[_i][_qp] * _grad_C[2][_qp]\n\nnu_s being a material property and _grad_C being obtained using the coupledGradient method",
                          "url": "https://github.com/idaholab/moose/discussions/21495#discussioncomment-3088308",
                          "updatedAt": "2022-07-05T23:17:25Z",
                          "publishedAt": "2022-07-05T23:17:24Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "brandon-barclay"
                          },
                          "bodyText": "This is almost exactly what I had tried to use, however, I get an error stating\nerror: type 'const libMesh::VectorValue<MetaPhysicL::DualNumber<double, MetaPhysicL::SemiDynamicSparseNumberArray<double, unsigned long long, MetaPhysicL::NWrapper<53>>, true>>' does not provide a subscript operator\n  return _settling_velocity[_qp] * _test[_i][_qp] * _grad_u[2][_qp];",
                          "url": "https://github.com/idaholab/moose/discussions/21495#discussioncomment-3102414",
                          "updatedAt": "2022-07-07T20:11:30Z",
                          "publishedAt": "2022-07-07T18:25:04Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "ok so probably the [2] is wrong. maybe it's (2) or maybe it s at a different position",
                          "url": "https://github.com/idaholab/moose/discussions/21495#discussioncomment-3103056",
                          "updatedAt": "2022-07-07T20:25:50Z",
                          "publishedAt": "2022-07-07T20:25:49Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "brandon-barclay"
                          },
                          "bodyText": "I was able to get it to work with _grad_u[_qp](2) - thanks for your help!",
                          "url": "https://github.com/idaholab/moose/discussions/21495#discussioncomment-3103064",
                          "updatedAt": "2022-07-07T20:27:46Z",
                          "publishedAt": "2022-07-07T20:27:11Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "ah weird. I ll try to remember. I m used to grad_phi[_j][_qp] and grad_test[_i][_qp], didnt know it was flipped for the variables",
                          "url": "https://github.com/idaholab/moose/discussions/21495#discussioncomment-3103075",
                          "updatedAt": "2022-07-07T20:30:08Z",
                          "publishedAt": "2022-07-07T20:30:08Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "lindsayad"
                          },
                          "bodyText": "grad_phi and grad_test are two dimensional arrays of 3-vectors (gradients) indexed by shape function, quadrature point, and finally spatial dimension. grad_u is a one-dimensional array of 3-vectors (gradients) without the shape function index, so indexed first by quadrature point and then by spatial dimension",
                          "url": "https://github.com/idaholab/moose/discussions/21495#discussioncomment-3163622",
                          "updatedAt": "2022-07-16T23:35:07Z",
                          "publishedAt": "2022-07-16T23:34:40Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "A question about self define kernel",
          "author": {
            "login": "wangzhaohao"
          },
          "bodyText": "Hi, everyone! I want to define a PDE which form is\n$\\bigtriangledown \\bigtriangledown C +\\bigtriangledown (\\frac{640C}{T^{2}}\\bigtriangledown T) =0$\nand the bcs is\n$\\bigtriangledown C = 0   (x =0)$\n$C =1.6 (x=1)$\nI define three kernels ConcentrationConvectionSource ConcentrationConvectionTemp ConcentrationDiffusionTemp\nand a .i file\nconcentration_back.i\nthey are all follow.\nhttps://github.com/wangzhaohao/termite2/tree/main/termite2\n\n\nbut the result is different with Finite Difference, I meet this problem so long,but i can't find the wrong, so who can give me some advice, Thanks for your help!\nhao",
          "url": "https://github.com/idaholab/moose/discussions/21587",
          "updatedAt": "2022-08-13T16:18:00Z",
          "publishedAt": "2022-07-14T13:20:22Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\nI took a quick look. In concentration.i you set DirichletBC instead of a NeumannBC on the left boundary\n  [left]\n    type = DirichletBC\n    variable = concentration\n    boundary = left\n    value = 0\n  []\n\nthis isnt the result shown in your post either.\nInstead of sharing a zip of your folder, please create a github repo, share the link here and tell us which inputs should reproduce the problem here.\nAlso is temperature just fixed?\nGuillaume",
                  "url": "https://github.com/idaholab/moose/discussions/21587#discussioncomment-3149115",
                  "updatedAt": "2022-07-14T17:29:48Z",
                  "publishedAt": "2022-07-14T17:29:48Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "wangzhaohao"
                          },
                          "bodyText": "the.i file is concentration_back.i, not the concontration.i",
                          "url": "https://github.com/idaholab/moose/discussions/21587#discussioncomment-3150881",
                          "updatedAt": "2022-07-14T23:33:51Z",
                          "publishedAt": "2022-07-14T23:33:48Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "that input has kernels for an auxvariable (temp), which shouldnt even be allowed, and doesnt converge well.",
                          "url": "https://github.com/idaholab/moose/discussions/21587#discussioncomment-3151031",
                          "updatedAt": "2022-07-15T00:06:59Z",
                          "publishedAt": "2022-07-15T00:06:58Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "wangzhaohao"
                          },
                          "bodyText": "https://github.com/wangzhaohao/termite2/tree/main/termite2\nthis is my code on github. the auxkernel is used for i just want to give a\nT = -1500xx+2000\nI follow the Thermal Expansion, which give temp (also a auxvariable) by auxkernel.",
                          "url": "https://github.com/idaholab/moose/discussions/21587#discussioncomment-3151074",
                          "updatedAt": "2022-07-15T00:19:50Z",
                          "publishedAt": "2022-07-15T00:19:45Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "WilkAndy"
                  },
                  "bodyText": "Have you got one equation and two unknowns (C and T)?",
                  "url": "https://github.com/idaholab/moose/discussions/21587#discussioncomment-3150242",
                  "updatedAt": "2022-07-14T20:46:10Z",
                  "publishedAt": "2022-07-14T20:46:06Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "wangzhaohao"
                          },
                          "bodyText": "the variable T is give as auxvariable.",
                          "url": "https://github.com/idaholab/moose/discussions/21587#discussioncomment-3150878",
                          "updatedAt": "2022-07-14T23:32:35Z",
                          "publishedAt": "2022-07-14T23:32:32Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "YaqiWang"
                  },
                  "bodyText": "Is the PJFNK solve converged? What makes you think you FD solution is accurate? How big is the difference between FD and your FEM solution?",
                  "url": "https://github.com/idaholab/moose/discussions/21587#discussioncomment-3152394",
                  "updatedAt": "2022-07-15T05:19:37Z",
                  "publishedAt": "2022-07-15T05:19:37Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "wangzhaohao"
                          },
                          "bodyText": "there is no warning. and i think the FD solution is accurate is that when i set the bcs\nx = 0, C = 0\nx = 1, C = 1.6\n\n\n\nthere have analytical solution. the FD solution satisfy, but the FEM is not.  so i guess there is something wrong about myself define kernels.",
                          "url": "https://github.com/idaholab/moose/discussions/21587#discussioncomment-3156625",
                          "updatedAt": "2022-07-15T13:09:15Z",
                          "publishedAt": "2022-07-15T13:09:14Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "YaqiWang"
                          },
                          "bodyText": "This does not make sense. If your temperature is constant, its gradient is zero and all the three kernels coupling the temperature have zero contributions to the residual, so only the diffusion kernel and two Dirichlet bcs left, you should get a linear solution from 0 to 1.6.",
                          "url": "https://github.com/idaholab/moose/discussions/21587#discussioncomment-3159281",
                          "updatedAt": "2022-07-15T20:01:24Z",
                          "publishedAt": "2022-07-15T20:01:24Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Temperature is constant in time, it has a spatial profile",
                          "url": "https://github.com/idaholab/moose/discussions/21587#discussioncomment-3159898",
                          "updatedAt": "2022-07-15T22:31:46Z",
                          "publishedAt": "2022-07-15T22:31:46Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "wangzhaohao"
                          },
                          "bodyText": "so i think there is somthing which i don't  notice in my self define kernel",
                          "url": "https://github.com/idaholab/moose/discussions/21587#discussioncomment-3161246",
                          "updatedAt": "2022-07-16T08:42:55Z",
                          "publishedAt": "2022-07-16T08:42:55Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "to debug you will want to take it step by step.\nThe problem is easy enough that you can replace each kernel one by one to make sure they are correct. When you reproduce the analytical solution for a simplified problem, you can consider the objects currently in use are correct, and investigate the others.\nAnother option is to replace your kernels with framework ones, which are already correct.\nFor example you may use ADMatDiffusion\nhttps://mooseframework.inl.gov/source/kernels/ADMatDiffusion.html\nwith a ParsedMaterialProperty (use the AD version) for your diffusion term\nhttps://mooseframework.inl.gov/source/materials/ParsedMaterial.html\nIn any case you will want to remove the kernels acting on an auxiliary variable",
                          "url": "https://github.com/idaholab/moose/discussions/21587#discussioncomment-3163369",
                          "updatedAt": "2022-07-16T20:46:16Z",
                          "publishedAt": "2022-07-16T20:46:15Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "Output of shear stress in CrystalPlasticitySlipRateGS",
          "author": {
            "login": "Aayush-T"
          },
          "bodyText": "Hello everyone,\nI am working on FiniteStrainUOBasedCP and CrystalPlasticitySlipRateGSS. I wanted the shear stress variable \"tau\" in CrystalPlasticitySlipRateGSS as output for all slip systems, so I tried to make tau from local to global variable, but it gives this error.\nTHE PROBLEM VARIABLE AND FUNCTION IS IN BOLD\nOnly showing the added portion in \"CrystalPlasticitySlipRateGSS\" file for better clarity and easy understanding.\nLike this:\n.h file\n#pragma once\n\n#include \"CrystalPlasticitySlipRate.h\"\n#include \"RankTwoTensor.h\"\n\n/**\n * Phenomenological constitutive model slip rate userobject class.\n */\nclass CrystalPlasticitySlipRateGSS : public CrystalPlasticitySlipRate\n{\n\nprotected:\n\n  **DenseVector<Real> _shear_stress;**\n};\n\nand, in C file as\n\n#include \"CrystalPlasticitySlipRateGSS.h\"\n\n#include <fstream>\n\nregisterMooseObject(\"TensorMechanicsApp\", CrystalPlasticitySlipRateGSS);\n\nInputParameters\nCrystalPlasticitySlipRateGSS::validParams()\n{\n.........\n}\n\nCrystalPlasticitySlipRateGSS::CrystalPlasticitySlipRateGSS(const InputParameters & parameters)\n  : CrystalPlasticitySlipRate(parameters),\n    .........,\n    **_shear_stress(_variable_size)**\n{\n  if (_slip_sys_flow_prop_file_name.length() != 0)\n    readFileFlowRateParams();\n  else\n    getFlowRateParams();\n}\n\nbool\nCrystalPlasticitySlipRateGSS::calcSlipRate(unsigned int qp, Real dt, std::vector<Real> & val) const\n{\n  DenseVector<Real> tau(_variable_size);\n\n  for (unsigned int i = 0; i < _variable_size; ++i)\n    tau(i) = _pk2[qp].doubleContraction(_flow_direction[qp][i]);\n\n  \n   **for (unsigned int i = 0; i < _variable_size; ++i)**\n     **_shear_stress(i) = _pk2[qp].doubleContraction(_flow_direction[qp][i]);**\n\n\n  for (unsigned int i = 0; i < _variable_size; ++i)\n  {\n    val[i] = _a0(i) * std::pow(std::abs(tau(i) / _mat_prop_state_var[qp][i]), 1.0 / _xm(i)) *\n             std::copysign(1.0, tau(i));\n    if (std::abs(val[i] * dt) > _slip_incr_tol)\n    {\n#ifdef DEBUG\n      mooseWarning(\"Maximum allowable slip increment exceeded \", std::abs(val[i]) * dt);\n#endif\n      return false;\n    }\n  }\n\n  return true;\n}\n\nBut it gives following error.\n\nI am also adding the changes I made in the CrystalPlasticitySlipRateGSS",
          "url": "https://github.com/idaholab/moose/discussions/21507",
          "updatedAt": "2022-07-15T14:28:25Z",
          "publishedAt": "2022-07-05T18:19:52Z",
          "category": {
            "name": "Q&A Modules: Solid mechanics"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "hello\nYou made calcSlipRate a const function but you are assigning a value to one of the class member variable.\nThis is not allowed, as declaring a function const means it may not modify any of the class attributes.\nYou need to remove the const function attribute\nGuillaume",
                  "url": "https://github.com/idaholab/moose/discussions/21507#discussioncomment-3088375",
                  "updatedAt": "2022-07-05T23:39:47Z",
                  "publishedAt": "2022-07-05T23:39:46Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "Aayush-T"
                          },
                          "bodyText": "Hi, thanks for quick response. In this case, this is how this function should be defined(as the file is from MOOSEFRAMEWORK), otherwise it will lead to constitutive failure error in the file. I tried that.\nI also tried a few more things such as trying to define a new function in the C file, but now is the problem of how to call that new function in the file. Moreover, I have doubts about how to get the output of a DenseVector in the csv when it is not defined as a material property.\n#include \"CrystalPlasticitySlipRateGSS.h\"\n\n#include <fstream>\n\nregisterMooseObject(\"TensorMechanicsApp\", CrystalPlasticitySlipRateGSS);\n\nInputParameters\nCrystalPlasticitySlipRateGSS::validParams()\n{\n.......\n}\n\nCrystalPlasticitySlipRateGSS::CrystalPlasticitySlipRateGSS(const InputParameters & parameters)\n  : CrystalPlasticitySlipRate(parameters),\n    ...................,\n    _shear_stress(_variable_size)\n{\n  if (_slip_sys_flow_prop_file_name.length() != 0)\n    readFileFlowRateParams();\n  else\n    getFlowRateParams();\n}\n\n **void\n CrystalPlasticitySlipRateGSS::CalcTau(unsigned int qp)\n{\n  for (unsigned int i = 0; i < _variable_size; ++i)\n    _shear_stress(i) = _pk2[qp].doubleContraction(_flow_direction[qp][i]);\n    printf(\"%f\\n\", _shear_stress(0));\n}**\n\nbool\nCrystalPlasticitySlipRateGSS::calcSlipRate(unsigned int qp, Real dt, std::vector<Real> & val) const\n{\n  DenseVector<Real> tau(_variable_size);\n\n  for (unsigned int i = 0; i < _variable_size; ++i)\n    tau(i) = _pk2[qp].doubleContraction(_flow_direction[qp][i]);\n\n  for (unsigned int i = 0; i < _variable_size; ++i)\n  {\n    val[i] = _a0(i) * std::pow(std::abs(tau(i) / _mat_prop_state_var[qp][i]), 1.0 / _xm(i)) *\n             std::copysign(1.0, tau(i));\n    if (std::abs(val[i] * dt) > _slip_incr_tol)\n    {\n#ifdef DEBUG\n      mooseWarning(\"Maximum allowable slip increment exceeded \", std::abs(val[i]) * dt);\n#endif\n      return false;\n    }\n  }\n\n  return true;\n}",
                          "url": "https://github.com/idaholab/moose/discussions/21507#discussioncomment-3090665",
                          "updatedAt": "2022-07-15T14:24:37Z",
                          "publishedAt": "2022-07-06T08:40:11Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "You ll need to mark_shear_stress as mutable if you want to modify it in a const function",
                          "url": "https://github.com/idaholab/moose/discussions/21507#discussioncomment-3094915",
                          "updatedAt": "2022-07-06T19:39:26Z",
                          "publishedAt": "2022-07-06T19:39:25Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "sapitts"
                  },
                  "bodyText": "Hi @Aayush-T,\nHave you considered using the material-based \"Update\" crystal plasticity classes (documentation page here: https://mooseframework.inl.gov/source/materials/crystal_plasticity/ComputeMultipleCrystalPlasticityStress.html ) instead of the older user object based system? The newer material-based system offers several advantages including significant simulation speedup, more robust substepping capabilities, and, cruicial for your application, the ability to easily output material properties like the shear stress and slip system strength.\nYou can read more about the specific Kalidindi model you are using on the documentation page here: https://mooseframework.inl.gov/source/materials/crystal_plasticity/CrystalPlasticityKalidindiUpdate.html. To then output the resolved shear stress in your output file, add the following to your input file:\n[AuxVariables]\n  [resolved_shear_stress_0]\n    order = CONSTANT\n    family = MONOMIAL\n  []\n[]\n\n[AuxKernels]\n  [tau_0]\n    type = MaterialStdVectorAux\n    variable = resolved_shear_stress_0\n    property = applied_shear_stress\n    index = 0\n    execute_on = timestep_end\n  []\n[]\n\n[Postprocessors]\n  [tau_0]\n    type = ElementAverageValue\n    variable = resolved_shear_stress_0\n  []\n[]\n\nThis example shows the necessary input file additions for the 0th slip system, and the pattern is the same for the other slip systems.\nHope this helps!",
                  "url": "https://github.com/idaholab/moose/discussions/21507#discussioncomment-3122887",
                  "updatedAt": "2022-07-11T16:29:19Z",
                  "publishedAt": "2022-07-11T16:29:19Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "Aayush-T"
                          },
                          "bodyText": "Hi, thanks for the response. Yes, this new method seems better than older user object based system, but since most of development done by me is on that, so I wanted to do it in the UserObjectBased Class only. This discussion gave me a better understanding on how to implement it.\nThanks a lot.",
                          "url": "https://github.com/idaholab/moose/discussions/21507#discussioncomment-3157253",
                          "updatedAt": "2022-07-15T14:28:26Z",
                          "publishedAt": "2022-07-15T14:28:25Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "Aayush-T"
                  },
                  "bodyText": "Hi everyone, thanks. I did it by defining rss as material property in FiniteStrainUOBasedCP and calculating it in calcResidual function in FiniteStrainUOBasedCP itself. The output can be taken in the same way as defined above.\nIt was an easy way to do it for user object based method.\nAdding it here for further reference in case anyone needs it.\nFiniteStrainUObasedCP::calcResidual()\n{\nRankTwoTensor iden(RankTwoTensor::initIdentity), ce, ee, ce_pk2, eqv_slip_incr, pk2_new;\n\ngetSlipRates();\nif (_err_tol)\nreturn;\n\nfor (unsigned int i = 0; i < _num_uo_slip_rates; ++i)\n{\nfor (unsigned int j = 0; j < _uo_slip_rates[i]->variableSize(); ++j)\n{\neqv_slip_incr += (_flow_direction[i])[_qp][j] * (_mat_prop_slip_rates[i])[_qp][j] * _dt;\n_rss_output[_qp][j] = _pk2[_qp].doubleContraction((*_flow_direction[i])[_qp][j]);\n}\n}\n\neqv_slip_incr = iden - eqv_slip_incr;\n_fp_inv = _fp_old_inv * eqv_slip_incr;\n_fe = _dfgrd_tmp * _fp_inv;\n\nce = _fe.transpose() * _fe;\nee = ce - iden;\nee*= 0.5;\n\npk2_new = _elasticity_tensor[_qp] * ee;\n\n_resid = _pk2[_qp] - pk2_new;\n}\n\nThanks and Regards,\nAayush",
                  "url": "https://github.com/idaholab/moose/discussions/21507#discussioncomment-3157218",
                  "updatedAt": "2022-07-15T14:52:27Z",
                  "publishedAt": "2022-07-15T14:25:32Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": []
                  }
                }
              }
            ]
          }
        }
      }
    ]
  }
}