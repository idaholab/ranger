{
  "discussions": {
    "pageInfo": {
      "hasNextPage": true,
      "endCursor": "Y3Vyc29yOnYyOpK5MjAyMy0xMC0xMFQxNzoxNzowOC0wNjowMM4AUwLf"
    },
    "edges": [
      {
        "node": {
          "title": "Homogenization issue",
          "author": {
            "login": "eduardogrodriguez89"
          },
          "bodyText": "Dear Moose developers,\nI try to understand how the module homogenization works.\nI want to determine the effective properties of two materials, a matrix with fiber.  I tried to replicate this work,\nhttps://drive.google.com/file/d/1w7vnpsZXTdmfo1Rz-jmWnH9NQ06U72n_/view?usp=sharing but the results are different.\nI would like to know what is wrong with the code. If the BCs are correct?\ncode.zip\nthanks",
          "url": "https://github.com/idaholab/moose/discussions/25408",
          "updatedAt": "2023-10-12T02:10:34Z",
          "publishedAt": "2023-09-06T14:37:00Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "lindsayad"
                  },
                  "bodyText": "Hi, thank you for your post. In order to more easily help, it would be better if you posted your code on github instead of on Google drive or attaching as a zip file",
                  "url": "https://github.com/idaholab/moose/discussions/25408#discussioncomment-6927270",
                  "updatedAt": "2023-09-06T15:23:08Z",
                  "publishedAt": "2023-09-06T15:23:07Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "eduardogrodriguez89"
                          },
                          "bodyText": "2020_Development of a \ufb01nite element based strain periodicity implementation method.zip\ncsv_file = 'cell_average_values_4'\n\n[GlobalParams]\n  displacements = 'disp_x disp_y'\n  large_kinematics = false\n  macro_gradient = hvar\n  homogenization_constraint = homogenization\n[]\n\n[Mesh]\n  [base]\n    type = FileMeshGenerator\n    file = 'circle047.msh'\n  []\n[]\n\n[Variables]\n  [disp_x]\n  []\n  [disp_y]\n  []\n  [hvar]\n    family = SCALAR\n    order = FIRST\n  []\n[]\n\n[AuxVariables]\n  [sxx]\n    family = MONOMIAL\n    order = CONSTANT\n  []\n  [syy]\n    family = MONOMIAL\n    order = CONSTANT\n  []\n  [sxy]\n    family = MONOMIAL\n    order = CONSTANT\n  []\n  [exx]\n    family = MONOMIAL\n    order = CONSTANT\n  []\n  [eyy]\n    family = MONOMIAL\n    order = CONSTANT\n  []\n  [exy]\n    family = MONOMIAL\n    order = CONSTANT\n  []\n[]\n\n[AuxKernels]\n  [sxx]\n    type = RankTwoAux\n    variable = sxx\n    rank_two_tensor = pk1_stress\n    index_i = 0\n    index_j = 0\n  []\n  [syy]\n    type = RankTwoAux\n    variable = syy\n    rank_two_tensor = pk1_stress\n    index_i = 1\n    index_j = 1\n  []\n  [sxy]\n    type = RankTwoAux\n    variable = sxy\n    rank_two_tensor = pk1_stress\n    index_i = 0\n    index_j = 1\n  []\n  [exx]\n    type = RankTwoAux\n    variable = exx\n    rank_two_tensor = mechanical_strain\n    index_i = 0\n    index_j = 0\n  []\n  [eyy]\n    type = RankTwoAux\n    variable = eyy\n    rank_two_tensor = mechanical_strain\n    index_i = 1\n    index_j = 1\n  []\n  [exy]\n    type = RankTwoAux\n    variable = exy\n    rank_two_tensor = mechanical_strain\n    index_i = 0\n    index_j = 1\n  []\n[]\n\n[UserObjects]\n  [homogenization]\n    type = HomogenizationConstraint\n    constraint_types = 'stress none none none none none none none none'\n    targets = 'stress11 zero zero zero zero zero'\n    execute_on = 'INITIAL LINEAR NONLINEAR'\n  []\n[]\n\n[Kernels]\n  [sdx]\n    type = HomogenizedTotalLagrangianStressDivergence\n    variable = disp_x\n    component = 0\n  []\n  [sdy]\n    type = HomogenizedTotalLagrangianStressDivergence\n    variable = disp_y\n    component = 1\n  []\n[]\n\n[ScalarKernels]\n  [enforce]\n    type = HomogenizationConstraintScalarKernel\n    variable = hvar\n  []\n[]\n\n[Functions]\n  [strain11]\n    type = ParsedFunction\n    expression = '1.0e-6*t'\n  []\n  [strain22]\n    type = ParsedFunction\n    expression = '-2.0e-2*t'\n  []\n  [strain12]\n    type = ParsedFunction\n    expression = '1.0e-3*t'\n  []\n  [stress11]\n    type = ParsedFunction\n    expression = '1e7*t'\n  []\n  [stress22]\n    type = ParsedFunction\n    expression = '-200*t'\n  []\n  [stress12]\n    type = ParsedFunction\n    expression = '100*t'\n  []\n[]\n\n[BCs]\n  [Periodic]\n    [x]\n      variable = disp_x\n      auto_direction = 'x y'\n    []\n    [y]\n      variable = disp_y\n      auto_direction = 'x y'\n    []\n  []\n  [fiy1_y]\n    type = DirichletBC\n    boundary = Left\n    variable = disp_x\n    value = 0\n  []\n  # [fix1_x]\n  #   type = DirichletBC\n  #   boundary = Left\n  #   variable = disp_y\n  #   value = 0\n  # []\n  [fix1_y]\n    type = DirichletBC\n    boundary = Button\n    variable = disp_y\n    value = 0\n  []\n\n  # [fix2_y]\n  #   type = DirichletBC\n  #   boundary = Top\n  #   variable = disp_y\n  #   value = 0\n  # []\n[]\n\n\nE1 = '68.3e9' #aluminium\nnu1 = '0.3'\nE2 = '379.3e9' #Boron\nnu2 = '0.1'\n\n[Materials]\n  [elastic_tensor_1]\n    type = ComputeIsotropicElasticityTensor\n    youngs_modulus = ${E1}\n    poissons_ratio = ${nu1}\n    block = 'Rectangulo'\n  []\n  [elastic_tensor_2]\n    type = ComputeIsotropicElasticityTensor\n    youngs_modulus = ${E2}\n    poissons_ratio = ${nu2}\n    block = 'Circulo_1'\n  []\n  [compute_stress]\n    type = ComputeLagrangianLinearElasticStress\n  []\n  [compute_strain]\n    type = ComputeLagrangianStrain\n    homogenization_gradient_names = 'homogenization_gradient'\n  []\n  [compute_homogenization_gradient]\n    type = ComputeHomogenizedLagrangianStrain\n  []\n[]\n\n[Postprocessors]\n  [sxx]\n    type = ElementAverageValue\n    variable = sxx\n    execute_on = 'initial timestep_end'\n  []\n  [syy]\n    type = ElementAverageValue\n    variable = syy\n    execute_on = 'initial timestep_end'\n  []\n  [sxy]\n    type = ElementAverageValue\n    variable = sxy\n    execute_on = 'initial timestep_end'\n  []\n  [exx]\n    type = ElementAverageValue\n    variable = exx\n    execute_on = 'initial timestep_end'\n  []\n  [eyy]\n    type = ElementAverageValue\n    variable = eyy\n    execute_on = 'initial timestep_end'\n  []\n  [exy]\n    type = ElementAverageValue\n    variable = exy\n    execute_on = 'initial timestep_end'\n  []\n[]\n\n[Executioner]\n  type = Transient\n\n  solve_type = 'newton'\n  line_search = none\n\n  petsc_options_iname = '-pc_type'\n  petsc_options_value = 'lu'\n\n  l_max_its = 2\n  l_tol = 1e-14\n  nl_max_its = 30\n  nl_rel_tol = 1e-8\n  nl_abs_tol = 1e-10\n\n  start_time = 0.0\n  dt = 0.1\n  dtmin = 0.1\n  end_time = 0.5\n  \n[]\n\n[Outputs]\n  [mesh]\n    type = Exodus\n    file_base = ${csv_file}\n  []\n  [average_variable_values]\n    type = CSV\n    execute_on = 'TIMESTEP_END'\n    file_base = ${csv_file}\n  []\n[]",
                          "url": "https://github.com/idaholab/moose/discussions/25408#discussioncomment-6930006",
                          "updatedAt": "2023-09-06T20:17:31Z",
                          "publishedAt": "2023-09-06T20:16:59Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "dschwen"
                  },
                  "bodyText": "@reverendbedford developed this homogenization implementation. We have a separate system that you can find by searching for global strain in our docs.",
                  "url": "https://github.com/idaholab/moose/discussions/25408#discussioncomment-6993309",
                  "updatedAt": "2023-09-13T17:41:43Z",
                  "publishedAt": "2023-09-13T17:41:42Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": []
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "reverendbedford"
                  },
                  "bodyText": "Can you post the result you were comparing against? What result were you expecting and what did you get?",
                  "url": "https://github.com/idaholab/moose/discussions/25408#discussioncomment-6993464",
                  "updatedAt": "2023-09-13T18:00:16Z",
                  "publishedAt": "2023-09-13T18:00:15Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "eduardogrodriguez89"
                          },
                          "bodyText": "In the figure I show the experiment I want to perform. I want to determine the effective properties C_{11}. To do this I restrict the movements as shown in the script.\nMy question is if the constrains are okay? That is, if I want to determine C_{11}, should I only activate the first constraint? and in targets also the first one?",
                          "url": "https://github.com/idaholab/moose/discussions/25408#discussioncomment-7037942",
                          "updatedAt": "2023-09-18T18:06:52Z",
                          "publishedAt": "2023-09-18T18:06:51Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "reverendbedford"
                          },
                          "bodyText": "Sorry for the delay, busy week.\nIt's tough to tell without the mesh file that you are using, but my guess is that you are over constraining the displacements.  It looks like you are fixing the displacements along the entirety of the \"left\" and \"bottom\" surfaces.  That's too much constraint, it will prevent the microscale from being anything but affine, which isn't what you want.\nInstead pick two nodes in the interior of the domain.  Fix both x and y to zero for the first and fix just y for the second (see crude picture).  Then try running again.",
                          "url": "https://github.com/idaholab/moose/discussions/25408#discussioncomment-7085293",
                          "updatedAt": "2023-09-22T19:57:05Z",
                          "publishedAt": "2023-09-22T19:57:04Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "eduardogrodriguez89"
                  },
                  "bodyText": "Sorry for the delay.\nI tried again with your suggestion, fixing points 1 and 2, but I'm not getting the result in Table 3.\nI have doubts about:\na) Constrains_types and targets.\nIf I want to obtain de C_11, Should I fix the stress/strain constraint_type in x, and target only in x?\nPoint_1= Fix in \"x\" and \"y\" direction.\nPoint_2= fix in \"y\" direction.\nb) To obtain the value of C_11, I should divide de sxx/exx, obtained from ElementAverageValue?\nC_11= sxx/exx ??? It ok??\nI get these results\nTime Step 5, time = 0.5, dt = 0.1\n 0 Nonlinear |R| = 1.000000e+08\n      0 Linear |R| = 1.000000e+08\n      1 Linear |R| = 2.789850e-07\n 1 Nonlinear |R| = 3.497639e-05\n Solve Converged!\n\nPostprocessor Values:\n+----------------        +----------------      +----------------            +----------------           +----------------         +----------------         +----------------+\n| time                   | exx                   | exy                       | eyy                         | sxx                      | sxy                      | syy            |\n+----------------        +----------------       +----------------           +----------------           +----------------         +----------------         +----------------+\n|   0.000000e+00 |   0.000000e+00 |   0.000000e+00 |   0.000000e+00 |   0.000000e+00 |   0.000000e+00 |   0.000000e+00 |\n|   1.000000e-01 |   6.206073e-04 |   6.358997e-07 |  -2.645817e-18 |   1.000000e+08 |   6.510927e+04 |   2.871875e+07 |\n|   2.000000e-01 |   1.241215e-03 |   1.271799e-06 |   2.462338e-18 |   2.000000e+08 |   1.302185e+05 |   5.743750e+07 |\n|   3.000000e-01 |   1.861822e-03 |   1.907699e-06 |  -7.450714e-19 |   3.000000e+08 |   1.953278e+05 |   8.615625e+07 |\n|   4.000000e-01 |   2.482429e-03 |   2.543599e-06 |  -6.918406e-19 |   4.000000e+08 |   2.604371e+05 |   1.148750e+08 |\n|   5.000000e-01 |   3.103036e-03 |   3.179499e-06 |   6.418657e-19 |   5.000000e+08 |   3.255463e+05 |   1.435938e+08 |\n+----------------+----------------+----------------+----------------+----------------+----------------+----------------+\n\n\nScalar Variable Values:\n+----------------+----------------+\n| time           | hvar           |\n+----------------+----------------+\n|   0.000000e+00 |   0.000000e+00 |\n|   1.000000e-01 |   6.218791e-04 |\n|   2.000000e-01 |   1.243758e-03 |\n|   3.000000e-01 |   1.865637e-03 |\n|   4.000000e-01 |   2.487516e-03 |\n|   5.000000e-01 |   3.109395e-03 |\n+----------------+----------------+\n\nHere is the  code:\ncode.zip\ncsv_file = 'cell_average_values'\n\n[GlobalParams]\n  displacements = 'disp_x disp_y'\n  large_kinematics = false\n  macro_gradient = hvar\n  homogenization_constraint = homogenization\n[]\n\n[Mesh]\n  [base]\n    type = FileMeshGenerator\n    file = 'RVE_047.msh'\n  []\n[]\n\n[Variables]\n  [disp_x]\n  []\n  [disp_y]\n  []\n  [hvar]\n    family = SCALAR\n    order = FIRST\n  []\n[]\n\n[AuxVariables]\n  [sxx]\n    family = MONOMIAL\n    order = CONSTANT\n  []\n  [syy]\n    family = MONOMIAL\n    order = CONSTANT\n  []\n  [sxy]\n    family = MONOMIAL\n    order = CONSTANT\n  []\n  [exx]\n    family = MONOMIAL\n    order = CONSTANT\n  []\n  [eyy]\n    family = MONOMIAL\n    order = CONSTANT\n  []\n  [exy]\n    family = MONOMIAL\n    order = CONSTANT\n  []\n[]\n\n[AuxKernels]\n  [sxx]\n    type = RankTwoAux\n    variable = sxx\n    rank_two_tensor = pk1_stress\n    index_i = 0\n    index_j = 0\n  []\n  [syy]\n    type = RankTwoAux\n    variable = syy\n    rank_two_tensor = pk1_stress\n    index_i = 1\n    index_j = 1\n  []\n  [sxy]\n    type = RankTwoAux\n    variable = sxy\n    rank_two_tensor = pk1_stress\n    index_i = 0\n    index_j = 1\n  []\n  [exx]\n    type = RankTwoAux\n    variable = exx\n    rank_two_tensor = mechanical_strain\n    index_i = 0\n    index_j = 0\n  []\n  [eyy]\n    type = RankTwoAux\n    variable = eyy\n    rank_two_tensor = mechanical_strain\n    index_i = 1\n    index_j = 1\n  []\n  [exy]\n    type = RankTwoAux\n    variable = exy\n    rank_two_tensor = mechanical_strain\n    index_i = 0\n    index_j = 1\n  []\n[]\n\n[UserObjects]\n  [homogenization]\n    type = HomogenizationConstraint\n  #constraint_types = '    x    xy      0    xy    y     0   0    0    0'\n    #constraint_types = 'stress none none none none none none none none'\n    constraint_types = 'stress none none none none none none none none'\n    targets = 'stress11 0 0'\n    execute_on = 'INITIAL LINEAR NONLINEAR'\n  []\n[]\n\n[Kernels]\n  [sdx]\n    type = HomogenizedTotalLagrangianStressDivergence\n    variable = disp_x\n    component = 0\n  []\n  [sdy]\n    type = HomogenizedTotalLagrangianStressDivergence\n    variable = disp_y\n    component = 1\n  []\n[]\n\n[ScalarKernels]\n  [enforce]\n    type = HomogenizationConstraintScalarKernel\n    variable = hvar\n  []\n[]\n\n[Functions]\n  [strain11]\n    type = ParsedFunction\n    expression = '6.0e-2*t'\n  []\n  [stress11]\n    type = ParsedFunction\n    expression = '1e9*t'\n  []\n[]\n\n[BCs]\n  [Periodic]\n    [x]\n      variable = disp_x\n      auto_direction = 'x y'\n    []\n    [y]\n      variable = disp_y\n      auto_direction = 'x y'\n    []\n  []\n   [fix1_x]\n     type = DirichletBC\n     boundary = 1\n     variable = disp_x\n     value = 0\n   []\n   [fix1_y]\n     type = DirichletBC\n     boundary = 1\n     variable = disp_y\n     value = 0\n   []\n  [fix2_y]\n    type = DirichletBC\n    boundary = 2\n    variable = disp_y\n    value = 0\n  []\n[]\n\nE1 = '68.3e9' #Aluminum\nnu1 = '0.3'\nE2 = '379.3e9' #Boron\nnu2 = '0.1'\n\n[Materials]\n  [elastic_tensor_1]\n    type = ComputeIsotropicElasticityTensor\n    youngs_modulus = ${E1}\n    poissons_ratio = ${nu1}\n    block = 'Rectangulo'\n  []\n  [elastic_tensor_2]\n    type = ComputeIsotropicElasticityTensor\n    youngs_modulus = ${E2}\n    poissons_ratio = ${nu2}\n    block = 'Circulo'\n  []\n\n  [compute_stress]\n    type = ComputeLagrangianLinearElasticStress\n  []\n  [compute_strain]\n    type = ComputeLagrangianStrain\n    homogenization_gradient_names = 'homogenization_gradient'\n  []\n  [compute_homogenization_gradient]\n    type = ComputeHomogenizedLagrangianStrain\n  []\n[]\n\n[Postprocessors]\n  [sxx]\n    type = ElementAverageValue\n    variable = sxx\n    execute_on = 'initial timestep_end'\n  []\n  [syy]\n    type = ElementAverageValue\n    variable = syy\n    execute_on = 'initial timestep_end'\n  []\n  [sxy]\n    type = ElementAverageValue\n    variable = sxy\n    execute_on = 'initial timestep_end'\n  []\n  [exx]\n    type = ElementAverageValue\n    variable = exx\n    execute_on = 'initial timestep_end'\n  []\n  [eyy]\n    type = ElementAverageValue\n    variable = eyy\n    execute_on = 'initial timestep_end'\n  []\n  [exy]\n    type = ElementAverageValue\n    variable = exy\n    execute_on = 'initial timestep_end'\n  []\n[]\n\n[Executioner]\n  type = Transient\n\n  solve_type = 'newton'\n  line_search = none\n\n  petsc_options_iname = '-pc_type'\n  petsc_options_value = 'lu'\n\n  l_max_its = 2\n  l_tol = 1e-14\n  nl_max_its = 30\n  nl_rel_tol = 1e-8\n  nl_abs_tol = 1e-10\n\n  start_time = 0.0\n  dt = 0.1\n  dtmin = 0.1\n  end_time = 0.5\n  \n  # [TimeIntegrator]\n  #   type = BDF2\n  # []\n[]\n\n[Outputs]\n  [mesh]\n    type = Exodus\n    file_base = ${csv_file}\n  []\n  [average_variable_values]\n    type = CSV\n    execute_on = 'TIMESTEP_END'\n    file_base = ${csv_file}\n  []\n[]\n``\n\nThe mesh is the same as before.",
                  "url": "https://github.com/idaholab/moose/discussions/25408#discussioncomment-7229935",
                  "updatedAt": "2023-10-09T13:13:17Z",
                  "publishedAt": "2023-10-09T12:23:17Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": []
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "eduardogrodriguez89"
                  },
                  "bodyText": "If I calculate C in the x direction, I get:\nCxx = 5.000000e+08/3.103036e-03 = 161.13 MPa This value is different according to values in table 3, C22=C33=124.3 MPa.",
                  "url": "https://github.com/idaholab/moose/discussions/25408#discussioncomment-7230068",
                  "updatedAt": "2023-10-09T12:37:37Z",
                  "publishedAt": "2023-10-09T12:37:36Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "reverendbedford"
                          },
                          "bodyText": "Take a look at this input:\ncsv_file = 'cell_average_values'\n\n[GlobalParams]\n  displacements = 'disp_x disp_y'\n[]\n\n[Mesh]\n  [base]\n    type = FileMeshGenerator\n    file = 'RVE_047.msh'\n  []\n[]\n\n\n[Modules]\n  [TensorMechanics]\n    [Master]\n      [all]\n        strain = SMALL\n        add_variables = true\n        new_system = true\n        formulation = TOTAL\n        volumetric_locking_correction = false\n        constraint_types = 'strain none none strain strain none none none none'\n        targets = 'strain11 zero zero'\n        generate_output = 'pk1_stress_xx pk1_stress_xy pk1_stress_xz pk1_stress_yx pk1_stress_yy '\n                          'pk1_stress_yz pk1_stress_zx pk1_stress_zy pk1_stress_zz '\n                          'mechanical_strain_xx mechanical_strain_xy mechanical_strain_xz '\n                          'mechanical_strain_yx mechanical_strain_yy mechanical_strain_yz '\n                          'mechanical_strain_zx mechanical_strain_zy mechanical_strain_zz'\n      []\n    []\n  []\n[]\n\n\n\n[Functions]\n  [strain11]\n    type = ConstantFunction\n    value = 1.0\n  []\n  [zero]\n    type = ConstantFunction\n    value = 0.0\n  []\n[]\n\n[BCs]\n  [Periodic]\n    [x]\n      variable = disp_x\n      auto_direction = 'x y'\n    []\n    [y]\n      variable = disp_y\n      auto_direction = 'x y'\n    []\n  []\n   [fix1_x]\n     type = DirichletBC\n     boundary = 1\n     variable = disp_x\n     value = 0\n   []\n   [fix1_y]\n     type = DirichletBC\n     boundary = 1\n     variable = disp_y\n     value = 0\n   []\n  [fix2_y]\n    type = DirichletBC\n    boundary = 2\n    variable = disp_y\n    value = 0\n  []\n[]\n\nE1 = '68.3e3' #Aluminum\nnu1 = '0.3'\nE2 = '379.3e3' #Boron\nnu2 = '0.1'\n\n[Materials]\n  [elastic_tensor_1]\n    type = ComputeIsotropicElasticityTensor\n    youngs_modulus = ${E1}\n    poissons_ratio = ${nu1}\n    block = 'Rectangulo'\n  []\n  [elastic_tensor_2]\n    type = ComputeIsotropicElasticityTensor\n    youngs_modulus = ${E2}\n    poissons_ratio = ${nu2}\n    block = 'Circulo'\n  []\n\n  [compute_stress]\n    type = ComputeLagrangianLinearElasticStress\n  []\n[]\n\n[Postprocessors]\n  [sxx]\n    type = ElementAverageValue\n    variable = pk1_stress_xx\n  []\n  [syy]\n    type = ElementAverageValue\n    variable = pk1_stress_yy\n  []\n  [sxy]\n    type = ElementAverageValue\n    variable = pk1_stress_xy\n  []\n  [szz]\n    type = ElementAverageValue\n    variable = pk1_stress_zz\n  []\n  [exx]\n    type = ElementAverageValue\n    variable = mechanical_strain_xx\n  []\n  [eyy]\n    type = ElementAverageValue\n    variable = mechanical_strain_yy\n  []\n  [exy]\n    type = ElementAverageValue\n    variable = mechanical_strain_xy\n  []\n  [ezz]\n    type = ElementAverageValue\n    variable = mechanical_strain_zz\n  []\n[]\n\n[Preconditioning]\n  [smp]\n    type = SMP\n    full = true\n  []\n[]\n\n[Executioner]\n  type = Steady\n\n  solve_type = 'newton'\n  line_search = none\n\n  petsc_options_iname = '-pc_type'\n  petsc_options_value = 'lu'\n\n  l_max_its = 2\n  l_tol = 1e-14\n  nl_max_its = 30\n  nl_rel_tol = 1e-8\n  nl_abs_tol = 1e-10\n[]\n\n[Outputs]\n  [mesh]\n    type = Exodus\n    file_base = ${csv_file}\n  []\n  [average_variable_values]\n    type = CSV\n    execute_on = 'TIMESTEP_END'\n    file_base = ${csv_file}\n  []\n[]\n\nThere are a few cosmetic changes:\n\nI'm using the action system, which for me is way easier to set things up.\nI'm doing a steady solve as this seems to be linear elastic.\nI'm using a target macroscale strain of 1 to make the division easier\nI changed your units to (presumably) GPa for stress.  I was getting weird convergence issues with our default tolerances for your units, which were probably Pa for stress.  You could fiddle with the tolerances if you like the original units.\n\nThere are two important changes:\n\nFor a 2D small-strain problem you always need to have three constraints and a third order homogenization scalar variable (i.e. three scalar constraints).  That's because in 2D for small strains you have three independent strain components.  We should probably improve the error messages, but at least the action system here won't let you run with the single scalar constraint as you had before.\nTo calculate rows of the stiffness matrix you should apply a single unit strain in one \"generalized direction\" (xx, yy, yz) and zero strain in the other two directions.  The homogenized stresses are then going to be that row of the stiffness matrix directly.  So this example here gives you C11, C12, and C13 from the values of s_xx, s_yy, and s_xy.  You can change the unit strain to the other two directions to read off the rest of the rows of the stiffness tensor.\n\nOne thing to keep in mind is that this is a plane strain problem as you have it setup.  Hopefully that's what you want.",
                          "url": "https://github.com/idaholab/moose/discussions/25408#discussioncomment-7258513",
                          "updatedAt": "2023-10-12T01:59:29Z",
                          "publishedAt": "2023-10-12T01:58:01Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "reverendbedford"
                          },
                          "bodyText": "Another problem: it looks like you are fixing a \"bad\" point to remove the rigid body modes.  See this output with the displaced mesh:\n\nIt looks like one of your fixed displacements is that upper left point?  Or something else must be off with the mesh.  Your point to fix to remove the rigid body modes can be arbitrary, but they can't be on the outside of the domain where the periodic constraints are applied.",
                          "url": "https://github.com/idaholab/moose/discussions/25408#discussioncomment-7258572",
                          "updatedAt": "2023-10-12T02:06:38Z",
                          "publishedAt": "2023-10-12T02:06:37Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "reverendbedford"
                          },
                          "bodyText": "Err, if I look in paraview I don't see any nodes in your \"fix1\" and \"fix2\" nodesets.  You may not be constraining any rigid modes, which would explain the convergence issue and the weird displacements in my previous post.",
                          "url": "https://github.com/idaholab/moose/discussions/25408#discussioncomment-7258593",
                          "updatedAt": "2023-10-12T02:10:35Z",
                          "publishedAt": "2023-10-12T02:10:34Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "Flux boundary condition on displaced mesh",
          "author": {
            "login": "NateAM"
          },
          "bodyText": "I would like to implement a flux boundary condition on the displaced mesh. To do this, I was thinking I would be able to simply inherit from IntegratedBC and then implement the correct off-diagonal Jacobians (I know I could also use AD) but the displacements have not been made available. So that the integration occurs over the deformed geometry, how do I extend IntegratedBC to use the displacements? I know TensorMechanics has their pressure kernel but there seems to be a lot more going on there that (at least to me) confuses the issue.",
          "url": "https://github.com/idaholab/moose/discussions/25724",
          "updatedAt": "2023-10-11T23:41:56Z",
          "publishedAt": "2023-10-11T20:43:53Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "lindsayad"
                  },
                  "bodyText": "Two things come to my mind\n\nweak form integration will occur automatically on the deformed geometry as long as you specify use_displaced_mesh = true in your input file for your integrated boundary condition\nWhen discussing implementing off-diagonal Jacobians are you referring to coding the off-diagonal Jacobians with respect to the displacements themselves? E.g. the dependence on JxW, shape function gradients, etc. on the displacement field?",
                  "url": "https://github.com/idaholab/moose/discussions/25724#discussioncomment-7257561",
                  "updatedAt": "2023-10-11T23:01:09Z",
                  "publishedAt": "2023-10-11T23:01:09Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "NateAM"
                          },
                          "bodyText": "Hi @lindsayad\n\nIs this true even though IntegratedBC doesn't have _displacements defined? How can we associate the jacobian with a specific displacement dof?\nYes, that's what I mean. I've been successful doing this on the volume integral terms and will need to do that for the surface integral too. I know what I need to implement but without the displacement DOF ids I'm stuck. I guess I could define those degrees of freedom and see if it works.",
                          "url": "https://github.com/idaholab/moose/discussions/25724#discussioncomment-7257653",
                          "updatedAt": "2023-10-11T23:21:55Z",
                          "publishedAt": "2023-10-11T23:21:52Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "lindsayad"
                          },
                          "bodyText": "Is this true even though IntegratedBC doesn't have _displacements defined?\n\nYes.\n\nHow can we associate the jacobian with a specific displacement dof?\n\nA different question and a good one. You could either modify IntegratedBC to do what KernelBase does or you could also do it in your derived class. Either way you want to give yourself a _displacements member.",
                          "url": "https://github.com/idaholab/moose/discussions/25724#discussioncomment-7257695",
                          "updatedAt": "2023-10-11T23:33:44Z",
                          "publishedAt": "2023-10-11T23:32:44Z",
                          "isAnswer": true
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "NateAM"
                          },
                          "bodyText": "Okay, great! I'll make those changes.\nI think I'll just do it like KernalBase does in my own class. Thanks for the help!",
                          "url": "https://github.com/idaholab/moose/discussions/25724#discussioncomment-7257738",
                          "updatedAt": "2023-10-11T23:41:55Z",
                          "publishedAt": "2023-10-11T23:41:54Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "MUMPS version",
          "author": {
            "login": "heinono1"
          },
          "bodyText": "Hi. I just pulled a new distribution of MOOSE to re-build from scratch. Because of our IT Security trolls, I could not pull MUMPS_5.6.1 from the graal.ens-lyon.fr site and so the installer looked for MUMPS at the anl.gov sites. It turns out the anl.gov sites are not in synch with the ens-lyon.fr site and only had version 5.6.0. Easy fix to just change the version in the install python script but I thought it could be worth to point this out if others run into trouble and don't know how to fix it.",
          "url": "https://github.com/idaholab/moose/discussions/25720",
          "updatedAt": "2023-10-11T18:03:23Z",
          "publishedAt": "2023-10-11T16:26:33Z",
          "category": {
            "name": "Q&A Getting Started"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "milljm"
                  },
                  "bodyText": "What is strange to me, is that I only run into this issue when attempting to build PETSc with MUMPS options while on an Apple Silicon machine. I can't explain why Linux and Intel Macs are fine \ud83d\ude15",
                  "url": "https://github.com/idaholab/moose/discussions/25720#discussioncomment-7254896",
                  "updatedAt": "2023-10-11T16:35:42Z",
                  "publishedAt": "2023-10-11T16:35:27Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "heinono1"
                          },
                          "bodyText": "Haha I am installing on Linux clusters and a Linux workstation (Ubuntu 22.04) - and I get the errors.....",
                          "url": "https://github.com/idaholab/moose/discussions/25720#discussioncomment-7255626",
                          "updatedAt": "2023-10-11T18:03:24Z",
                          "publishedAt": "2023-10-11T18:03:23Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "September 2023 Newsletter",
          "author": {
            "login": "cticenhour"
          },
          "bodyText": "The September 2023 MOOSE Newsletter has been released! A summary of the content is below:\n\nMOOSE Improvements\n\nNearest-point layered side integrals for functors added\nRestart system refactoring\nNew JSON reader\nMesh diagnostics introduced\nNew mesh generation capabilities\nNavier-Stokes module improvements\nStochastic tools module improvements\n\n\nlibMesh-level Changes\n\n2023.09.06 update\n\n\nPETSc-level Changes\n\nPETSc updated to 3.19.3\n\n\nBug Fixes and Minor Enhancements",
          "url": "https://github.com/idaholab/moose/discussions/25721",
          "updatedAt": "2023-10-11T16:50:15Z",
          "publishedAt": "2023-10-11T16:50:15Z",
          "category": {
            "name": "News"
          },
          "comments": {
            "edges": []
          }
        }
      },
      {
        "node": {
          "title": "Thermal hydraulics: pressure fluctuations at small dt",
          "author": {
            "login": "jvwilliams23"
          },
          "bodyText": "I have noticed some behaviour which I would say is non-physical in the thermal hydraulics module. At first I thought it was my own case configuration, but I have iteratively simplified the case all the way back to the tutorials (recent tutorial committed by @licharlot).\nDifferences from tutorial: I reduced the outlet pressure to atmospheric pressure (1e5 Pa), and changed the fluid properties to water (SimpleFluidProperties). I also changed the initial velocity to 0 m/s.\nWhen dt=10 as in the tutorial, the solve converges to steady state on the first step and the pressure drop is positive (pressure at inlet slightly higher than outlet). But when I set dt=1e-4, the flow is transient and the pressure drop fluctuates between positive and negative, then eventually converges to a steady-state solution with a negative pressure drop.\nMy question is, am I misinterpreting the physics here? Or is there some numerical issue? Note that this also appears when I set reversible=false for the inlet BC. I thought it may be a floating point issue, since the flowrate is quite low, but also when I use a higher massflow rate (m_dot_in = 1.0), I get negative pressure-drop at the start and then it converges to a sensible solution with a positive pressure-drop.\nT_in = 300. # K\nm_dot_in = 1e-2 # kg/s\npress = 1e5 # Pa\n\n[GlobalParams]\n  initial_p = ${press}\n  initial_vel = 0.0\n  initial_T = ${T_in}\n  gravity_vector = '0 0 0'\n\n  rdg_slope_reconstruction = minmod\n  scaling_factor_1phase = '1 1e-2 1e-4'\n  closures = thm_closures\n  fp = water\n[]\n\n[FluidProperties]\n  [water]\n    type=SimpleFluidProperties\n  []\n[]\n\n[Closures]\n  [thm_closures]\n    type = Closures1PhaseTHM\n  []\n[]\n\n[Components]\n  [inlet]\n    type = InletMassFlowRateTemperature1Phase\n    input = 'core_chan:in'\n    m_dot = ${m_dot_in}\n    T = ${T_in}\n  []\n\n  [core_chan]\n    type = FlowChannel1Phase\n    position = '0 0 0'\n    orientation = '0 0 1'\n    length = 1\n    n_elems = 25\n    A = 7.2548e-3\n    D_h = 7.0636e-2\n  []\n\n  [outlet]\n    type = Outlet1Phase\n    input = 'core_chan:out'\n    p = ${press}\n  []\n[]\n\n[Postprocessors]\n  [core_p_in]\n    type = SideAverageValue\n    boundary = core_chan:in\n    variable = p\n  []\n\n  [core_p_out]\n    type = SideAverageValue\n    boundary = core_chan:out\n    variable = p\n  []\n\n  [core_delta_p]\n    type = ParsedPostprocessor\n    pp_names = 'core_p_in core_p_out'\n    function = 'core_p_in - core_p_out'\n  []\n[]\n\n[Preconditioning]\n  [pc]\n    type = SMP\n    full = true\n  []\n[]\n\n[Executioner]\n  type = Transient\n  solve_type = NEWTON\n  line_search = basic\n\n  end_time=\"1000\"\n  dt=\"1e-04\"\n  # dt=\"10\"\n  dtmin=\"1e-12\"\n\n  petsc_options_iname = '-pc_type'\n  petsc_options_value = 'lu'\n\n  nl_rel_tol = 1e-8\n  nl_abs_tol = 1e-8\n  nl_max_its = 25\n  steady_state_detection=\"true\"\n\n[]\n\n[Outputs]\n  vtk=true\n  csv=true\n  print_linear_residuals = false\n[]",
          "url": "https://github.com/idaholab/moose/discussions/25718",
          "updatedAt": "2023-10-12T06:59:12Z",
          "publishedAt": "2023-10-11T15:10:45Z",
          "category": {
            "name": "Q&A Modules: General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "licharlot"
                  },
                  "bodyText": "Hello,\nI removed steady_state_detection=true. If turned on, as is, it stops the simulation before the actual steady state. If you let it run, it'll converge to steady state, you'll see the pressure drop is not changing anymore, and it has a positive value, which is close to the one you get with dt=10 .(9.45e-3 Pa vs 9.047e-3 Pa).  It is expected that setting a very small dt, you'd observe a transient. The fluid is initially at rest and at t=0, a mass flow rate is imposed. Because THM is solving for compressible flow, it is solving the wave propagation in the domain and you get these negative pressure drops.",
                  "url": "https://github.com/idaholab/moose/discussions/25718#discussioncomment-7254400",
                  "updatedAt": "2023-10-11T15:42:23Z",
                  "publishedAt": "2023-10-11T15:42:22Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": []
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "setting scalar variable parameter in action",
          "author": {
            "login": "jessecarterMOOSE"
          },
          "bodyText": "I have a NodalKernel that needs a coupled scalar variable. The parameter is set like params.addRequiredCoupledVar(\"lambda\") in my MyNodalKernel. It works when I have the kernels and variables all written out in my input file. Now I'm trying to make an action.\nIn my action I create the scalar variable:\nauto params = _factory.getValidParams(\"MooseVariable\");\nparams.set<MooseEnum>(\"order\") = \"FIRST\";\nparams.set<MooseEnum>(\"family\") = \"SCALAR\";\n_problem->addVariable(\"MooseVariable\", \"lambda\", params);\n\nThen when adding the kernel I do:\nstd::string var = \"lambda\";\nif (_current_task == \"add_nodal_kernel\") {\n  if (_problem->hasScalarVariable(var)) {\n    auto params = _factory.getValidParams(\"MyNodalKernel\");\n    params.set<std::vector<VariableName>>(\"lambda\") = {var};  // note this wants a vector for some reason\n    (... more params...)\n    _problem->addNodalKernel(\"MyNodalKernel\", \"foo\", params);\n  }\n}\n\nWhen I go to create the object (_problem->addNodalKernel...) I get an runtime error: Scalar variable 'lambda' does not exist in this system, even though I explicitly tested for it above!\n(Also note the comment above where the parameter needs to be set to a vector of variables. If I just pass the variable itself, the code compiles but I get a different runtime error about \"VariableName should be std::vector...\", but that's a different issue...)",
          "url": "https://github.com/idaholab/moose/discussions/25715",
          "updatedAt": "2023-10-11T15:51:56Z",
          "publishedAt": "2023-10-11T14:27:36Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "jessecarterMOOSE"
                  },
                  "bodyText": "The error about the variable needing to be a vector of variables is:\nAttempting to set parameter \"lambda\" with type (VariableName)\nbut the parameter already exists as type (std::vector<VariableName, std::allocatorVariableName> >)\n\nWhich I get when I do params.set<VariableName>(\"lambda\") = var but I can fix that by passing the variable as a one-item vector as you see above.",
                  "url": "https://github.com/idaholab/moose/discussions/25715#discussioncomment-7253789",
                  "updatedAt": "2023-10-11T14:46:30Z",
                  "publishedAt": "2023-10-11T14:46:30Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "do this\nparams.set<std::vector<VariableName>>(\"lambda\") = {var};",
                          "url": "https://github.com/idaholab/moose/discussions/25715#discussioncomment-7253927",
                          "updatedAt": "2023-10-11T14:58:16Z",
                          "publishedAt": "2023-10-11T14:58:16Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "jessecarterMOOSE"
                          },
                          "bodyText": "Yes, I did that (though it doesn't make sense). That's not my actual issue though.",
                          "url": "https://github.com/idaholab/moose/discussions/25715#discussioncomment-7253949",
                          "updatedAt": "2023-10-11T15:00:33Z",
                          "publishedAt": "2023-10-11T15:00:19Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "the coupleable interface works with vectors of variable names.\nparams.addCoupledVar is roughly the same as\nparams.addParam<std::vector<VariableName>>\nwith a bit of extra checking",
                          "url": "https://github.com/idaholab/moose/discussions/25715#discussioncomment-7254008",
                          "updatedAt": "2023-10-11T15:06:04Z",
                          "publishedAt": "2023-10-11T15:05:44Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "I think what you would want here is a setCoupledScalarVar routine. We could add it.\nIt s just a proliferation of APIs that do roughly the same thing",
                          "url": "https://github.com/idaholab/moose/discussions/25715#discussioncomment-7254025",
                          "updatedAt": "2023-10-11T15:07:01Z",
                          "publishedAt": "2023-10-11T15:07:00Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "ok getting to your issue now",
                          "url": "https://github.com/idaholab/moose/discussions/25715#discussioncomment-7254032",
                          "updatedAt": "2023-10-11T15:07:42Z",
                          "publishedAt": "2023-10-11T15:07:41Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "can you do this instead\ngetProblem().addVariable(\"MooseVariableScalar\", var_name, params);",
                          "url": "https://github.com/idaholab/moose/discussions/25715#discussioncomment-7254125",
                          "updatedAt": "2023-10-11T15:16:25Z",
                          "publishedAt": "2023-10-11T15:16:25Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "jessecarterMOOSE"
                          },
                          "bodyText": "yes that did it!",
                          "url": "https://github.com/idaholab/moose/discussions/25715#discussioncomment-7254191",
                          "updatedAt": "2023-10-11T15:21:40Z",
                          "publishedAt": "2023-10-11T15:21:39Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "jessecarterMOOSE"
                          },
                          "bodyText": "OK, next issue, below that I have a ScalarKernel (actually inherits from NodalScalarKernel), and I set the \"variable\" parameter like: params.set<VariableName>(\"variable\") = lambda;\nI get a runtime error:\nAttempting to set parameter \"variable\" with type (VariableName)\nbut the parameter already exists as type (NonlinearVariableName)\n\nThe error goes away if I change the type to NonlinearVariableName, but this is awkward because the variable is a scalar, which I would imagine is distinctively different from a nonlinear variable.",
                          "url": "https://github.com/idaholab/moose/discussions/25715#discussioncomment-7254248",
                          "updatedAt": "2023-10-11T15:26:46Z",
                          "publishedAt": "2023-10-11T15:26:46Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "scalar variables can be nonlinear.\nYou ll have to comply with the variable name type haha",
                          "url": "https://github.com/idaholab/moose/discussions/25715#discussioncomment-7254260",
                          "updatedAt": "2023-10-11T15:28:40Z",
                          "publishedAt": "2023-10-11T15:28:40Z",
                          "isAnswer": true
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "Define Material Property as Boundary Condition",
          "author": {
            "login": "FanZhangchen"
          },
          "bodyText": "Hi MOOSE Team,\nThe material property I need to implement in my problem is the slip rate and which is space-dependent, and the boundary condition of my problem is also related to the slip rate. So I have a question about whether the material property could be defined as the boundary condition in MOOSE? Or in other ways, could I get the nodal coordinate to use Boolean to define the boundary conditions inside the material property module?\nBest,\nZC",
          "url": "https://github.com/idaholab/moose/discussions/24106",
          "updatedAt": "2023-10-11T12:04:40Z",
          "publishedAt": "2023-04-18T08:56:26Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "hugary1995"
                  },
                  "bodyText": "It depends.\nIf you want to apply a nodal (Dirichlet) BC, there is no straightforward way of accessing material properties from the node. But you can always provide a spatially-varying function in a FunctionDirichletBC.\nIf you want to apply an integrated (Neumann, Robin, etc.) BC, yes you can define the BC as a function of some material properties. See this example: #24108 (comment)",
                  "url": "https://github.com/idaholab/moose/discussions/24106#discussioncomment-5648734",
                  "updatedAt": "2023-04-18T12:55:38Z",
                  "publishedAt": "2023-04-18T12:55:37Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "hugary1995"
                          },
                          "bodyText": "I said\n\nIf you want to apply a nodal (Dirichlet) BC, there is no straightforward way of accessing material properties from the node.\n\nSo it is technically possible to \"make\" material properties nodal. You'll essentially need an additional layer of projection. Let us know if you want to pursue that option.",
                          "url": "https://github.com/idaholab/moose/discussions/24106#discussioncomment-5648760",
                          "updatedAt": "2023-04-18T12:57:50Z",
                          "publishedAt": "2023-04-18T12:57:49Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "FanZhangchen"
                          },
                          "bodyText": "Could you give more information about the additional layer of projection?",
                          "url": "https://github.com/idaholab/moose/discussions/24106#discussioncomment-5658779",
                          "updatedAt": "2023-04-19T09:16:26Z",
                          "publishedAt": "2023-04-19T09:16:26Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "@hugary1995",
                          "url": "https://github.com/idaholab/moose/discussions/24106#discussioncomment-5759640",
                          "updatedAt": "2023-04-29T02:45:14Z",
                          "publishedAt": "2023-04-29T02:45:14Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "iomags2211"
                          },
                          "bodyText": "@hugary1995 can you give more information on this or has it been answered elsewhere?",
                          "url": "https://github.com/idaholab/moose/discussions/24106#discussioncomment-7251642",
                          "updatedAt": "2023-10-11T11:26:23Z",
                          "publishedAt": "2023-10-11T11:26:22Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "hugary1995"
                          },
                          "bodyText": "You need to extrapolate the material property from quadrature points to nodes. You can do either a least squares fit or an L2 projection.\nFor least squares fit, you can follow what's been done in the nodal patch recovery system.\nFor L2 projection, you need a lower dimensional block on the boundary, and then add a MaterialPropertyValue kernel to perform the projection.",
                          "url": "https://github.com/idaholab/moose/discussions/24106#discussioncomment-7251932",
                          "updatedAt": "2023-10-11T12:04:40Z",
                          "publishedAt": "2023-10-11T12:04:39Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "How to set temperature-dependent specific heat capacity",
          "author": {
            "login": "Ali1990dashti"
          },
          "bodyText": "Dear community,\nI want to make specific heat capacity in one of the blocks (the aquifer block) dependent on temperature. I have a .csv containing the temperature and specific heat capacity values. I have read this discussion but still, I could not solve my issue. Implementing the specific heat capacity values as a function also works for me because I can extract a rough function out of values stored in the .csv file. The following is the input file I want to implement the temperature-dependent specific heat capacity on it:\n[Mesh]\n  [annular]\n    type = AnnularMeshGenerator\n    nr = 10\n    rmin = 1.0\n    rmax = 10\n    growth_r = 1.4\n    nt = 4\n    dmin = 0\n    dmax = 90\n  []\n  [make3D]\n    type = MeshExtruderGenerator\n    extrusion_vector = '0 0 12'\n    num_layers = 3\n    bottom_sideset = 'bottom'\n    top_sideset = 'top'\n    input = annular\n  []\n  [shift_down]\n    type = TransformGenerator\n    transform = TRANSLATE\n    vector_value = '0 0 -6'\n    input = make3D\n  []\n  [aquifer]\n    type = SubdomainBoundingBoxGenerator\n    block_id = 1\n    bottom_left = '0 0 -2'\n    top_right = '10 10 2'\n    input = shift_down\n  []\n  [injection_area]\n    type = ParsedGenerateSideset\n    combinatorial_geometry = 'x*x+y*y<1.01'\n    included_subdomain_ids = 1\n    new_sideset_name = 'injection_area'\n    input = 'aquifer'\n  []\n  [rename]\n    type = RenameBlockGenerator\n    old_block = '0 1'\n    new_block = 'caps aquifer'\n    input = 'injection_area'\n  []\n[]\n\n[GlobalParams]\n  PorousFlowDictator = dictator\n[]\n\n[Variables]\n  [porepressure]\n  []\n  [temperature]\n    initial_condition = 293\n    scaling = 1E-8\n  []\n[]\n\n[PorousFlowBasicTHM]\n  porepressure = porepressure\n  temperature = temperature\n  coupling_type = ThermoHydro\n  gravity = '0 0 0'\n  fp = the_simple_fluid\n[]\n\n[BCs]\n  [constant_injection_porepressure]\n    type = DirichletBC\n    variable = porepressure\n    value = 1E6\n    boundary = injection_area\n  []\n  [constant_injection_temperature]\n    type = DirichletBC\n    variable = temperature\n    value = 373\n    boundary = injection_area\n  []\n[]\n\n[FluidProperties]\n  [the_simple_fluid]\n    type = SimpleFluidProperties\n    bulk_modulus = 2E9\n    viscosity = 1.0E-3\n    density0 = 1000.0\n    thermal_expansion = 0.0002\n    cp = 4194\n    cv = 4186\n    porepressure_coefficient = 0\n  []\n[]\n\n[Materials]\n  [porosity]\n    type = PorousFlowPorosity\n    porosity_zero = 0.1\n  []\n  [biot_modulus]\n    type = PorousFlowConstantBiotModulus\n    biot_coefficient = 0.8\n    solid_bulk_compliance = 2E-7\n    fluid_bulk_modulus = 1E7\n  []\n  [permeability_aquifer]\n    type = PorousFlowPermeabilityConst\n    block = aquifer\n    permeability = '1E-14 0 0   0 1E-14 0   0 0 1E-14'\n  []\n  [permeability_caps]\n    type = PorousFlowPermeabilityConst\n    block = caps\n    permeability = '1E-15 0 0   0 1E-15 0   0 0 1E-16'\n  []\n  [thermal_expansion]\n    type = PorousFlowConstantThermalExpansionCoefficient\n    biot_coefficient = 0.8\n    drained_coefficient = 0.003\n    fluid_coefficient = 0.0002\n  []\n  [rock_internal_energy_non_res]\n    type = PorousFlowMatrixInternalEnergy\n    density = 2500.0\n    specific_heat_capacity = 1200.0\n    block = 'caps'\n  []\n  [rock_internal_energy_res]\n    type = PorousFlowMatrixInternalEnergy\n    density = 2500.0\n    specific_heat_capacity = 1200.0 # this is what I want to change\n    block = 'aquifer'\n  []\n  [thermal_conductivity]\n    type = PorousFlowThermalConductivityIdeal\n    dry_thermal_conductivity = '10 0 0  0 10 0  0 0 10'\n    block = 'caps aquifer'\n  []\n[]\n\n[Preconditioning]\n  active = basic\n  [basic]\n    type = SMP\n    full = true\n    petsc_options = '-ksp_diagonal_scale -ksp_diagonal_scale_fix'\n    petsc_options_iname = '-pc_type -sub_pc_type -sub_pc_factor_shift_type -pc_asm_overlap'\n    petsc_options_value = ' asm      lu           NONZERO                   2'\n  []\n[]\n\n[Executioner]\n  type = Transient\n  solve_type = Newton\n  end_time = 864000\n  dt = 43200\n  nl_abs_tol = 1E-10\n[]\n\n[Outputs]\n  exodus = true\n[]\n\nThe .csv file is also attached.\nThanks for your support.\nvalues.csv",
          "url": "https://github.com/idaholab/moose/discussions/25688",
          "updatedAt": "2023-10-11T09:03:44Z",
          "publishedAt": "2023-10-09T08:14:50Z",
          "category": {
            "name": "Q&A Modules: Porous Flow"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "cpgr"
                  },
                  "bodyText": "I think you will need to either make a new material that takes a function instead of a single value, or perhaps modify PorousFlowMatrixInternalEnergy to take a function",
                  "url": "https://github.com/idaholab/moose/discussions/25688#discussioncomment-7229196",
                  "updatedAt": "2023-10-09T10:51:07Z",
                  "publishedAt": "2023-10-09T10:51:06Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "For the function, because you have\n\n.csv containing the temperature and specific heat capacity values\n\nI would recommend this one:\nhttps://mooseframework.inl.gov/source/functions/PiecewiseLinear.html\nwith the data_file parameter",
                          "url": "https://github.com/idaholab/moose/discussions/25688#discussioncomment-7230397",
                          "updatedAt": "2023-10-09T13:15:57Z",
                          "publishedAt": "2023-10-09T13:15:56Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "Ali1990dashti"
                          },
                          "bodyText": "@GiudGiud\nThanks for your help.\nI have been struggling with .C and .h files of porous flow to convert specific_heat_capacity from a Real into a Function, however I have not progressed due to my naive coding skills. This is the .C file and I only changed params.addRequiredParam<Real> to params.addRequiredParam<FunctionName>:\n#include \"PorousFlowMatrixInternalEnergy.h\"\n\nregisterMooseObject(\"PorousFlowApp\", PorousFlowMatrixInternalEnergy);\n\nInputParameters\nPorousFlowMatrixInternalEnergy::validParams()\n{\n  InputParameters params = PorousFlowMaterialVectorBase::validParams();\n  params.addRequiredParam<FunctionName>(\"specific_heat_capacity\",\n                                \"Specific heat capacity of the rock grains (J/kg/K).\");\n  params.addRequiredParam<Real>(\"density\", \"Density of the rock grains\");\n  params.set<bool>(\"at_nodes\") = true;\n  params.addPrivateParam<std::string>(\"pf_material_type\", \"matrix_internal_energy\");\n  params.addClassDescription(\"This Material calculates the internal energy of solid rock grains, \"\n                             \"which is specific_heat_capacity * density * temperature.  Kernels \"\n                             \"multiply this by (1 - porosity) to find the energy density of the \"\n                             \"porous rock in a rock-fluid system\");\n  return params;\n}\n\nPorousFlowMatrixInternalEnergy::PorousFlowMatrixInternalEnergy(const InputParameters & parameters)\n  : PorousFlowMaterialVectorBase(parameters),\n    _cp(getParam<Real>(\"specific_heat_capacity\")),\n    _density(getParam<Real>(\"density\")),\n    _heat_cap(_cp * _density),\n    _temperature_nodal(getMaterialProperty<Real>(\"PorousFlow_temperature_nodal\")),\n    _dtemperature_nodal_dvar(\n        getMaterialProperty<std::vector<Real>>(\"dPorousFlow_temperature_nodal_dvar\")),\n    _en_nodal(declareProperty<Real>(\"PorousFlow_matrix_internal_energy_nodal\")),\n    _den_nodal_dvar(\n        declareProperty<std::vector<Real>>(\"dPorousFlow_matrix_internal_energy_nodal_dvar\"))\n{\n  if (_nodal_material != true)\n    mooseError(\"PorousFlowMatrixInternalEnergy classes are only defined for at_nodes = true\");\n}\n\nvoid\nPorousFlowMatrixInternalEnergy::initQpStatefulProperties()\n{\n  _en_nodal[_qp] = _heat_cap * _temperature_nodal[_qp];\n}\n\nvoid\nPorousFlowMatrixInternalEnergy::computeQpProperties()\n{\n  _en_nodal[_qp] = _heat_cap * _temperature_nodal[_qp];\n\n  _den_nodal_dvar[_qp].assign(_num_var, 0.0);\n  for (unsigned v = 0; v < _num_var; ++v)\n    _den_nodal_dvar[_qp][v] = _heat_cap * _dtemperature_nodal_dvar[_qp][v];\n}\n\nCan you please tell me how I can change the input file type from double into function?\nAnd in the .h file also I have:\n#pragma once\n\n#include \"PorousFlowMaterialVectorBase.h\"\n\n/**\n * This material computes internal energy (J/m^3) for a rock matrix\n * assuming constant grain density, specific heat capacity, and\n * a linear relationship with temperature.  To get the volumetric\n * heat capacity of the rock in a rock-fluid system, the result must\n * be multiplied by (1 - porosity).\n */\nclass PorousFlowMatrixInternalEnergy : public PorousFlowMaterialVectorBase\n{\npublic:\n  static InputParameters validParams();\n\n  PorousFlowMatrixInternalEnergy(const InputParameters & parameters);\n\nprotected:\n  virtual void initQpStatefulProperties() override;\n  virtual void computeQpProperties() override;\n\n  /// Specific heat capacity of rock grains\n  const Real _cp;\n\n  /// Density of rock grains (equals the density of the matrix if porosity=0)\n  const Real _density;\n\n  /// Heat capacity = _cp * _density\n  const Real _heat_cap;\n\n  /// Temperature at the nodes\n  const MaterialProperty<Real> & _temperature_nodal;\n\n  /// d(temperature at the nodes)/d(PorousFlow variable)\n  const MaterialProperty<std::vector<Real>> & _dtemperature_nodal_dvar;\n\n  /// Matrix internal_energy at the nodes\n  MaterialProperty<Real> & _en_nodal;\n\n  /// d(matrix internal energy)/d(PorousFlow variable)\n  MaterialProperty<std::vector<Real>> & _den_nodal_dvar;\n};\n\nThanks for your time.",
                          "url": "https://github.com/idaholab/moose/discussions/25688#discussioncomment-7230561",
                          "updatedAt": "2023-10-09T13:33:27Z",
                          "publishedAt": "2023-10-09T13:33:26Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "_cp(getParam<Real>(\"specific_heat_capacity\")),\n\n->\n    _cp(getParam<FunctionName>(\"specific_heat_capacity\")),\n\nThen this wont work:\n    _heat_cap(_cp * _density),\n\njust do that multiplication whenever you use in _heat_cap. And remove the _heat_cap class member maybe\nin the header:\nconst Real _cp;\n\n->\nconst Function & _cp;",
                          "url": "https://github.com/idaholab/moose/discussions/25688#discussioncomment-7231657",
                          "updatedAt": "2023-10-09T15:13:56Z",
                          "publishedAt": "2023-10-09T15:13:24Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "cpgr"
                          },
                          "bodyText": "If this works ok it might be worth pushing it to MOOSE.",
                          "url": "https://github.com/idaholab/moose/discussions/25688#discussioncomment-7234912",
                          "updatedAt": "2023-10-09T22:51:30Z",
                          "publishedAt": "2023-10-09T22:51:29Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "Ali1990dashti"
                          },
                          "bodyText": "Dear @GiudGiud , as you predicted, MOOSE complained about the multiplication:\n_heat_cap(_cp * _density),\nSorry I did not get your solution\n\njust do that multiplication whenever you use in _heat_cap. And remove the _heat_cap class member maybe\n\nShould I simply comment the _heat_cap(_cp * _density), but then _heat_cap is called in the functions at the end of the .C file.\nI tried to convert _density from a Real  to a Function but again MOOSE said I could not multiply two functions and expect a double. I also tried to use do not define the _heat_cap and do the multiplication directly in the functions (like _en_nodal[_qp] = _cp * _density * _temperature_nodal[_qp];) but it raised to the following error:\nUsing HIT from /home/alid/projects/moose/framework/contrib/hit\nChecking if header needs updating: /home/alid/projects/moose/framework/include/base/MooseRevision.h...\nCompiling C++ (in opt mode) /home/alid/projects/moose/modules/porous_flow/build/unity_src/materials_Unity.C...\nIn file included from /home/alid/projects/moose/modules/porous_flow/build/unity_src/materials_Unity.C:37:\n/home/alid/projects/moose/modules/porous_flow/src/materials/PorousFlowMatrixInternalEnergy.C: In constructor 'PorousFlowMatrixInternalEnergy::PorousFlowMatrixInternalEnergy(const InputParameters&)':\n/home/alid/projects/moose/modules/porous_flow/src/materials/PorousFlowMatrixInternalEnergy.C:32:31: error: invalid initialization of reference of type 'const Function&' from expression of type 'const FunctionName'\n   32 |     _cp(getParam<FunctionName>(\"specific_heat_capacity\")),\n      |         ~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~\n/home/alid/projects/moose/modules/porous_flow/src/materials/PorousFlowMatrixInternalEnergy.C: In member function 'virtual void PorousFlowMatrixInternalEnergy::initQpStatefulProperties()':\n/home/alid/projects/moose/modules/porous_flow/src/materials/PorousFlowMatrixInternalEnergy.C:49:24: error: no match for 'operator*' (operand types are 'const Function' and 'const Real' {aka 'const double'})\n   49 |   _en_nodal[_qp] = _cp * _density * _temperature_nodal[_qp];\n      |                    ~~~ ^ ~~~~~~~~\n      |                    |     |\n      |                    |     const Real {aka const double}\n      |                    const Function",
                          "url": "https://github.com/idaholab/moose/discussions/25688#discussioncomment-7237736",
                          "updatedAt": "2023-10-10T12:26:13Z",
                          "publishedAt": "2023-10-10T07:27:50Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Delete that attribute. You won't be able to define it like this.\nThen wherever that attribute was, it s very easy to compute that multiplication there",
                          "url": "https://github.com/idaholab/moose/discussions/25688#discussioncomment-7240781",
                          "updatedAt": "2023-10-10T12:50:52Z",
                          "publishedAt": "2023-10-10T12:50:52Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "Ali1990dashti"
                          },
                          "bodyText": "I tried the following in the .C file:\n#include \"PorousFlowMatrixInternalEnergy.h\"\n\nregisterMooseObject(\"PorousFlowApp\", PorousFlowMatrixInternalEnergy);\n\nInputParameters\nPorousFlowMatrixInternalEnergy::validParams()\n{\n  InputParameters params = PorousFlowMaterialVectorBase::validParams();\n  params.addRequiredParam<FunctionName>(\"specific_heat_capacity\",\n                                \"Specific heat capacity of the rock grains (J/kg/K).\");\n  params.addRequiredParam<Real>(\"density\", \"Density of the rock grains\");\n  params.set<bool>(\"at_nodes\") = true;\n  params.addPrivateParam<std::string>(\"pf_material_type\", \"matrix_internal_energy\");\n  params.addClassDescription(\"This Material calculates the internal energy of solid rock grains, \"\n                             \"which is specific_heat_capacity * density * temperature.  Kernels \"\n                             \"multiply this by (1 - porosity) to find the energy density of the \"\n                             \"porous rock in a rock-fluid system\");\n  return params;\n}\n\nPorousFlowMatrixInternalEnergy::PorousFlowMatrixInternalEnergy(const InputParameters & parameters)\n  : PorousFlowMaterialVectorBase(parameters),\n    _cp(getParam<FunctionName>(\"specific_heat_capacity\")),\n    _density(getParam<Real>(\"density\")),\n    _temperature_nodal(getMaterialProperty<Real>(\"PorousFlow_temperature_nodal\")),\n    _dtemperature_nodal_dvar(\n        getMaterialProperty<std::vector<Real>>(\"dPorousFlow_temperature_nodal_dvar\")),\n    _en_nodal(declareProperty<Real>(\"PorousFlow_matrix_internal_energy_nodal\")),\n    _den_nodal_dvar(\n        declareProperty<std::vector<Real>>(\"dPorousFlow_matrix_internal_energy_nodal_dvar\"))\n{\n  if (_nodal_material != true)\n    mooseError(\"PorousFlowMatrixInternalEnergy classes are only defined for at_nodes = true\");\n}\n\nvoid\nPorousFlowMatrixInternalEnergy::initQpStatefulProperties()\n{\n  _en_nodal[_qp] = _cp * _density * _temperature_nodal[_qp];\n}\n\nvoid\nPorousFlowMatrixInternalEnergy::computeQpProperties()\n{\n  _en_nodal[_qp] = _cp * _density * _temperature_nodal[_qp];\n\n  _den_nodal_dvar[_qp].assign(_num_var, 0.0);\n  for (unsigned v = 0; v < _num_var; ++v)\n    _den_nodal_dvar[_qp][v] = _cp * _density * _dtemperature_nodal_dvar[_qp][v];\n}\n\nAnd in the .h file:\n#pragma once\n\n#include \"PorousFlowMaterialVectorBase.h\"\n\n/**\n * This material computes internal energy (J/m^3) for a rock matrix\n * assuming constant grain density, specific heat capacity, and\n * a linear relationship with temperature.  To get the volumetric\n * heat capacity of the rock in a rock-fluid system, the result must\n * be multiplied by (1 - porosity).\n */\nclass PorousFlowMatrixInternalEnergy : public PorousFlowMaterialVectorBase\n{\npublic:\n  static InputParameters validParams();\n\n  PorousFlowMatrixInternalEnergy(const InputParameters & parameters);\n\nprotected:\n  virtual void initQpStatefulProperties() override;\n  virtual void computeQpProperties() override;\n\n  /// Specific heat capacity of rock grains\n  const Function & _cp;\n\n  /// Density of rock grains (equals the density of the matrix if porosity=0)\n  const Real _density;\n\n  /// Temperature at the nodes\n  const MaterialProperty<Real> & _temperature_nodal;\n\n  /// d(temperature at the nodes)/d(PorousFlow variable)\n  const MaterialProperty<std::vector<Real>> & _dtemperature_nodal_dvar;\n\n  /// Matrix internal_energy at the nodes\n  MaterialProperty<Real> & _en_nodal;\n\n  /// d(matrix internal energy)/d(PorousFlow variable)\n  MaterialProperty<std::vector<Real>> & _den_nodal_dvar;\n};\n\nBut in the compilation the following error raised:\nUsing HIT from /home/alid/projects/moose/framework/contrib/hit\nChecking if header needs updating: /home/alid/projects/moose/framework/include/base/MooseRevision.h...\nCreating Unity /home/alid/projects/moose/modules/porous_flow/build/unity_src/materials_Unity.C\nCompiling C++ (in opt mode) /home/alid/projects/moose/modules/porous_flow/build/unity_src/materials_Unity.C...\nIn file included from /home/alid/projects/moose/modules/porous_flow/build/unity_src/materials_Unity.C:37:\n/home/alid/projects/moose/modules/porous_flow/src/materials/PorousFlowMatrixInternalEnergy.C: In constructor 'PorousFlowMatrixInternalEnergy::PorousFlowMatrixInternalEnergy(const InputParameters&)':\n/home/alid/projects/moose/modules/porous_flow/src/materials/PorousFlowMatrixInternalEnergy.C:32:31: error: invalid initialization of reference of type 'const Function&' from expression of type 'const FunctionName'\n   32 |     _cp(getParam<FunctionName>(\"specific_heat_capacity\")),\n      |         ~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~\n/home/alid/projects/moose/modules/porous_flow/src/materials/PorousFlowMatrixInternalEnergy.C: In member function 'virtual void PorousFlowMatrixInternalEnergy::initQpStatefulProperties()':\n/home/alid/projects/moose/modules/porous_flow/src/materials/PorousFlowMatrixInternalEnergy.C:48:24: error: no match for 'operator*' (operand types are 'const Function' and 'const Real' {aka 'const double'})\n   48 |   _en_nodal[_qp] = _cp * _density * _temperature_nodal[_qp];\n      |                    ~~~ ^ ~~~~~~~~\n      |                    |     |\n      |                    |     const Real {aka const double}\n      |                    const Function\nIn file included from /home/alid/miniconda3/envs/moose/include/petscsystypes.h:229,\n                 from /home/alid/miniconda3/envs/moose/include/petscsys.h:40,\n                 from /home/alid/miniconda3/envs/moose/include/petscbag.h:4,\n                 from /home/alid/miniconda3/envs/moose/include/petsc.h:5,\n                 from /home/alid/miniconda3/envs/moose/libmesh/include/libmesh/petsc_macro.h:66,\n                 from /home/alid/projects/moose/framework/build/header_symlinks/MooseTypes.h:21,\n                 from /home/alid/projects/moose/framework/build/header_symlinks/DataIO.h:14,\n                 from /home/alid/projects/moose/framework/build/header_symlinks/SystemBase.h:14,\n                 from /home/alid/projects/moose/framework/build/header_symlinks/AuxiliarySystem.h:13,\n                 from /home/alid/projects/moose/framework/build/header_symlinks/DerivativeMaterialInterface.h:12,\n                 from /home/alid/projects/moose/modules/porous_flow/build/header_symlinks/PorousFlowVariableBase.h:12,\n                 from /home/alid/projects/moose/modules/porous_flow/build/header_symlinks/PorousFlow1PhaseFullySaturated.h:12,\n                 from /home/alid/projects/moose/modules/porous_flow/src/materials/PorousFlow1PhaseFullySaturated.C:10,\n                 from /home/alid/projects/moose/modules/porous_flow/build/unity_src/materials_Unity.C:2:\n...\n...\n...",
                          "url": "https://github.com/idaholab/moose/discussions/25688#discussioncomment-7240869",
                          "updatedAt": "2023-10-10T12:58:20Z",
                          "publishedAt": "2023-10-10T12:58:20Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "You have to evaluate the function. You can't write _cp\nIt has to be _cp( current point , _t)\nI think the current point is something like _q_points[_qp] but please check other objects for an example",
                          "url": "https://github.com/idaholab/moose/discussions/25688#discussioncomment-7241075",
                          "updatedAt": "2023-10-10T13:16:24Z",
                          "publishedAt": "2023-10-10T13:16:23Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "Ali1990dashti"
                          },
                          "bodyText": "I found this example a bit like what I want but it is not multiplying the function into a double. Based on another example I used _cp.value(_t, _q_point[_qp]) but it did not work due to the following error:\nUsing HIT from /home/alid/projects/moose/framework/contrib/hit\nChecking if header needs updating: /home/alid/projects/moose/framework/include/base/MooseRevision.h...\nCreating Unity /home/alid/projects/moose/modules/porous_flow/build/unity_src/materials_Unity.C\nCompiling C++ (in opt mode) /home/alid/projects/moose/modules/porous_flow/build/unity_src/materials_Unity.C...\nIn file included from /home/alid/projects/moose/modules/porous_flow/build/unity_src/materials_Unity.C:37:\n/home/alid/projects/moose/modules/porous_flow/src/materials/PorousFlowMatrixInternalEnergy.C: In constructor 'PorousFlowMatrixInternalEnergy::PorousFlowMatrixInternalEnergy(const InputParameters&)':\n/home/alid/projects/moose/modules/porous_flow/src/materials/PorousFlowMatrixInternalEnergy.C:32:31: error: invalid initialization of reference of type 'const Function&' from expression of type 'const FunctionName'\n   32 |     _cp(getParam<FunctionName>(\"specific_heat_capacity\")),\n      |         ~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~\n/home/alid/projects/moose/modules/porous_flow/src/materials/PorousFlowMatrixInternalEnergy.C: In member function 'virtual void PorousFlowMatrixInternalEnergy::initQpStatefulProperties()':\n/home/alid/projects/moose/modules/porous_flow/src/materials/PorousFlowMatrixInternalEnergy.C:48:20: error: invalid use of incomplete type 'const class Function'\n   48 |   _en_nodal[_qp] = _cp.value(_t, _q_point[_qp]) * _density * _temperature_nodal[_qp];\n      |                    ^~~\nIn file included from /home/alid/projects/moose/framework/build/header_symlinks/ResidualObject.h:15,\n                 from /home/alid/projects/moose/framework/build/header_symlinks/KernelBase.h:12,\n                 from /home/alid/projects/moose/framework/build/header_symlinks/DerivativeMaterialInterface.h:16,\n                 from /home/alid/projects/moose/modules/porous_flow/build/header_symlinks/PorousFlowVariableBase.h:12,\n                 from /home/alid/projects/moose/modules/porous_flow/build/header_symlinks/PorousFlow1PhaseFullySaturated.h:12,\n                 from /home/alid/projects/moose/modules/porous_flow/src/materials/PorousFlow1PhaseFullySaturated.C:10,\n                 from /home/alid/projects/moose/modules/porous_flow/build/unity_src/materials_Unity.C:2:\n/home/alid/projects/moose/framework/build/header_symlinks/FunctionInterface.h:19:7: note: forward declaration of 'class Function'\n   19 | class Function;\n      |       ^~~~~~~~\nIn file included from /home/alid/projects/moose/modules/porous_flow/build/unity_src/materials_Unity.C:37:\n/home/alid/projects/moose/modules/porous_flow/src/materials/PorousFlowMatrixInternalEnergy.C: In member function 'virtual void PorousFlowMatrixInternalEnergy::computeQpProperties()':\n/home/alid/projects/moose/modules/porous_flow/src/materials/PorousFlowMatrixInternalEnergy.C:54:20: error: invalid use of incomplete type 'const class Function'\n   54 |   _en_nodal[_qp] = _cp.value(_t, _q_point[_qp]) * _density * _temperature_nodal[_qp];\n      |                    ^~~\nIn file included from /home/alid/projects/moose/framework/build/header_symlinks/ResidualObject.h:15,\n                 from /home/alid/projects/moose/framework/build/header_symlinks/KernelBase.h:12,\n                 from /home/alid/projects/moose/framework/build/header_symlinks/DerivativeMaterialInterface.h:16,\n                 from /home/alid/projects/moose/modules/porous_flow/build/header_symlinks/PorousFlowVariableBase.h:12,\n                 from /home/alid/projects/moose/modules/porous_flow/build/header_symlinks/PorousFlow1PhaseFullySaturated.h:12,\n                 from /home/alid/projects/moose/modules/porous_flow/src/materials/PorousFlow1PhaseFullySaturated.C:10,\n                 from /home/alid/projects/moose/modules/porous_flow/build/unity_src/materials_Unity.C:2:\n/home/alid/projects/moose/framework/build/header_symlinks/FunctionInterface.h:19:7: note: forward declaration of 'class Function'\n   19 | class Function;\n      |       ^~~~~~~~\nIn file included from /home/alid/projects/moose/modules/porous_flow/build/unity_src/materials_Unity.C:37:\n/home/alid/projects/moose/modules/porous_flow/src/materials/PorousFlowMatrixInternalEnergy.C:58:31: error: invalid use of incomplete type 'const class Function'\n   58 |     _den_nodal_dvar[_qp][v] = _cp.value(_t, _q_point[_qp]) * _density * _dtemperature_nodal_dvar[_qp][v];\n      |                               ^~~\nIn file included from /home/alid/projects/moose/framework/build/header_symlinks/ResidualObject.h:15,\n                 from /home/alid/projects/moose/framework/build/header_symlinks/KernelBase.h:12,\n                 from /home/alid/projects/moose/framework/build/header_symlinks/DerivativeMaterialInterface.h:16,\n                 from /home/alid/projects/moose/modules/porous_flow/build/header_symlinks/PorousFlowVariableBase.h:12,\n                 from /home/alid/projects/moose/modules/porous_flow/build/header_symlinks/PorousFlow1PhaseFullySaturated.h:12,\n                 from /home/alid/projects/moose/modules/porous_flow/src/materials/PorousFlow1PhaseFullySaturated.C:10,\n                 from /home/alid/projects/moose/modules/porous_flow/build/unity_src/materials_Unity.C:2:\n/home/alid/projects/moose/framework/build/header_symlinks/FunctionInterface.h:19:7: note: forward declaration of 'class Function'\n   19 | class Function;\n      |       ^~~~~~~~\n/home/alid/projects/moose/framework/build.mk:122: recipe for target '/home/alid/projects/moose/modules/porous_flow/build/unity_src/materials_Unity.x86_64-conda-linux-gnu.opt.lo' failed\nmake: *** [/home/alid/projects/moose/modules/porous_flow/build/unity_src/materials_Unity.x86_64-conda-linux-gnu.opt.lo] Error 1",
                          "url": "https://github.com/idaholab/moose/discussions/25688#discussioncomment-7242415",
                          "updatedAt": "2023-10-10T15:14:31Z",
                          "publishedAt": "2023-10-10T15:14:29Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "oh yeah this is wrong\n32 |     _cp(getParam(\"specific_heat_capacity\")),\nshould be something like\n32 |     _cp(getFunction(\"specific_heat_capacity\")),",
                          "url": "https://github.com/idaholab/moose/discussions/25688#discussioncomment-7242496",
                          "updatedAt": "2023-10-10T15:21:56Z",
                          "publishedAt": "2023-10-10T15:21:55Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "Creating a New Diffusion Kernel",
          "author": {
            "login": "jsevic"
          },
          "bodyText": "Hello,\nI have diffusion operator kernel written a few years based on the ExampleConvection coupled kernel example in Example 3. In that kernel I added a coupled parameter for temperature, creating a diffusion operator kernel where thermal conductivity is coupled into as its value is a function of temperature.\nI have tried the same thing from scratch in my latest MOOSE app from, and made the following changes. Since the example convection kernel is coupling some_gradient\n_grad_some_variable(coupledGradient(\"some_gradient\"))\n\nand I want to couple a real value for thermal conductivity, I changed coupledGradient to coupledValue, which is what my old kernel used. Then I changed in the .h file the VariableGradient declaration to VariableValue, and I get a compile error.\nprivate:\nconst VariableGradient & _grad_some_variable;\nMy original function compiles and passes tests this one does not. What am I missing? Any suggestions?\nThese are the errors I get.\nCompiling C++ (in opt mode) /Users/johnsevic/projects/moose/examples/ex03_coupling/build/unity_src/kernels_Unity.C...\nIn file included from /Users/johnsevic/projects/moose/examples/ex03_coupling/build/unity_src/kernels_Unity.C:2:\n/Users/johnsevic/projects/moose/examples/ex03_coupling/src/kernels/ExampleConvection.C:35:10: error: no viable conversion from returned value of type 'typename boostcopy::enable_if_c<ScalarTraits::value, TypeVector<typename CompareTypes<double, double>::supertype>>::type' (aka 'libMesh::TypeVector') to function return type 'libMesh::Real' (aka 'double')\nreturn _test[_i][_qp] * (_grad_some_variable[_qp] * _grad_u[_qp]);\n^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/Users/johnsevic/projects/moose/examples/ex03_coupling/src/kernels/ExampleConvection.C:41:10: error: no viable conversion from returned value of type 'typename boostcopy::enable_if_c<ScalarTraits::value, TypeVector<typename CompareTypes<double, double>::supertype>>::type' (aka 'libMesh::TypeVector') to function return type 'libMesh::Real' (aka 'double')\nreturn _test[_i][_qp] * (_grad_some_variable[_qp] * _grad_phi[_j][_qp]);\n^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n2 errors generated.\nmake: *** [/Users/johnsevic/projects/moose/framework/build.mk:151: /Users/johnsevic/projects/moose/examples/ex03_coupling/build/unity_src/kernels_Unity.aarch64-apple-darwin20.0.0.opt.lo] Error 1",
          "url": "https://github.com/idaholab/moose/discussions/25708",
          "updatedAt": "2023-10-11T01:53:17Z",
          "publishedAt": "2023-10-10T23:50:51Z",
          "category": {
            "name": "Q&A Getting Started"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\nThis is a vector now, when it used to be a scalar\nreturn _test[_i][_qp] * (_grad_some_variable[_qp] * _grad_u[_qp])\n\nbefore these, _grad_some_variable[_qp] and  _grad_u[_qp] are vectors so the product is a dot product. Now, one is a real and you end up returning a vector. This makes sense for a convection term in a PDE\nIf you are trying to substitute one into a conductivity, chances are you're modeling diffusion not convection and a diffusion kernel is a better example to follow\nGuillaume",
                  "url": "https://github.com/idaholab/moose/discussions/25708#discussioncomment-7247222",
                  "updatedAt": "2023-10-11T00:56:35Z",
                  "publishedAt": "2023-10-11T00:56:34Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": []
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "jsevic"
                  },
                  "bodyText": "OK so just to be clear, in this kernel I have changed the following line to include coupledValue instead of coupledGradient, so is this still producing a vector?\n_grad_some_variable(coupledValue(\"some_gradient\"))\nIn the .h file I have...\nVariableValue & _grad_some_variable;\nI did not change the variable name even though it says _grad_some_variable is physically k_thermal that gets coupld.",
                  "url": "https://github.com/idaholab/moose/discussions/25708#discussioncomment-7247319",
                  "updatedAt": "2023-10-11T01:13:37Z",
                  "publishedAt": "2023-10-11T01:12:39Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "no longer a vector. It s getting you Reals now",
                          "url": "https://github.com/idaholab/moose/discussions/25708#discussioncomment-7247349",
                          "updatedAt": "2023-10-11T01:17:28Z",
                          "publishedAt": "2023-10-11T01:17:27Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "jsevic"
                  },
                  "bodyText": "Yes that is what I was thought, so still confused. Eventually I want to implement this weak form\n_grad_u[_qp] * _grad_test[_i][_qp] * _sigma_e[_qp]\nso that's why I had coupledValue for _grad_some_variable and declared this as VariableValue in the .h file. Eventually _grad_some_variable will be the coupled electrical conductivity _sigma_e.",
                  "url": "https://github.com/idaholab/moose/discussions/25708#discussioncomment-7247385",
                  "updatedAt": "2023-10-11T01:24:51Z",
                  "publishedAt": "2023-10-11T01:24:50Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "this is fine though?\n_grad_u[_qp] * _grad_test[_i][_qp] is vector times vector -> real\n_sigma_e[_qp] is real I assume",
                          "url": "https://github.com/idaholab/moose/discussions/25708#discussioncomment-7247415",
                          "updatedAt": "2023-10-11T01:30:02Z",
                          "publishedAt": "2023-10-11T01:30:01Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "jsevic"
                  },
                  "bodyText": "Yes that worked in my earlier code. Does the order of operation matter? That may be my mistake? My new code gets the compile error. Yes _sigma_e is real.",
                  "url": "https://github.com/idaholab/moose/discussions/25708#discussioncomment-7247453",
                  "updatedAt": "2023-10-11T01:41:59Z",
                  "publishedAt": "2023-10-11T01:41:32Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "in the code you pasted earlier you have _test not _grad_test. Is that it?",
                          "url": "https://github.com/idaholab/moose/discussions/25708#discussioncomment-7247476",
                          "updatedAt": "2023-10-11T01:46:15Z",
                          "publishedAt": "2023-10-11T01:46:15Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "the order of operation for vector * real * vector or real * vector * vector etc does not matter",
                          "url": "https://github.com/idaholab/moose/discussions/25708#discussioncomment-7247481",
                          "updatedAt": "2023-10-11T01:46:44Z",
                          "publishedAt": "2023-10-11T01:46:44Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "jsevic"
                  },
                  "bodyText": "This worked.\nYes I did add now the _grad_test since I ultimately want the diffusion operator. Maybe that was the issue?\nReal\nExampleConvection::computeQpResidual()\n{\nreturn _grad_u[_qp] * _grad_test[_i][_qp] * _grad_some_variable[_qp];\n}\nReal\nExampleConvection::computeQpJacobian()\n{\nreturn _grad_some_variable[_qp] * _grad_phi[_j][_qp] * _grad_test[_i][_qp];\n}",
                  "url": "https://github.com/idaholab/moose/discussions/25708#discussioncomment-7247507",
                  "updatedAt": "2023-10-11T01:53:18Z",
                  "publishedAt": "2023-10-11T01:53:17Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": []
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "Error when initiating variables",
          "author": {
            "login": "ZoeyChen1993"
          },
          "bodyText": "Could anyone tell me why do I get this error message? Attach my input code and error",
          "url": "https://github.com/idaholab/moose/discussions/25034",
          "updatedAt": "2023-10-10T23:17:08Z",
          "publishedAt": "2023-07-25T20:52:46Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\nthe system is only detecting one timestep in that exodus file. Do you have 80?\nGuillaume",
                  "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6545228",
                  "updatedAt": "2023-07-25T22:52:25Z",
                  "publishedAt": "2023-07-25T22:52:24Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": []
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "ZoeyChen1993"
                  },
                  "bodyText": "Here is the output folder of start simulation, I want to restart from the timestep 80 or 132, there are total 133 output files here, the first one is the .e file",
                  "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6552334",
                  "updatedAt": "2023-07-26T14:24:37Z",
                  "publishedAt": "2023-07-26T14:24:35Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Use the name of the last exodus file instead of the short name. And use LATEST for the timestep",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6552388",
                          "updatedAt": "2023-07-26T14:30:05Z",
                          "publishedAt": "2023-07-26T14:30:04Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "ZoeyChen1993"
                  },
                  "bodyText": "I tried this way, the simulation runs, however I see the instruction from the website, I thought the time step could be specified https://mooseframework.inl.gov/application_usage/restart_recover.html. And the restart simulation doesn't converge since very beginning. It does converge in a single simulation with continuous time.",
                  "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6552476",
                  "updatedAt": "2023-08-04T14:02:07Z",
                  "publishedAt": "2023-07-26T14:38:28Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Exodus restart can be tricky to get right. I would recommend using checkpoint files for the restart first",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6552799",
                          "updatedAt": "2023-07-26T15:09:28Z",
                          "publishedAt": "2023-07-26T15:09:27Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "ZoeyChen1993"
                          },
                          "bodyText": "I still cannot get converge since very beginning of the restart by checking point restart like this.",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6555192",
                          "updatedAt": "2023-07-26T19:43:08Z",
                          "publishedAt": "2023-07-26T19:43:08Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Can you output with exodus on initial and confirm all the fields are properly initialized?\nyou are now mixing checkpoint and exodus restart syntax. The initial_from_file_var parameters are for exodus",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6562680",
                          "updatedAt": "2023-07-29T22:42:15Z",
                          "publishedAt": "2023-07-27T08:26:32Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "ZoeyChen1993"
                          },
                          "bodyText": "I am not familiar with the checkpoint restart, could you please give a reference syntax in input file for the checkpoint restart that I can refer to?",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6567145",
                          "updatedAt": "2023-07-27T15:56:58Z",
                          "publishedAt": "2023-07-27T15:56:58Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Hello\nThere's a few examples on the Virtual Test Bed of simulations using checkpoint restart:\nhttps://github.com/idaholab/virtual_test_bed/blob/main/sfr/abtr/abtr_ulof.i\nhttps://github.com/idaholab/virtual_test_bed/blob/main/msr/msre/reactivity_insertion/msre_pke_ss.i\nOtherwise the best documentation is here:\nhttps://mooseframework.inl.gov/application_usage/restart_recover.html\nfollow the advanced Restart section\nDid you do this?\n\nCan you output with exodus on initial and confirm all the fields are properly initialized?\n\nand what did it show?\nGuillaume",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6584955",
                          "updatedAt": "2023-07-29T22:45:53Z",
                          "publishedAt": "2023-07-29T22:45:52Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "ZoeyChen1993"
                          },
                          "bodyText": "The output of both the last timestep from start simulation and the initial step from restart simulation are showing here, all of the variables seem to be the same when initiate.\n\nAnd I still don't know how to correctly using checkpoint restart. It seems the only change of blocks is the mesh and problem, as you pointed, the initial_from_file_var is in exodus restart, so in checkpoint restart, what should I use for the variable initiation.",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6610226",
                          "updatedAt": "2023-08-01T21:42:58Z",
                          "publishedAt": "2023-08-01T21:42:57Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "can you please attach:\n\nthe full log for the first simulation\nthe log for the second simulation (restarts and fails)\nthe input file & mesh\n\nI d like to see if I can find what's wrong",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6610828",
                          "updatedAt": "2023-08-02T00:06:46Z",
                          "publishedAt": "2023-08-02T00:06:22Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "ZoeyChen1993"
                          },
                          "bodyText": "restart.tar.gz\nAttached the files here. Could you please take a look?",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6627725",
                          "updatedAt": "2023-08-03T13:08:06Z",
                          "publishedAt": "2023-08-03T13:08:06Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Hello\nThis does not look like a restart issue, because it crashes 20 time steps after the restart, not immediately.\nThen this convergence criterion\n  nl_rel_tol = 1e-3\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\nis extremely loose. You ll want to tighten it by 5 orders of magnitude most likely\nCould the problem come from ActivateEelementByPath\nin the first one you have this function for fx:\nif(t<15, 0, (t-15)*0.0008)', which reaches 5 * 0.0008 = 0.0040\n\nin the second one:\n(0.004+t*0.001)' which reaches 0.004 + 0.002 = 0.006\n\nso maybe run the first simulation longer? to reach the same fx and see if you hit the problem as well.",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6628126",
                          "updatedAt": "2023-08-03T13:40:53Z",
                          "publishedAt": "2023-08-03T13:40:35Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "ZoeyChen1993"
                          },
                          "bodyText": "Hi I attached the files include one start simulation ,one restart simulation , and one single simulation. The start simulation runs 20s, the function is\nif(t<15, 0, (t-15)*0.0008)', which reaches 5 * 0.0008 = 0.0040\nThen the restart simulation at t = 20s, for 10s, function is:\n(0.004+t*0.0008)', start from the fx = 0.004 which is the same location with the end of start simulation, and the speed does not change \nFor the single simulation is expected to run for total 30s, but doesn't converge at different timestep:\nif(t<15, 0, (t-15)*0.0008)', which reaches 5 * 0.0008 = 0.0040 at 20s, then keep running after 20s for another 10s,\nrestart_modify.tar.gz",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6629344",
                          "updatedAt": "2023-08-03T15:33:34Z",
                          "publishedAt": "2023-08-03T15:33:34Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "ZoeyChen1993"
                  },
                  "bodyText": "oh if you look at my second response and zip file, you'll see, I used speed of 0.0008 for both simulations.",
                  "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6638966",
                  "updatedAt": "2023-08-04T13:57:44Z",
                  "publishedAt": "2023-08-04T13:57:43Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": []
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "@dewenyushu can you please check if ActivateElementByPath is used properly here?\nAnything we ought to look out for with that object?\n@ZoeyChen1993 what kind of physics are you solving here? let's try to bring in people who do this into the conversation",
                  "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6639026",
                  "updatedAt": "2023-08-04T14:16:25Z",
                  "publishedAt": "2023-08-04T14:04:35Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "ZoeyChen1993"
                          },
                          "bodyText": "I'm solving a differential equation set involves thermal conduction and chemical reaction, which requires two variables in the input file, temperature and cure.",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6639330",
                          "updatedAt": "2023-08-04T14:31:48Z",
                          "publishedAt": "2023-08-04T14:31:48Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "dewenyushu"
                          },
                          "bodyText": "The syntax looks good to me.\nI do recall that there had been an issue using element activation (or element subdomain modifier) with restart, what we found a while back, IIRC, was while loading the checkpoint files, there seemed to be a mismatch between the number of material properties requested vs. provided in DataIO.\nIt might be helpful to run this in debug mode (if problem size can be reduced to shorten the runtime) and see if this is the same issue I had before..",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6641114",
                          "updatedAt": "2023-08-04T17:49:25Z",
                          "publishedAt": "2023-08-04T17:49:25Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "to run in debug mode, follow the instructions here to get a debug executable then use that\nhttps://mooseframework.inl.gov/application_development/debugging.html",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6652808",
                          "updatedAt": "2023-08-06T21:07:29Z",
                          "publishedAt": "2023-08-06T21:07:28Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "@dschwen who is a good person to bring in on thermal conduction + chemical reaction (cure) ?",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6652809",
                          "updatedAt": "2023-08-06T21:08:01Z",
                          "publishedAt": "2023-08-06T21:08:01Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "ZoeyChen1993"
                          },
                          "bodyText": "When I tried to make debug executable, I use METHOD=dbg make -j 8, and I think I got error output like this\n(moose) [zchen@mercury army_ants]$ METHOD=dbg make -j 4\nLinking Library /data/zchen/projects/moose/modules/solid_properties/lib/libsolid_properties-dbg.la...\nLinking Library /data/zchen/projects/moose/modules/navier_stokes/lib/libnavier_stokes-dbg.la...\nLinking Library /data/zchen/projects/moose/modules/contact/lib/libcontact-dbg.la...\nLinking Library /data/zchen/projects/moose/modules/peridynamics/lib/libperidynamics-dbg.la...\nLinking Library /data/zchen/projects/moose/modules/phase_field/lib/libphase_field-dbg.la...\nLinking Library /data/zchen/projects/moose/modules/porous_flow/lib/libporous_flow-dbg.la...\nLinking Library /data/zchen/projects/moose/modules/xfem/lib/libxfem-dbg.la...\nCompiling C++ (in dbg mode) /data/zchen/projects/army_ants/build/unity_src/kernels_Unity.C...\nCreating Unity /data/zchen/projects/army_ants/build/unity_src/materials_Unity.C\nCompiling C++ (in dbg mode) /data/zchen/projects/army_ants/build/unity_src/materials_Unity.C...\nLinking Library /data/zchen/projects/moose/modules/fsi/lib/libfsi-dbg.la...\nLinking Library /data/zchen/projects/moose/modules/thermal_hydraulics/lib/libthermal_hydraulics-dbg.la...\nLinking Library /data/zchen/projects/moose/modules/scalar_transport/lib/libscalar_transport-dbg.la...\nLinking Library /data/zchen/projects/moose/modules/combined/lib/libcombined-dbg.la...\nLinking Library /data/zchen/projects/moose/modules/module_loader/lib/libmodule_loader_with_cr_em_eps_fp_fet_gc_ls_ray_rdg_rct_rich_st_hc_sp_tm_ns_con_fsi_misc_opt_pd_pf_pflow_th_st_xfem_comb-dbg.la...\nLinking Library /data/zchen/projects/army_ants/test/lib/libarmy_ants_test-dbg.la...\nIn file included from /data/zchen/projects/army_ants/build/unity_src/kernels_Unity.C:2:\n/data/zchen/projects/army_ants/src/kernels/CPPAnonDgeneralPT.C: In member function 'virtual libMesh::Real CPPAnonDgeneralPT::computeQpJacobian()':\n/data/zchen/projects/army_ants/src/kernels/CPPAnonDgeneralPT.C:106:6: warning: unused variable 'Pc' [-Wunused-variable]\n  106 | Real Pc = KT*falpha;\n      |      ^~\nIn file included from /data/zchen/projects/army_ants/build/unity_src/kernels_Unity.C:3:\n/data/zchen/projects/army_ants/src/kernels/CPPAnonDgeneralPTAllPara.C: In member function 'virtual libMesh::Real CPPAnonDgeneralPTAllPara::computeQpJacobian()':\n/data/zchen/projects/army_ants/src/kernels/CPPAnonDgeneralPTAllPara.C:107:6: warning: unused variable 'Pc' [-Wunused-variable]\n  107 | Real Pc = KT*falpha;\n      |      ^~\nIn file included from /data/zchen/projects/army_ants/build/unity_src/kernels_Unity.C:8:\n/data/zchen/projects/army_ants/src/kernels/DCPDNonDimentionalCureKinetics.C: In member function 'virtual libMesh::Real DCPDNonDimentionalCureKinetics::computeQpJacobian()':\n/data/zchen/projects/army_ants/src/kernels/DCPDNonDimentionalCureKinetics.C:103:6: warning: unused variable 'Pc' [-Wunused-variable]\n  103 | Real Pc = KT*falpha;\n      |      ^~\nIn file included from /data/zchen/projects/army_ants/build/unity_src/kernels_Unity.C:9:\n/data/zchen/projects/army_ants/src/kernels/DCPDnonDgeneralPT.C: In member function 'virtual libMesh::Real DCPDnonDgeneralPT::computeQpJacobian()':\n/data/zchen/projects/army_ants/src/kernels/DCPDnonDgeneralPT.C:108:6: warning: unused variable 'Pc' [-Wunused-variable]\n  108 | Real Pc = KT*falpha;\n      |      ^~\nIn file included from /data/zchen/projects/army_ants/build/unity_src/kernels_Unity.C:10:\n/data/zchen/projects/army_ants/src/kernels/DCPDnonDgeneralPTAllPara.C: In member function 'virtual libMesh::Real DCPDnonDgeneralPTAllPara::computeQpJacobian()':\n/data/zchen/projects/army_ants/src/kernels/DCPDnonDgeneralPTAllPara.C:109:6: warning: unused variable 'Pc' [-Wunused-variable]\n  109 | Real Pc = KT*falpha;\n      |      ^~\nIn file included from /data/zchen/projects/army_ants/build/unity_src/kernels_Unity.C:13:\n/data/zchen/projects/army_ants/src/kernels/PPCnonDgeneralPT.C: In member function 'virtual libMesh::Real PPCnonDgeneralPT::computeQpJacobian()':\n/data/zchen/projects/army_ants/src/kernels/PPCnonDgeneralPT.C:107:6: warning: unused variable 'Pc' [-Wunused-variable]\n  107 | Real Pc = KT*fbeta;\n      |      ^~\nIn file included from /data/zchen/projects/army_ants/build/unity_src/kernels_Unity.C:15:\n/data/zchen/projects/army_ants/src/kernels/TimeDerivative.C: In member function 'virtual void TimeDerivative::computeJacobian()':\n/data/zchen/projects/army_ants/src/kernels/TimeDerivative.C:50:84: error: no matching function for call to 'Assembly::jacobianBlock(unsigned int, unsigned int)'\n   50 |     DenseMatrix<Number> & ke = _assembly.jacobianBlock(_var.number(), _var.number());\n      |                                                                                    ^\nIn file included from /data/zchen/projects/moose/framework/build/header_symlinks/TaggingInterface.h:15,\n                 from /data/zchen/projects/moose/framework/build/header_symlinks/ResidualObject.h:23,\n                 from /data/zchen/projects/moose/framework/build/header_symlinks/KernelBase.h:12,\n                 from /data/zchen/projects/moose/framework/build/header_symlinks/Kernel.h:12,\n                 from /data/zchen/projects/army_ants/build/header_symlinks/CPPAnonDgeneralPT.h:18,\n                 from /data/zchen/projects/army_ants/src/kernels/CPPAnonDgeneralPT.C:16,\n                 from /data/zchen/projects/army_ants/build/unity_src/kernels_Unity.C:2:\n/data/zchen/projects/moose/framework/build/header_symlinks/Assembly.h:1073:25: note: candidate: 'libMesh::DenseMatrix<double>& Assembly::jacobianBlock(unsigned int, unsigned int, Assembly::LocalDataKey, TagID)'\n 1073 |   DenseMatrix<Number> & jacobianBlock(unsigned int ivar, unsigned int jvar, LocalDataKey, TagID tag)\n      |                         ^~~~~~~~~~~~~\n/data/zchen/projects/moose/framework/build/header_symlinks/Assembly.h:1073:25: note:   candidate expects 4 arguments, 2 provided\nmake: *** [/data/zchen/projects/moose/framework/build.mk:149: /data/zchen/projects/army_ants/build/unity_src/kernels_Unity.x86_64-conda-linux-gnu.dbg.lo] Error 1\nmake: *** Waiting for unfinished jobs....",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6692081",
                          "updatedAt": "2023-08-10T15:13:31Z",
                          "publishedAt": "2023-08-10T14:15:15Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Hello\nYou have an old duplicate definition of TimeDerivative in your application.\nDid you need to duplicate this object in your app? why?\notherwise there's a bunch of unused variables and other warnings. I would fix those if I were you, it will make working on other issues easier\nGuillaume",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6692863",
                          "updatedAt": "2023-08-10T15:15:35Z",
                          "publishedAt": "2023-08-10T15:14:48Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "ZoeyChen1993"
                          },
                          "bodyText": "Hi I replace the TimeDerivative in the application, but got this error.\n(moose) [zchen@mercury army_ants]$ make -j 4\nCreating Unity /data/zchen/projects/army_ants/build/unity_src/kernels_Unity.C\nCompiling C++ (in opt mode) /data/zchen/projects/army_ants/build/unity_src/kernels_Unity.C...\nLinking Library /data/zchen/projects/army_ants/lib/libarmy_ants-opt.la...\nLinking Executable /data/zchen/projects/army_ants/army_ants-opt...\n/data/zchen/mambaforge3/envs/moose/bin/../lib/gcc/x86_64-conda-linux-gnu/10.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: /data/zchen/projects/army_ants/lib/libarmy_ants-opt.so: undefined reference to `InputParameters validParams<StressUpdateBaseTempl<false, RankTwoTensorTempl<double>, RankFourTensorTempl<double> > >()'\n/data/zchen/mambaforge3/envs/moose/bin/../lib/gcc/x86_64-conda-linux-gnu/10.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: /data/zchen/projects/army_ants/lib/libarmy_ants-opt.so: undefined reference to `InputParameters validParams<Diffusion>()'\n/data/zchen/mambaforge3/envs/moose/bin/../lib/gcc/x86_64-conda-linux-gnu/10.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: /data/zchen/projects/army_ants/lib/libarmy_ants-opt.so: undefined reference to `InputParameters validParams<ComputeEigenstrainBaseTempl<false> >()'\n/data/zchen/mambaforge3/envs/moose/bin/../lib/gcc/x86_64-conda-linux-gnu/10.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: /data/zchen/projects/army_ants/lib/libarmy_ants-opt.so: undefined reference to `InputParameters validParams<AuxKernelTempl<double> >()'\n/data/zchen/mambaforge3/envs/moose/bin/../lib/gcc/x86_64-conda-linux-gnu/10.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: /data/zchen/projects/army_ants/lib/libarmy_ants-opt.so: undefined reference to `InputParameters validParams<Kernel>()'\ncollect2: error: ld returned 1 exit status\nmake: *** [/data/zchen/projects/moose/framework/app.mk:445: /data/zchen/projects/army_ants/army_ants-opt] Error 1",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6744291",
                          "updatedAt": "2023-08-17T15:27:45Z",
                          "publishedAt": "2023-08-16T19:36:27Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Hello\nsee my answer on the other post.\nThis is likely due to some old templated validParams methods, which we have retired long ago\nhttps://mooseframework.inl.gov/moose/newsletter/2021/2021_11.html#legacy-input-parameter-deprecation",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6752714",
                          "updatedAt": "2023-08-17T15:32:41Z",
                          "publishedAt": "2023-08-17T15:32:40Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "ZoeyChen1993"
                          },
                          "bodyText": "I tried the restart in the debug mode for the first time. Could you please help me to see what does this mean? I attached the message and the zip input file here.\nRestart_debug.tar.gz",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6792337",
                          "updatedAt": "2023-08-22T14:03:25Z",
                          "publishedAt": "2023-08-22T14:03:25Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Hello\nDo you mind creating a github repo to share your inputs? I am not supposed to download tar files from the internet\nThank you!\nGuillaume",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-6792379",
                          "updatedAt": "2023-08-22T14:07:00Z",
                          "publishedAt": "2023-08-22T14:06:59Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "ZoeyChen1993"
                  },
                  "bodyText": "I print all the terms in this equation to the output by adding _console all these terms. I ran an example simulation both in opt mode and debug mode. Two output files are pasted at the end of this answer, in the debug mode, it still points to the line of the\nReal falpha = ...\nline. Though in the opt mode, it completes the calculation. And also, I give the ConstantBounds to the variable _u be (0,1) by adding the block in input file. And in the input file, other values in the equation are given.\nReal DCPDnonDgeneralPT::computeQpResidual()\n{\n  // velocity * _grad_u[_qp] is actually doing a dot product\n  /* To be copied to QpJacobian */\n//Constants\n    Real R = 8.314;\n//Temperature dependence: K(theta), _v_var is theta\nReal KT =_A[_qp] *exp(-E/(R*(_v_var[_qp]*(_Ttrig-_Tintl)+(_Tintl+273.0))));\n//Cure dependence: f(alpha)\nReal falpha = pow(std::max(0.000001, 1.0-_u[_qp]),n)*pow(std::min(0.999999, _u[_qp]),m)*(1.0/(1.0+exp(cd*(_u[_qp]-ad))));\n    /* To be copied to QpJacobian */\n_console << falpha << std::endl;\n_console << _u[_qp] << std::endl;\n_console << pow(1.0-_u[_qp],n) << std::endl;\n_console << pow(_u[_qp],m) << std::endl;\n_console <<1.0/(1.0+exp(cd*(_u[_qp]-ad))) << std::endl;\n\nReal Pc = KT*falpha;\n  return  -_test[_i][_qp]*Pc; // changed this, note - sign\n}\n\nHere are the input file.\n[Problem]  \n  type = FEProblem\n[]\n\n[Mesh]\n  [./gen]\n    #type = GeneratedMeshGenerator\n    type = FileMeshGenerator\n    file = Single_element.inp\n[../]\n[]\n\n[Variables]\n  [./Temperature]\n    order = FIRST\n    family = LAGRANGE\n    initial_condition = 20\n    block = '0'\n  [../]\n  [./Cure]\n    order = FIRST\n    family = LAGRANGE\n    initial_condition = '0.15'\n    block = '0'\n  [../]\n\n[]\n\t\t\n[AuxVariables]\n  [bounds_dummy]\n    order = FIRST\n    family = LAGRANGE\n  []\n[]\n\n[Kernels]\n  [./tempdiff] #temperature diffusion term\n    type = TempDiffusion\n    block = '0'\n    variable = Temperature\n  [../]\n  [./coupledcurederv]\n    type = CoupledCureTimeDerivative\n    block = '0'\n    variable = Temperature\n    v = Cure\n    \n  [../]\n \n [./tempderv]\n  type = HeatConductionTimeDerivative\n  block = '0'\n  variable = Temperature\n  lumping=false\n  #specific_heat = '1'\n  #density = '1'\n  #the specific heat and density are added in materials and not in this block\n  [../]\n [./curederv]\n  type=TimeDerivative\n  block = '0'\n  variable = Cure\n  lumping=false\n  [../]  \n  \n\n [./cureformula]\n  type=DCPDnonDgeneralPT\n  block = '0'\n  variable = Cure\n  v = Temperature #this is the coupled variable\n  Ttrig = '1'\n  Tintl = '0'\n  _E= '103539'\n  _n= '1.6754'\n  _m= '0.8344'\n  _cd= '28.1163'\n  _ad= '0.6809'\n  [../]\n[]\n\n[BCs]\n\n  [./temp_bottom]\n    type = DirichletBC\n    #type = NeumannBC\n   variable = Temperature\n    boundary = bot\n    value = '200'    \n  [../]\n[]\n\n\n[Bounds]\n  [cure_upper_bound]\n    type = ConstantBoundsAux\n    variable = bounds_dummy\n    bounded_variable = Cure\n    bound_type = upper\n    bound_value = 0.999999\n  []\n  [cure_lower_bound]\n    type = ConstantBoundsAux\n    variable = bounds_dummy\n    bounded_variable = Cure\n    bound_type = lower\n    bound_value = 0.000001\n  []\n[]\n[Materials]\n  [./ink]\n   block = '0'\n    type = GenericConstantMaterial\n   \n    prop_names = 'specific_heat Hr density TConductivity A'\n    prop_values = '1600 340000 980 0.152 3.129e14'  # polymer attributes\n  [../]\n[]\n\n\n\n[Executioner]\n  automatic_scaling = true\n  type = Transient\n  num_steps = 80000\n  # num_steps = 1000\n  nl_rel_tol = 1e-3\n\n  end_time=5\n\n  nl_max_its=10\n  l_max_its=15\n  \n  [./TimeStepper]\n    type = ConstantDT    \n    dt = 1\n    # dt = 3.6e14 \n  [../]\n  \n  [./TimeIntegrator]\n   type = ImplicitEuler\n   #type = CrankNicolson\n[../]\n  \n  #Preconditioned JFNK (default)\n  solve_type = 'PJFNK'\n  petsc_options_iname = '-pc_type -pc_hypre_type'\n  petsc_options_value = 'hypre boomeramg'\n  #petsc_options_iname = '-pc_type'\n  #petsc_options_value = 'gamg'\n  \n[]\n\n\n[Outputs]\n  execute_on = 'initial timestep_end' # Limit the output to timestep end (removes initial condition)\n  #checkpoint = true\n   [./exodus]\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n    type = Exodus\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n    file_base = ./Single_element_new/single_element_new\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n    interval = 1          # only output every 10 step\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n  [../]  \t\t\n    [./console]\n   type = Console\n   interval = 1\n   output_file = true\n   file_base = ./single_element_new_indebug\n     all_variable_norms = true\n   print_mesh_changed_info = true\n  [../]\t\t\t\n  [pgraph]\n    type = PerfGraphOutput\n    execute_on = 'initial final'  # Default is \"final\"\n    level = 2                     # Default is 1\n    heaviest_branch = true        # Default is false\n    heaviest_sections = 7         # Default is 0\n  []\n[]\n\nThe domain is just a square with single element looks like this. The Cure denotes the variable _u, which has an initial value of 0.15.\n\nsingle_element_opt.txt\nsingle_element_debug.txt",
                  "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7116053",
                  "updatedAt": "2023-09-26T19:04:54Z",
                  "publishedAt": "2023-09-26T18:59:56Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "what is line 70 in that file?\nthe backtrace points to it\n#1  0x00007ffff7f6a85c in DCPDnonDgeneralPT::computeQpResidual (this=0x555555dbf860) at /data/zchen/projects/army_ants/src/kernels/DCPDnonDgeneralPT.C:70",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7116103",
                          "updatedAt": "2023-09-26T19:06:37Z",
                          "publishedAt": "2023-09-26T19:06:36Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "ZoeyChen1993"
                          },
                          "bodyText": "It's this line\nReal falpha = pow(std::max(0.000001, 1.0-_u[_qp]),n)*pow(std::min(0.999999, _u[_qp]),m)*(1.0/(1.0+exp(cd*(_u[_qp]-ad))));",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7116112",
                          "updatedAt": "2023-09-26T19:07:39Z",
                          "publishedAt": "2023-09-26T19:07:38Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "what are n and m?\nDepending on their signs we cannot compute (1-u)^n or u^m",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7116131",
                          "updatedAt": "2023-09-26T19:10:04Z",
                          "publishedAt": "2023-09-26T19:10:03Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "ZoeyChen1993"
                  },
                  "bodyText": "They are given here in the input file\n_n= '1.6754'\n_m= '0.8344'\n  type=DCPDnonDgeneralPT\n  block = '0'\n  variable = Cure\n  v = Temperature #this is the coupled variable\n  Ttrig = '1'\n  Tintl = '0'\n  _E= '103539'\n  _n= '1.6754'\n  _m= '0.8344'\n  _cd= '28.1163'\n  _ad= '0.6809'\n  [../]\n[]```",
                  "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7116148",
                  "updatedAt": "2023-09-26T19:11:49Z",
                  "publishedAt": "2023-09-26T19:11:49Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "is _u bounded? n and m are not integers so 1 - u cannot be taken to a fractional exponent if u > 1",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7116186",
                          "updatedAt": "2023-09-26T19:16:15Z",
                          "publishedAt": "2023-09-26T19:16:14Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "ZoeyChen1993"
                  },
                  "bodyText": "I used both methods, bounds in the input file as below, and this ``` pow(std::min(0.999999, _u[_qp]),m)  ````\n  [cure_upper_bound]\n    type = ConstantBoundsAux\n    variable = bounds_dummy\n    bounded_variable = Cure\n    bound_type = upper\n    bound_value = 0.999999\n  []\n  [cure_lower_bound]\n    type = ConstantBoundsAux\n    variable = bounds_dummy\n    bounded_variable = Cure\n    bound_type = lower\n    bound_value = 0.000001\n  []\n[]```",
                  "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7116213",
                  "updatedAt": "2023-09-26T19:18:50Z",
                  "publishedAt": "2023-09-26T19:18:49Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "oh ok I see. Must be something else\ncan you show me the header please?\nEspecially all the material properties",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7116301",
                          "updatedAt": "2023-09-26T19:29:15Z",
                          "publishedAt": "2023-09-26T19:29:14Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "ZoeyChen1993"
                          },
                          "bodyText": "I upload all the files including the input files and the source code files to my own repo, I set it as private, how can I share that just with you?",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7116315",
                          "updatedAt": "2023-09-26T19:31:09Z",
                          "publishedAt": "2023-09-26T19:31:09Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "add me in Settings/collaborators of the repo",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7116345",
                          "updatedAt": "2023-09-26T19:35:06Z",
                          "publishedAt": "2023-09-26T19:35:05Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "ZoeyChen1993"
                          },
                          "bodyText": "Thank you, I did the setting.",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7116384",
                          "updatedAt": "2023-09-26T19:39:20Z",
                          "publishedAt": "2023-09-26T19:39:19Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "ZoeyChen1993"
                          },
                          "bodyText": "Could you please take a look of the source codes files? I also uploaded the input files. I was originally hoping to solve the convergence issue in the restart, but it seems the issue is not only in the restart but in the source.",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7116493",
                          "updatedAt": "2023-09-26T19:52:52Z",
                          "publishedAt": "2023-09-26T19:52:51Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "not seeing anything rn. i ll take another look and compile your app later",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7116767",
                          "updatedAt": "2023-09-26T20:32:13Z",
                          "publishedAt": "2023-09-26T20:32:12Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "so from your prints I am seeing this:\nflapha = nan\nu = -3.20137e-09\nthis is because you have u ^ m\nyou must do this:\npow(std::max(0.000001, std::min(0.00000001, 1.0 - _u[_qp])), n) * pow(std::min(0.999999, std::max(0.000001, _u[_qp]))\n\nto be safe.",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7123015",
                          "updatedAt": "2023-09-27T12:46:39Z",
                          "publishedAt": "2023-09-27T12:46:39Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "also the Bounds are not active, because you are not using a variational inequality solver. See the bounds documentation:\nhttps://mooseframework.inl.gov/source/auxkernels/ConstantBoundsAux.html",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7123020",
                          "updatedAt": "2023-09-27T12:47:36Z",
                          "publishedAt": "2023-09-27T12:47:35Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "ZoeyChen1993"
                          },
                          "bodyText": "I think you mean in\npow(std::max(0.000001, std::min(0.00000001, 1.0 - _u[_qp])), n) * pow(std::min(0.999999, std::max(0.000001, _u[_qp]))\nIt should be\npow(std::max(0.000001, std::min(0.999999, 1.0 - _u[_qp])), n) * pow(std::min(0.999999, std::max(0.000001, _u[_qp]))\nto make 0.000001<_u < 0.999999, 0.000001<(1-_u)<0.999999\nNot sure my understand is correct?",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7124385",
                          "updatedAt": "2023-09-27T14:48:22Z",
                          "publishedAt": "2023-09-27T14:48:21Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "yes :)",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7124492",
                          "updatedAt": "2023-09-27T14:57:37Z",
                          "publishedAt": "2023-09-27T14:57:37Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "zx1987"
                  },
                  "bodyText": "so they look exactly the same before and after the restart?\n@GiudGiud\n\nHi Guillaume, thank you for all your help! If you do not mind me jumping in here - by the way my name is Xiang, and Zhuoting works with me.\nWe used chekpoints for restart, and for different variables we checked, before and after the restart, the values are the same. We did this following your suggestions using problem/solve=false, such that only initial state are stored.  So Resart seems to pick up the right information.\nHowever, our restart also involves CoupledVarThresholdElementSubdomainModifier that activates material A to material P.  The current issue we are trying to address is how to set the initial condition of those newly activated elements in the restart. Say some elements of material A is activated to be material P. A has variable T, and B has variables T and alpha. Right before activation, material A has T=T0A, and we wish to initialize the newly activated B with T=T0B and alpha=alpha_0. However, the code seems to use T= T0A and alpha=0 to initialize the newly activated B material.\nIs what we are trying to achieve an existing capability in MOOSE or we should develop this capability by ourselves? If we were to develop this capability, would you mind commenting what is the best way to start? Thanks.\nBest,\nXiang",
                  "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7213963",
                  "updatedAt": "2023-10-06T22:14:25Z",
                  "publishedAt": "2023-10-06T22:12:24Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Hello\nI think @dewenyushu will know if this has already been implemented or not. Otherwise, you can look at the options and the various inputs using ActivateElementByPaths for whether something like this is being done. If it's possible, there will be a test for it.",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7214141",
                          "updatedAt": "2023-10-06T22:55:16Z",
                          "publishedAt": "2023-10-06T22:55:15Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "zx1987"
                          },
                          "bodyText": "Thanks! @GiudGiud  I checked both and we do find CoupledVarThresholdElementSubdomainModifier appears to be a better choice. We will see what Dewen @dewenyushu says and start from there. Thank you for all your help!\nBest,\nXiang",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7214197",
                          "updatedAt": "2023-10-06T23:24:58Z",
                          "publishedAt": "2023-10-06T23:10:03Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "dewenyushu"
                          },
                          "bodyText": "Hi Xiang:\nThanks for your detailed explanation.\nIIRC,  none of the activate by path nor element subdomain modifier directly interferes with the restart capability in MOOSE. So if you\u2019ve tried various options in the initial condition (IC) with what current restart capability has to offer, it looks like you will need some modifications in the code (maybe in a wrapper you already have?) to overwrite the IC for your specific need.\nI need to admit that I am not very familiar with the restart part of the code in MOOSE and cannot provide you with a clearer/better solution off the top of my head.",
                          "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7246755",
                          "updatedAt": "2023-10-10T23:17:09Z",
                          "publishedAt": "2023-10-10T23:17:08Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "zx1987"
                  },
                  "bodyText": "@hugary1995 Hi Garry, by searching some old threads, it appears you may also know this  CoupledVarThresholdElementSubdomainModifier well. Dewen may not currently have the bandwidth to look into this, but if you are in a convenient position, could you take a look at the below-quoted issue we are trying to address, and see if you happen to know if this is something already implemented, or if we should implement by ourselves? If in the latter case, any suggestions on where to get started would be very much appreciated. Thanks\nBest,\nXiang\n\n\nso they look exactly the same before and after the restart?\n@GiudGiud\n\nHi Guillaume, thank you for all your help! If you do not mind me jumping in here - by the way my name is Xiang, and Zhuoting works with me.\nWe used chekpoints for restart, and for different variables we checked, before and after the restart, the values are the same. We did this following your suggestions using problem/solve=false, such that only initial state are stored. So Resart seems to pick up the right information.\nHowever, our restart also involves CoupledVarThresholdElementSubdomainModifier that activates material A to material P. The current issue we are trying to address is how to set the initial condition of those newly activated elements in the restart. Say some elements of material A is activated to be material P. A has variable T, and B has variables T and alpha. Right before activation, material A has T=T0A, and we wish to initialize the newly activated B with T=T0B and alpha=alpha_0. However, the code seems to use T= T0A and alpha=0 to initialize the newly activated B material.\nIs what we are trying to achieve an existing capability in MOOSE or we should develop this capability by ourselves? If we were to develop this capability, would you mind commenting what is the best way to start? Thanks.\nBest, Xiang",
                  "url": "https://github.com/idaholab/moose/discussions/25034#discussioncomment-7243933",
                  "updatedAt": "2023-10-10T17:53:47Z",
                  "publishedAt": "2023-10-10T17:53:46Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": []
                  }
                }
              }
            ]
          }
        }
      }
    ]
  }
}