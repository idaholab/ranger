{
  "discussions": {
    "pageInfo": {
      "hasNextPage": true,
      "endCursor": "Y3Vyc29yOnYyOpK5MjAyNC0xMC0wOVQxOTo1OTo1Ni0wNjowMM4AblM1"
    },
    "edges": [
      {
        "node": {
          "title": "Anisotropy in phase field",
          "author": {
            "login": "d5sneha"
          },
          "bodyText": "i'm trying to modify the materials block in raccoon for anisotropic materials, modifying the smalldeformationIsotropicElasticity but it is giving me the error while running\n*** ERROR ***\nA 'snehaIsotropicElasticity' is not a registered object.\n\nIf you are trying to find this object in a dynamically loaded library, make sure that\nthe library can be found either in your \"Problem/library_path\" parameter or in the\nMOOSE_LIBRARY_PATH environment variable.\n\nI highly appreciate any help i can get.",
          "url": "https://github.com/idaholab/moose/discussions/28719",
          "updatedAt": "2024-10-12T15:25:22Z",
          "publishedAt": "2024-09-27T07:02:17Z",
          "category": {
            "name": "Q&A Modules: Phase field"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\nDid you create this object?\nIf so:\n\nhow did you register it? (at the top of the source file)\nis this in an app? or are you working inside a module?\ndid you recompile the code after creating the object?\nwhat executable are you using?",
                  "url": "https://github.com/idaholab/moose/discussions/28719#discussioncomment-10776036",
                  "updatedAt": "2024-09-27T13:40:11Z",
                  "publishedAt": "2024-09-27T13:40:10Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "d5sneha"
                          },
                          "bodyText": "yes, i am working in raccoon and i have created it in materials inside raccoon and i haven't recompiled yet as i don't know how i should proceed.",
                          "url": "https://github.com/idaholab/moose/discussions/28719#discussioncomment-10789448",
                          "updatedAt": "2024-09-29T14:16:15Z",
                          "publishedAt": "2024-09-29T14:16:14Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "It will not be registered until you recompile.\nWhen you compile you may get errors if there are mistakes in the code\nTo recompile you will need to go in racoon/ using the cd command, then type \"make\".\nYou can use \"make -j6\" if you have 6 processors on your machine for example",
                          "url": "https://github.com/idaholab/moose/discussions/28719#discussioncomment-10789702",
                          "updatedAt": "2024-09-29T15:11:42Z",
                          "publishedAt": "2024-09-29T15:11:41Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "d5sneha"
                          },
                          "bodyText": "this is the error i am getting on recompilation.\n(moose) snehad@ubuntu:~/projects/raccoon$ make -j 2\nmake: *** No rule to make target '/home/snehad/projects/raccoon/include/materials/small_deformation_models/snehaIsotropicElasticity', needed by '/home/snehad/projects/raccoon/build/header_symlinks/snehaIsotropicElasticity'.  Stop.\nmake: *** Waiting for unfinished jobs....",
                          "url": "https://github.com/idaholab/moose/discussions/28719#discussioncomment-10789806",
                          "updatedAt": "2024-10-01T13:22:46Z",
                          "publishedAt": "2024-09-29T15:31:53Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "d5sneha"
                          },
                          "bodyText": "i want to apply phase field fracture method for anisotropic materials, is there any other way to solve anisotropy in raccoon?\nbecause in materials block i was using SmalldeformationIsotropicElasticity for iostropic problems, but now for anisotropic case i couldn't find anything. And in SmalldeformationIsotropicElasticity the Hooke's law is defined for isotropic case only.\n\"SmalldeformationIsotopicElasticity'' file\n//* This file is part of the RACCOON application\n//* being developed at Dolbow lab at Duke University\n//* http://dolbow.pratt.duke.edu\n\n#include \"SmallDeformationIsotropicElasticity.h\"\n#include \"RaccoonUtils.h\"\n\nregisterMooseObject(\"raccoonApp\", SmallDeformationIsotropicElasticity);\n\nInputParameters\nSmallDeformationIsotropicElasticity::validParams()\n{\n InputParameters params = SmallDeformationElasticityModel::validParams();\n params.addClassDescription(\"Isotropic elasticity under small strain asumptions.\");\n\n params.addRequiredParam<MaterialPropertyName>(\"bulk_modulus\", \"The bulk modulus $K$\");\n params.addRequiredParam<MaterialPropertyName>(\"shear_modulus\", \"The shear modulus $G$\");\n\n params.addRequiredCoupledVar(\"phase_field\", \"Name of the phase-field (damage) variable\");\n params.addParam<MaterialPropertyName>(\n     \"strain_energy_density\",\n     \"psie\",\n     \"Name of the strain energy density computed by this material model\");\n params.addParam<MaterialPropertyName>(\"degradation_function\", \"g\", \"The degradation function\");\n params.addParam<MooseEnum>(\n     \"decomposition\", MooseEnum(\"NONE SPECTRAL VOLDEV\", \"NONE\"), \"The decomposition method\");\n\n return params;\n}\n\nSmallDeformationIsotropicElasticity::SmallDeformationIsotropicElasticity(\n   const InputParameters & parameters)\n : SmallDeformationElasticityModel(parameters),\n   DerivativeMaterialPropertyNameInterface(),\n   _K(getADMaterialPropertyByName<Real>(prependBaseName(\"bulk_modulus\", true))),\n   _G(getADMaterialPropertyByName<Real>(prependBaseName(\"shear_modulus\", true))),\n\n   _d_name(getVar(\"phase_field\", 0)->name()),\n\n   // The strain energy density and its derivatives\n   _psie_name(prependBaseName(\"strain_energy_density\", true)),\n   _psie(declareADProperty<Real>(_psie_name)),\n   _psie_active(declareADProperty<Real>(_psie_name + \"_active\")),\n   _dpsie_dd(declareADProperty<Real>(derivativePropertyName(_psie_name, {_d_name}))),\n\n   // The degradation function and its derivatives\n   _g_name(prependBaseName(\"degradation_function\", true)),\n   _g(getADMaterialProperty<Real>(_g_name)),\n   _dg_dd(getADMaterialProperty<Real>(derivativePropertyName(_g_name, {_d_name}))),\n\n   _decomposition(getParam<MooseEnum>(\"decomposition\").getEnum<Decomposition>())\n{\n}\n\nADRankTwoTensor\nSmallDeformationIsotropicElasticity::computeStress(const ADRankTwoTensor & strain)\n{\n ADRankTwoTensor stress;\n\n if (_decomposition == Decomposition::none)\n   stress = computeStressNoDecomposition(strain);\n else if (_decomposition == Decomposition::spectral)\n   stress = computeStressSpectralDecomposition(strain);\n else if (_decomposition == Decomposition::voldev)\n   stress = computeStressVolDevDecomposition(strain);\n else\n   paramError(\"decomposition\", \"Unsupported decomposition type.\");\n\n return stress;\n}\n\nADRankTwoTensor\nSmallDeformationIsotropicElasticity::computeStressNoDecomposition(const ADRankTwoTensor & strain)\n{\n const ADRankTwoTensor I2(ADRankTwoTensor::initIdentity);\n ADRankTwoTensor stress_intact = _K[_qp] * strain.trace() * I2 + 2 * _G[_qp] * strain.deviatoric();\n ADRankTwoTensor stress = _g[_qp] * stress_intact;\n\n _psie_active[_qp] = 0.5 * stress_intact.doubleContraction(strain);\n _psie[_qp] = _g[_qp] * _psie_active[_qp];\n _dpsie_dd[_qp] = _dg_dd[_qp] * _psie_active[_qp];\n\n return stress;\n}\n\nADRankTwoTensor\nSmallDeformationIsotropicElasticity::computeStressSpectralDecomposition(\n   const ADRankTwoTensor & strain)\n{\n const ADReal lambda = _K[_qp] - 2 * _G[_qp] / LIBMESH_DIM;\n const ADRankTwoTensor I2(ADRankTwoTensor::initIdentity);\n ADReal strain_tr = strain.trace();\n ADReal strain_tr_pos = RaccoonUtils::Macaulay(strain_tr);\n\n // Spectral decomposition\n ADRankTwoTensor strain_pos = RaccoonUtils::spectralDecomposition(strain);\n\n // Stress\n ADRankTwoTensor stress_intact = _K[_qp] * strain.trace() * I2 + 2 * _G[_qp] * strain.deviatoric();\n ADRankTwoTensor stress_pos = lambda * strain_tr_pos * I2 + 2 * _G[_qp] * strain_pos;\n ADRankTwoTensor stress_neg = stress_intact - stress_pos;\n ADRankTwoTensor stress = _g[_qp] * stress_pos + stress_neg;\n\n // Strain energy density\n ADReal psie_intact =\n     0.5 * lambda * strain_tr * strain_tr + _G[_qp] * strain.doubleContraction(strain);\n _psie_active[_qp] = 0.5 * lambda * strain_tr_pos * strain_tr_pos +\n                     _G[_qp] * strain_pos.doubleContraction(strain_pos);\n ADReal psie_inactive = psie_intact - _psie_active[_qp];\n _psie[_qp] = _g[_qp] * _psie_active[_qp] + psie_inactive;\n _dpsie_dd[_qp] = _dg_dd[_qp] * _psie_active[_qp];\n\n return stress;\n}\n\nADRankTwoTensor\nSmallDeformationIsotropicElasticity::computeStressVolDevDecomposition(\n   const ADRankTwoTensor & strain)\n{\n const ADRankTwoTensor I2(ADRankTwoTensor::initIdentity);\n\n // Volumetric-deviatoric decomposition\n ADReal strain_tr = strain.trace();\n ADReal strain_tr_pos = RaccoonUtils::Macaulay(strain_tr);\n ADReal strain_tr_neg = strain_tr - strain_tr_pos;\n ADRankTwoTensor strain_dev = strain.deviatoric();\n\n // Stress\n ADRankTwoTensor stress_intact = _K[_qp] * strain.trace() * I2 + 2 * _G[_qp] * strain.deviatoric();\n ADRankTwoTensor stress_neg = _K[_qp] * strain_tr_neg * I2;\n ADRankTwoTensor stress_pos = stress_intact - stress_neg;\n ADRankTwoTensor stress = _g[_qp] * stress_pos + stress_neg;\n\n // Strain energy density\n ADReal psie_intact =\n     0.5 * _K[_qp] * strain_tr * strain_tr + _G[_qp] * strain_dev.doubleContraction(strain_dev);\n ADReal psie_inactive = 0.5 * _K[_qp] * strain_tr_neg * strain_tr_neg;\n _psie_active[_qp] = psie_intact - psie_inactive;\n _psie[_qp] = _g[_qp] * _psie_active[_qp] + psie_inactive;\n _dpsie_dd[_qp] = _dg_dd[_qp] * _psie_active[_qp];\n\n return stress;\n}\n\nplease help me on how i can modify it for anisotropic material?",
                          "url": "https://github.com/idaholab/moose/discussions/28719#discussioncomment-10789841",
                          "updatedAt": "2024-10-01T13:22:21Z",
                          "publishedAt": "2024-09-29T15:38:23Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Can you check the file extensions? Should be .C for source (capital C) and .h for a header",
                          "url": "https://github.com/idaholab/moose/discussions/28719#discussioncomment-10790077",
                          "updatedAt": "2024-09-29T16:13:34Z",
                          "publishedAt": "2024-09-29T16:13:33Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "I think @hugary1995 is more aware of the needs here (for implementing anisotropy in raccoon)\nI expect you will want to make a few material properties generate RealVectorValue instead of Real (and higher order tensors for tensor properties) to model the directional values. But there's probably more to this",
                          "url": "https://github.com/idaholab/moose/discussions/28719#discussioncomment-10791326",
                          "updatedAt": "2024-09-29T20:36:44Z",
                          "publishedAt": "2024-09-29T20:36:43Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "d5sneha"
                          },
                          "bodyText": "@GiudGiud  yes i have checked the file extensions as .C and .h they were correct.",
                          "url": "https://github.com/idaholab/moose/discussions/28719#discussioncomment-10809100",
                          "updatedAt": "2024-10-01T13:17:34Z",
                          "publishedAt": "2024-10-01T13:17:34Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "is it compiling fine now?\nmake is listing the file without an extension in its error message you posted\n/home/snehad/projects/raccoon/include/materials/small_deformation_models/snehaIsotropicElasticity",
                          "url": "https://github.com/idaholab/moose/discussions/28719#discussioncomment-10809164",
                          "updatedAt": "2024-10-01T13:23:22Z",
                          "publishedAt": "2024-10-01T13:23:21Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "d5sneha"
                          },
                          "bodyText": "it is still giving a lot of errors.\n(moose) snehad@ubuntu:~/projects/raccoon$ make -j 2\nCompiling C++ (in opt mode) /home/snehad/projects/raccoon/build/unity_src/materials_Unity.C...\n\nIn file included from /home/snehad/projects/raccoon/moose/framework/build/header_symlinks/MooseObject.h:17,\n                 from /home/snehad/projects/raccoon/moose/framework/build/header_symlinks/MaterialBase.h:13,\n                 from /home/snehad/projects/raccoon/moose/framework/build/header_symlinks/Material.h:13,\n                 from /home/snehad/projects/raccoon/build/header_symlinks/ArrheniusLaw.h:7,\n                 from /home/snehad/projects/raccoon/src/materials/ArrheniusLaw.C:5,\n                 from /home/snehad/projects/raccoon/build/unity_src/materials_Unity.C:2:\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:8:35: error: 'SmallDeformationIsotropicElasticity' was not declared in this scope\n    8 | registerMooseObject(\"raccoonApp\", SmallDeformationIsotropicElasticity);\n      |                                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/home/snehad/projects/raccoon/moose/framework/build/header_symlinks/Registry.h:43:21: note: in definition of macro 'registerMooseObject'\n   43 |       Registry::add<classname>({app, #classname, \"\", \"\", __FILE__, __LINE__, \"\", \"\"})\n      |                     ^~~~~~~~~\n/home/snehad/projects/raccoon/moose/framework/build/header_symlinks/Registry.h:43:31: error: no matching function for call to 'Registry::add<<expression error> >(<brace-enclosed initializer list>)'\n   43 |       Registry::add<classname>({app, #classname, \"\", \"\", __FILE__, __LINE__, \"\", \"\"})\n      |       ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:8:1: note: in expansion of macro 'registerMooseObject'\n    8 | registerMooseObject(\"raccoonApp\", SmallDeformationIsotropicElasticity);\n      | ^~~~~~~~~~~~~~~~~~~\n/home/snehad/projects/raccoon/moose/framework/build/header_symlinks/Registry.h:165:15: note: candidate: 'template<class T> static char Registry::add(const RegistryEntryData&)'\n  165 |   static char add(const RegistryEntryData & base_info)\n      |               ^~~\n/home/snehad/projects/raccoon/moose/framework/build/header_symlinks/Registry.h:165:15: note:   template argument deduction/substitution failed:\n/home/snehad/projects/raccoon/moose/framework/build/header_symlinks/Registry.h:43:31: error: template argument 1 is invalid\n   43 |       Registry::add<classname>({app, #classname, \"\", \"\", __FILE__, __LINE__, \"\", \"\"})\n      |       ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:8:1: note: in expansion of macro 'registerMooseObject'\n    8 | registerMooseObject(\"raccoonApp\", SmallDeformationIsotropicElasticity);\n      | ^~~~~~~~~~~~~~~~~~~\nIn file included from /home/snehad/projects/raccoon/build/unity_src/materials_Unity.C:36:\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:11:1: error: 'SmallDeformationIsotropicElasticity' has not been declared\n   11 | SmallDeformationIsotropicElasticity::validParams()\n      | ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:31:1: error: 'SmallDeformationIsotropicElasticity' does not name a type\n   31 | SmallDeformationIsotropicElasticity::SmallDeformationIsotropicElasticity(\n      | ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:44:83: error: expected unqualified-id before ')' token\n   44 |     _dpsie_dd(declareADProperty<Real>(derivativePropertyName(_psie_name, {_d_name}))),\n      |                                                                                   ^\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:49:81: error: expected unqualified-id before ')' token\n   49 |     _dg_dd(getADMaterialProperty<Real>(derivativePropertyName(_g_name, {_d_name}))),\n      |                                                                                 ^\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:56:1: error: 'SmallDeformationIsotropicElasticity' has not been declared\n   56 | SmallDeformationIsotropicElasticity::computeStress(const ADRankTwoTensor & strain)\n      | ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C: In function 'ADRankTwoTensor computeStress(const ADRankTwoTensor&)':\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:60:7: error: '_decomposition' was not declared in this scope\n   60 |   if (_decomposition == Decomposition::none)\n      |       ^~~~~~~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:60:25: error: 'Decomposition' has not been declared\n   60 |   if (_decomposition == Decomposition::none)\n      |                         ^~~~~~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:61:14: error: 'computeStressNoDecomposition' was not declared in this scope\n   61 |     stress = computeStressNoDecomposition(strain);\n      |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:62:30: error: 'Decomposition' has not been declared\n   62 |   else if (_decomposition == Decomposition::spectral)\n      |                              ^~~~~~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:63:14: error: 'computeStressSpectralDecomposition' was not declared in this scope\n   63 |     stress = computeStressSpectralDecomposition(strain);\n      |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:64:30: error: 'Decomposition' has not been declared\n   64 |   else if (_decomposition == Decomposition::voldev)\n      |                              ^~~~~~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:65:14: error: 'computeStressVolDevDecomposition' was not declared in this scope\n   65 |     stress = computeStressVolDevDecomposition(strain);\n      |              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:67:5: error: 'paramError' was not declared in this scope\n   67 |     paramError(\"decomposition\", \"Unsupported decomposition type.\");\n      |     ^~~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C: At global scope:\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:73:1: error: 'SmallDeformationIsotropicElasticity' has not been declared\n   73 | SmallDeformationIsotropicElasticity::computeStressNoDecomposition(const ADRankTwoTensor & strain)\n      | ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C: In function 'ADRankTwoTensor computeStressNoDecomposition(const ADRankTwoTensor&)':\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:76:37: error: '_K' was not declared in this scope\n   76 |   ADRankTwoTensor stress_intact_1 = _K[_qp] * strain.trace() * I2 + 2 * _G[_qp] * strain.deviatoric();\n      |                                     ^~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:76:40: error: '_qp' was not declared in this scope\n   76 |   ADRankTwoTensor stress_intact_1 = _K[_qp] * strain.trace() * I2 + 2 * _G[_qp] * strain.deviatoric();\n      |                                        ^~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:76:73: error: '_G' was not declared in this scope\n   76 |   ADRankTwoTensor stress_intact_1 = _K[_qp] * strain.trace() * I2 + 2 * _G[_qp] * strain.deviatoric();\n      |                                                                         ^~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:77:28: error: '_g' was not declared in this scope\n   77 |   ADRankTwoTensor stress = _g[_qp] * stress_intact_1;\n      |                            ^~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:79:3: error: '_psie_active' was not declared in this scope\n   79 |   _psie_active[_qp] = 0.5 * stress_intact_1.doubleContraction(strain);\n      |   ^~~~~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:80:3: error: '_psie' was not declared in this scope\n   80 |   _psie[_qp] = _g[_qp] * _psie_active[_qp];\n      |   ^~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:81:3: error: '_dpsie_dd' was not declared in this scope\n   81 |   _dpsie_dd[_qp] = _dg_dd[_qp] * _psie_active[_qp];\n      |   ^~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:81:20: error: '_dg_dd' was not declared in this scope\n   81 |   _dpsie_dd[_qp] = _dg_dd[_qp] * _psie_active[_qp];\n      |                    ^~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C: At global scope:\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:87:1: error: 'SmallDeformationIsotropicElasticity' has not been declared\n   87 | SmallDeformationIsotropicElasticity::computeStressSpectralDecomposition(\n      | ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C: In function 'ADRankTwoTensor computeStressSpectralDecomposition(const ADRankTwoTensor&)':\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:90:25: error: '_K' was not declared in this scope\n   90 |   const ADReal lambda = _K[_qp] - 2 * _G[_qp] / LIBMESH_DIM;\n      |                         ^~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:90:28: error: '_qp' was not declared in this scope\n   90 |   const ADReal lambda = _K[_qp] - 2 * _G[_qp] / LIBMESH_DIM;\n      |                            ^~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:90:39: error: '_G' was not declared in this scope\n   90 |   const ADReal lambda = _K[_qp] - 2 * _G[_qp] / LIBMESH_DIM;\n      |                                       ^~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:102:28: error: '_g' was not declared in this scope\n  102 |   ADRankTwoTensor stress = _g[_qp] * stress_pos + stress_neg;\n      |                            ^~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:107:3: error: '_psie_active' was not declared in this scope\n  107 |   _psie_active[_qp] = 0.5 * lambda * strain_tr_pos * strain_tr_pos +\n      |   ^~~~~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:110:3: error: '_psie' was not declared in this scope\n  110 |   _psie[_qp] = _g[_qp] * _psie_active[_qp] + psie_inactive;\n      |   ^~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:111:3: error: '_dpsie_dd' was not declared in this scope\n  111 |   _dpsie_dd[_qp] = _dg_dd[_qp] * _psie_active[_qp];\n      |   ^~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:111:20: error: '_dg_dd' was not declared in this scope\n  111 |   _dpsie_dd[_qp] = _dg_dd[_qp] * _psie_active[_qp];\n      |                    ^~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C: At global scope:\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:117:1: error: 'SmallDeformationIsotropicElasticity' has not been declared\n  117 | SmallDeformationIsotropicElasticity::computeStressVolDevDecomposition(\n      | ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C: In function 'ADRankTwoTensor computeStressVolDevDecomposition(const ADRankTwoTensor&)':\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:129:35: error: '_K' was not declared in this scope\n  129 |   ADRankTwoTensor stress_intact = _K[_qp] * strain.trace() * I2 + 2 * _G[_qp] * strain.deviatoric();\n      |                                   ^~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:129:38: error: '_qp' was not declared in this scope\n  129 |   ADRankTwoTensor stress_intact = _K[_qp] * strain.trace() * I2 + 2 * _G[_qp] * strain.deviatoric();\n      |                                      ^~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:129:71: error: '_G' was not declared in this scope\n  129 |   ADRankTwoTensor stress_intact = _K[_qp] * strain.trace() * I2 + 2 * _G[_qp] * strain.deviatoric();\n      |                                                                       ^~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:132:28: error: '_g' was not declared in this scope\n  132 |   ADRankTwoTensor stress = _g[_qp] * stress_pos + stress_neg;\n      |                            ^~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:138:3: error: '_psie_active' was not declared in this scope; did you mean 'psie_inactive'?\n  138 |   _psie_active[_qp] = psie_intact - psie_inactive;\n      |   ^~~~~~~~~~~~\n      |   psie_inactive\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:139:3: error: '_psie' was not declared in this scope\n  139 |   _psie[_qp] = _g[_qp] * _psie_active[_qp] + psie_inactive;\n      |   ^~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:140:3: error: '_dpsie_dd' was not declared in this scope\n  140 |   _dpsie_dd[_qp] = _dg_dd[_qp] * _psie_active[_qp];\n      |   ^~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:140:20: error: '_dg_dd' was not declared in this scope\n  140 |   _dpsie_dd[_qp] = _dg_dd[_qp] * _psie_active[_qp];\n      |                    ^~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C: At global scope:\n/home/snehad/projects/raccoon/moose/framework/build/header_symlinks/Registry.h:42:28: error: 'dummyvar_for_registering_obj_SmallDeformationIsotropicElasticity26' defined but not used [-Werror=unused-variable]\n   42 |   static char combineNames(dummyvar_for_registering_obj_##classname, __COUNTER__) =                \\\n      |                            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/home/snehad/projects/raccoon/moose/framework/build/header_symlinks/Registry.h:23:29: note: in definition of macro 'combineNames1'\n   23 | #define combineNames1(X, Y) X##Y\n      |                             ^\n/home/snehad/projects/raccoon/moose/framework/build/header_symlinks/Registry.h:42:15: note: in expansion of macro 'combineNames'\n   42 |   static char combineNames(dummyvar_for_registering_obj_##classname, __COUNTER__) =                \\\n      |               ^~~~~~~~~~~~\n/home/snehad/projects/raccoon/src/materials/small_deformation_models/SmallDeformationIsotropicElasticity.C:8:1: note: in expansion of macro 'registerMooseObject'\n    8 | registerMooseObject(\"raccoonApp\", SmallDeformationIsotropicElasticity);\n      | ^~~~~~~~~~~~~~~~~~~\ncc1plus: all warnings being treated as errors\nmake: *** [/home/snehad/projects/raccoon/moose/framework/build.mk:151: /home/snehad/projects/raccoon/build/unity_src/materials_Unity.x86_64-conda-linux-gnu.opt.lo] Error 1",
                          "url": "https://github.com/idaholab/moose/discussions/28719#discussioncomment-10921128",
                          "updatedAt": "2024-10-12T15:24:22Z",
                          "publishedAt": "2024-10-12T06:53:57Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "d5sneha"
                          },
                          "bodyText": "I think @hugary1995 is more aware of the needs here (for implementing anisotropy in raccoon)\nI expect you will want to make a few material properties generate RealVectorValue instead of Real (and higher order tensors for tensor properties) to model the directional values. But there's probably more to this\n\n@hugary1995 how i implement mode-1 and mode-2 problems for anisotropic materials in RACOON.",
                          "url": "https://github.com/idaholab/moose/discussions/28719#discussioncomment-10921132",
                          "updatedAt": "2024-10-12T06:56:17Z",
                          "publishedAt": "2024-10-12T06:56:16Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "Memory issues with GrandPotentialPlanar example",
          "author": {
            "login": "nwinner"
          },
          "bodyText": "Hello all, I'm new to the MOOSE framework and I'm experimenting with examples for the phase field module to get a feel for things.\nI took the GrandPotentialPlanar.i example, which runs fine, and made some modifications to try and match the parameters provided by in this paper. by Biswas et al.\nI modify the input file to start to work towards the system provided in the paper. (I have questions about that too but I'll save that for another thread unless it comes up in the discussion.). When I modify the initial conditions and the material constants, I am able to get some cases where I get EXIT CODE 9, signalling out-of-memory. This is very strange to me (1) that it is dependent on the input parameters I use, when the mesh doesn't change, and also (2) because the VectorMemoryUsage doesn't show very high memory usage:\nhardware_id,node_utilization,page_faults,physical_mem,total_ram,virtual_mem\n0,0.004812122606905,700,324,2163051,1088\n\nI am running this through docker moose:latest on a compute node with 720GB of RAM and 2TB of disk space. So there shouldn't be any issue unless I'm misundestanding something.\nInput file:\nGrandPotentialPlanar.txt\nOutput log:\noutput.log\nCould I get some assistsance with understanding the problem?",
          "url": "https://github.com/idaholab/moose/discussions/28781",
          "updatedAt": "2024-10-11T21:41:39Z",
          "publishedAt": "2024-10-05T01:23:36Z",
          "category": {
            "name": "Q&A Modules: Phase field"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\nThis runs fine on my machine.\nSIG9 just means SIGKILL. It's not necessarily OOM though that is by far the most likely.\nI dont run out of memory on a much smaller machine. It seems you use 32 processes. Can you try less? Maybe 8 like I did\nGuillaume",
                  "url": "https://github.com/idaholab/moose/discussions/28781#discussioncomment-10850500",
                  "updatedAt": "2024-10-05T06:52:38Z",
                  "publishedAt": "2024-10-05T06:52:37Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": []
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "nwinner"
                  },
                  "bodyText": "When I run the input file using 8 processes, it works. Doesn't this point to some sort of OOM error since we are reducing the memory required for each rank, or does SIG9 have some other meaning related to \"over parallelizing\"?",
                  "url": "https://github.com/idaholab/moose/discussions/28781#discussioncomment-10854136",
                  "updatedAt": "2024-10-05T18:12:49Z",
                  "publishedAt": "2024-10-05T18:12:48Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "how many CPUs do you have? and how many slots does openmpi(? or mpich) detect?",
                          "url": "https://github.com/idaholab/moose/discussions/28781#discussioncomment-10854220",
                          "updatedAt": "2024-10-05T18:28:43Z",
                          "publishedAt": "2024-10-05T18:28:42Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "nwinner"
                          },
                          "bodyText": "CPUs: 112\nThreads per core: 2\nCore(s) per socket: 28\nSocket: 2",
                          "url": "https://github.com/idaholab/moose/discussions/28781#discussioncomment-10854659",
                          "updatedAt": "2024-10-05T20:17:12Z",
                          "publishedAt": "2024-10-05T20:17:11Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "seems fine to me.\nif you run with htop, do you see the memory spike with more cores?",
                          "url": "https://github.com/idaholab/moose/discussions/28781#discussioncomment-10854772",
                          "updatedAt": "2024-10-05T20:47:57Z",
                          "publishedAt": "2024-10-05T20:47:57Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "nwinner"
                          },
                          "bodyText": "I don't see any obvious spikes in memory with htop. I can dump the memory per core using VectorMemoryUsage and it looks like ths snippet in my original post.\nI can attach a monitor with psrecord to the first mpi rank using psrecord $(pgrep moose-opt | tail -1) --interval 0.001 --log usage_log.txt and the top of the log looks like this:\n# Elapsed time   CPU (%)     Real (MB)   Virtual (MB)\n       0.000        0.000      304.234     1025.750\n       0.001        0.000      304.234     1025.750\n       0.003        0.000      304.234     1025.750\n       0.004        0.000      304.418     1026.004\n       0.005        0.000      304.418     1026.258\n       0.006        0.000      304.418     1026.258\n       0.007        0.000      304.418     1026.258\n       0.009        0.000      304.418     1026.258\n       0.010      807.300      304.418     1026.258",
                          "url": "https://github.com/idaholab/moose/discussions/28781#discussioncomment-10855493",
                          "updatedAt": "2024-10-06T00:02:51Z",
                          "publishedAt": "2024-10-06T00:02:50Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "thanks that definitely rules out memory.\nAt what number of MPI processes do you get the error first? Is 8 the largest you can use?",
                          "url": "https://github.com/idaholab/moose/discussions/28781#discussioncomment-10855501",
                          "updatedAt": "2024-10-06T00:04:47Z",
                          "publishedAt": "2024-10-06T00:04:46Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "nwinner"
                          },
                          "bodyText": "Increasing the number of processes and keepting n-threads=1, I can run 24 processes. It seems to fail at similar step each time for a given number of processes:\nProcesses, terminates on\n25,68\n26,58\n28,21\n32,14\nThe time step it terminates on is not 100% consistent, but it does seem to get further as number of processes decreases. Whether it matters I don't know, but for n=26, I would sometimes get exit code 135 instead of 9:\n===================================================================================\n=   BAD TERMINATION OF ONE OF YOUR APPLICATION PROCESSES\n=   PID 32469 RUNNING AT daa54fcfb23a\n=   EXIT CODE: 135\n=   CLEANING UP REMAINING PROCESSES\n=   YOU CAN IGNORE THE BELOW CLEANUP MESSAGES\n===================================================================================\nYOUR APPLICATION TERMINATED WITH THE EXIT STRING: Terminated (signal 15)\nThis typically refers to a problem with your application.\nPlease see the FAQ page for debugging suggestions",
                          "url": "https://github.com/idaholab/moose/discussions/28781#discussioncomment-10855563",
                          "updatedAt": "2024-10-06T00:26:39Z",
                          "publishedAt": "2024-10-06T00:26:38Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "hi @nwinner\nI cannot reproduce this issue locally up to >100 cores.\nIf you want to investigate this further, I will need you to debug this in parallel using these instructions\nhttps://mooseframework.inl.gov/application_development/debugging.html",
                          "url": "https://github.com/idaholab/moose/discussions/28781#discussioncomment-10919480",
                          "updatedAt": "2024-10-11T21:42:13Z",
                          "publishedAt": "2024-10-11T21:41:39Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "Help with using Paraview for visualizing",
          "author": {
            "login": "ColinMG2"
          },
          "bodyText": "I have been trying to use paraview through conda in the Ubuntu terminal to visualize a _in.e file. Here is my error: qt.qpa.xcb: could not connect to display 10.255.255.254:0.0\nqt.qpa.plugin: From 6.5.0, xcb-cursor0 or libxcb-cursor0 is needed to load the Qt xcb platform plugin.\nqt.qpa.plugin: Could not load the Qt platform plugin \"xcb\" in \"\" even though it was found.\nThis application failed to start because no Qt platform plugin could be initialized. Reinstalling the application may fix this problem.\nAvailable platform plugins are: vkkhrdisplay, vnc, xcb, offscreen, minimal, linuxfb, eglfs, minimalegl.\nDoes anyone know how to resolve this issue?",
          "url": "https://github.com/idaholab/moose/discussions/28784",
          "updatedAt": "2024-10-11T16:09:52Z",
          "publishedAt": "2024-10-05T23:28:45Z",
          "category": {
            "name": "Q&A Tools"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\nFor now you should simply install paraview on the windows side and use that.\nI recall @milljm had some good first steps to add missing packages on the Ubuntu side. I dont recall if that was enough\nI think we recommended installing paraview from the paraview website on the Ubuntu side. This takes care of some missing dependencies in conda\nGuillaume",
                  "url": "https://github.com/idaholab/moose/discussions/28784#discussioncomment-10855483",
                  "updatedAt": "2024-10-06T00:00:12Z",
                  "publishedAt": "2024-10-05T23:59:36Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "milljm"
                          },
                          "bodyText": "10.255.255.254:0.0\n\nThis makes me think you are operating within a WSL instance? If you are, there are sometimes additional steps one needs to take to allow Linux GUI apps to connect to the Windows GUI.\nOn top of the things listed on our WSL Instructions, you may find additional tricks to try from this long thread: #22718 (reply in thread).",
                          "url": "https://github.com/idaholab/moose/discussions/28784#discussioncomment-10867782",
                          "updatedAt": "2024-10-07T13:32:02Z",
                          "publishedAt": "2024-10-07T13:32:01Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "ColinMG2"
                          },
                          "bodyText": "Yes I am using WSL. I have been trying to find the additional steps to allow Linux GUI apps to connect to the Windows GUI but I can't seem to find them.",
                          "url": "https://github.com/idaholab/moose/discussions/28784#discussioncomment-10872622",
                          "updatedAt": "2024-10-07T19:56:12Z",
                          "publishedAt": "2024-10-07T19:56:11Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "milljm"
                          },
                          "bodyText": "I would start here: https://learn.microsoft.com/en-us/windows/wsl/tutorials/gui-apps\nAnd see if you can get any of the examples they describe working (like GIMP).",
                          "url": "https://github.com/idaholab/moose/discussions/28784#discussioncomment-10879737",
                          "updatedAt": "2024-10-08T12:44:37Z",
                          "publishedAt": "2024-10-08T12:44:35Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "ColinMG2"
                          },
                          "bodyText": "I was able to get Tilix (a virtual Linux terminal) to work. I am actually able to run moose on there but I still run into the same error message when I try to run the \"paraview\" command on a _in.e or _out.e file.",
                          "url": "https://github.com/idaholab/moose/discussions/28784#discussioncomment-10895980",
                          "updatedAt": "2024-10-09T18:44:11Z",
                          "publishedAt": "2024-10-09T18:44:10Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "ColinMG2"
                          },
                          "bodyText": "I was able to get it to work by running the following:\nsudo apt install xterm\nexport DISPLAY=:1.0\nxterm\nThe output was as follows:\nReading package lists... Done\nBuilding dependency tree... Done\nReading state information... Done\nxterm is already the newest version (372-1ubuntu1).\n0 upgraded, 0 newly installed, 0 to remove and 2 not upgraded.\nxterm: Xt error: Can't open display: :1.0\nBy running export DISPLAY=:0 this fixes the error I got in the output message. I can now run paraview through a conda environment and it will open a Linux GUI for Paraview.",
                          "url": "https://github.com/idaholab/moose/discussions/28784#discussioncomment-10896225",
                          "updatedAt": "2024-10-09T19:08:00Z",
                          "publishedAt": "2024-10-09T19:07:59Z",
                          "isAnswer": true
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "milljm"
                          },
                          "bodyText": "Interesting, usually the IP address is required. I'll mark your post as the answer. Let me know if this does not work for you!",
                          "url": "https://github.com/idaholab/moose/discussions/28784#discussioncomment-10897080",
                          "updatedAt": "2024-10-09T20:51:02Z",
                          "publishedAt": "2024-10-09T20:51:01Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "ColinMG2"
                          },
                          "bodyText": "This link here helped me out with this problem. https://forum.qt.io/topic/132855/qt-qpa-xcb-could-not-connect-to-display-1-0-qt-qpa-plugin-could-not-load-the-qt-platform-plugin-xcb-in-even-though-it-was-found",
                          "url": "https://github.com/idaholab/moose/discussions/28784#discussioncomment-10917265",
                          "updatedAt": "2024-10-11T16:09:53Z",
                          "publishedAt": "2024-10-11T16:09:52Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "Grain Area",
          "author": {
            "login": "Emmanuel-324"
          },
          "bodyText": "Hello everyone. I am trying to calculate the precipitate area of my domain using the postprocessor below:\n [./gr1area]\n      type = ElementIntegralVariablePostprocessor\n      variable = eta1\n      execute_on = 'initial timestep_end'\n  [../]\n   [./gr3area]\n      type = ElementIntegralVariablePostprocessor\n      variable = eta3\n      execute_on = 'initial timestep_end'\n  [../]\n\nThe data I get after the simulation does not accurately represent my problem.\nAfter the simulation and analyzing my results. The percentage precipitate area is about 1.6% which is far from the true case. I am expecting precipitate area between 30%-40%.\nAttached is a picture of my domain(last timestep) and my plot for the area fraction. The csv file is also attached.\n\n\nTwo_phase_noload_c11_table.csv",
          "url": "https://github.com/idaholab/moose/discussions/28777",
          "updatedAt": "2024-10-11T15:35:00Z",
          "publishedAt": "2024-10-04T19:59:30Z",
          "category": {
            "name": "Q&A Modules: Phase field"
          },
          "comments": {
            "edges": []
          }
        }
      },
      {
        "node": {
          "title": "Adding Action to my app",
          "author": {
            "login": "jessecarterMOOSE"
          },
          "bodyText": "Check these boxes if you have followed the posting rules.\n\n Q&A General is the most appropriate section for my question\n I have consulted the posting Guidelines on the Discussions front page\n I have searched the Discussions forum and my question has not been asked before\n I have searched the MOOSE website and the documentation does not answer my question\n I have formatted my post following the posting guidelines (screenshots as a last resort, triple back quotes around pasted text)\n\nQuestion\nI made a new App (\"Foo\") with the stork script using recent devel and I'm trying to create an Action called MyAction. It's just a placeholder for now. The app compiles fine when with just the MyAction source/header files, but fails when I to register in FooApp.C with registerSyntax(\"MyAction\", \"CustomSyntaxHere\"); in the registerAll method.\nError:\nIn file included from /home/jesse/projects/moose/framework/build/header_symlinks/MooseApp.h:26,\n                 from /home/jesse/projects/foo/build/header_symlinks/FooApp.h:12,\n                 from /home/jesse/projects/foo/src/base/FooApp.C:1,\n                 from /home/jesse/projects/foo/build/unity_src/base_Unity.C:2:\n/home/jesse/projects/foo/src/base/FooApp.C: In static member function 'static void FooApp::registerAll(Factory&, ActionFactory&, Syntax&)':\n/home/jesse/projects/moose/framework/build/header_symlinks/ActionFactory.h:26:3: error: invalid use of member function 'Syntax& MooseApp::syntax()' (did you forget the '()' ?)\n   26 |   syntax.registerActionSyntax(action, action_syntax, \"\", __FILE__, __LINE__)\n      |   ^~~~~~\n/home/jesse/projects/moose/framework/build/header_symlinks/ActionFactory.h:26:3: note: in definition of macro 'registerSyntax'\n   26 |   syntax.registerActionSyntax(action, action_syntax, \"\", __FILE__, __LINE__)\n      |   ^~~~~~\n\n\nMyAction.C:\n#include \"MyAction.h\"\n#include \"Factory.h\"\n#include \"Parser.h\"\n#include \"FEProblem.h\"\n\nregisterMooseAction(\"FooApp\", MyAction, \"add_kernel\");\n\nInputParameters\nMyAction::validParams()\n{\n  InputParameters params = Action::validParams();\n\n  return params;\n}\n\nMyAction::MyAction(const InputParameters & params)\n  : Action(params)\n{\n}\n\nvoid\nMyAction::act()\n{\n}\n\nMyAction.h:\n#pragma once\n\n#include \"Action.h\"\n\nclass MyAction : public Action\n{\npublic:\n  MyAction(const InputParameters & params);\n\n  static InputParameters validParams();\n\n  virtual void act() override;\n};",
          "url": "https://github.com/idaholab/moose/discussions/28826",
          "updatedAt": "2024-10-11T14:56:16Z",
          "publishedAt": "2024-10-10T16:53:49Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\nThe macro registerSyntax is trying to use a Syntax object called syntax\nI think it might be called 's' instead of syntax in this routine\nYou can add\nauto & syntax =s; before the registerSyntax call",
                  "url": "https://github.com/idaholab/moose/discussions/28826#discussioncomment-10907590",
                  "updatedAt": "2024-10-10T18:43:34Z",
                  "publishedAt": "2024-10-10T18:43:23Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "jessecarterMOOSE"
                          },
                          "bodyText": "That did it. Thanks.... Would this be considered a bug?",
                          "url": "https://github.com/idaholab/moose/discussions/28826#discussioncomment-10914640",
                          "updatedAt": "2024-10-11T11:51:29Z",
                          "publishedAt": "2024-10-11T11:51:29Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "It s probably just that your app was created when it was s  for the parameter and now it's syntax",
                          "url": "https://github.com/idaholab/moose/discussions/28826#discussioncomment-10915513",
                          "updatedAt": "2024-10-11T13:23:48Z",
                          "publishedAt": "2024-10-11T13:23:48Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "jessecarterMOOSE"
                          },
                          "bodyText": "No this is a brand new app that I made to test",
                          "url": "https://github.com/idaholab/moose/discussions/28826#discussioncomment-10915884",
                          "updatedAt": "2024-10-11T13:57:48Z",
                          "publishedAt": "2024-10-11T13:57:46Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "alright then yes it s a bug the macro should work on new apps not just old apps",
                          "url": "https://github.com/idaholab/moose/discussions/28826#discussioncomment-10916515",
                          "updatedAt": "2024-10-11T14:56:09Z",
                          "publishedAt": "2024-10-11T14:56:08Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "I ll put up a patch",
                          "url": "https://github.com/idaholab/moose/discussions/28826#discussioncomment-10916518",
                          "updatedAt": "2024-10-11T14:56:16Z",
                          "publishedAt": "2024-10-11T14:56:16Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "Previous and current variable values in pre-SMO calculation",
          "author": {
            "login": "NateAM"
          },
          "bodyText": "Check these boxes if you have followed the posting rules.\n\n Q&A General is the most appropriate section for my question\n I have consulted the posting Guidelines on the Discussions front page\n I have searched the Discussions forum and my question has not been asked before\n I have searched the MOOSE website and the documentation does not answer my question\n I have formatted my post following the posting guidelines (screenshots as a last resort, triple back quotes around pasted text)\n\nQuestion\nI'm using the automatic scaling calculation for a simulation using a custom kernel which requires both the previous and current value of the field variables and their gradients. When the pre-SMO calculation runs I've noticed that that the previous and current field variable values are the same. Is this intended behavior or does it seem like there is a bug somewhere?\nThe executioner part of my input deck is\n[Executioner]\n  type = Transient\n  solve_type = NEWTON\n  petsc_options_iname = \"-pc_type -pc_factor_mat_solver_package\"\n  petsc_options_value = \"lu       superlu_dist                 \"\n  line_search = none\n  automatic_scaling = true\n  nl_rel_tol = 1e-5\n  nl_abs_tol = 1e-7\n  nl_max_its = 50\n  start_time = 0.0\n  end_time = 1.0\n  dtmin = 1e-12\n  dtmax= 0.1\n  [TimeStepper]\n    type = IterationAdaptiveDT\n    optimal_iterations = 4\n    iteration_window = 3\n    linear_iteration_ratio = 1000\n    growth_factor=1.2\n    cutback_factor=0.5\n    dt = 0.1\n  []\n[]\n\nI'm not completely sure that the identical values are happening during the pre-SMO calculation because my kernel fails to converge (due to the two deformations being the same) and it throws an exception that MOOSE catches. I recognize that the kernel-specific output won't make much sense, but you can see that the variables u and phi, and their gradients are identical for the current and previous timestep. All of the messages from my kernel are between the \"=\"s.\nTime Step 1, time = 0.1, dt = 0.1\nPre-SMO residual: 0.318904\nCurrently Executing\n    Computing Pre-SMO Residual\n      Finished Computing Residual                                                        [  9.47 s] [  174 MB]\n    Finished Computing Pre-SMO Residual                                                  [  9.47 s] [  174 MB]\n\nPerforming automatic scaling calculation\n\n    Computing Automatic Scaling\n      Computing Jacobian                                                                 [  7.42 s] [  174 MB]\n    Finished Computing Automatic Scaling                                                 [  7.42 s] [  174 MB]\n    Computing Residual.                                                                  [ 12.47 s] [  174 MB]\n 0 Nonlinear |R| = 1.696577e-01\n    Computing Jacobian...                                                                [ 20.69 s] [  202 MB]\n      0 Linear |R| = 1.696577e-01\n      1 Linear |R| = 1.391660e-16\n    Finished Computing Residual                                                          [  9.52 s] [  555 MB]\n 1 Nonlinear |R| = 3.266552e-03\n    Computing Jacobian..                                                                 [ 19.01 s] [  557 MB]\n      0 Linear |R| = 3.266552e-03\n      1 Linear |R| = 2.854340e-18\n    Finished Computing Residual                                                          [  9.45 s] [  557 MB]\n 2 Nonlinear |R| = 1.907495e-05\n    Computing Jacobian..                                                                 [ 19.00 s] [  558 MB]\n      0 Linear |R| = 1.907495e-05\n      1 Linear |R| = 2.836699e-20\n    Finished Computing Residual                                                          [  9.45 s] [  557 MB]\n 3 Nonlinear |R| = 8.579929e-08\n Solve Converged!\n  Finished Solving                                                                       [126.32 s] [  408 MB]\n\nOutlier Variable Residual Norms:\n  disp_z: 8.389971e-08\n\nPostprocessor Values:\n+----------------+----------------+\n| time           | bot_react_z    |\n+----------------+----------------+\n|   0.000000e+00 |   0.000000e+00 |\n|   1.000000e-01 |   5.104526e+02 |\n+----------------+----------------+\n\n\nTime Step 2, time = 0.2, dt = 0.1\n\n    Computing Pre-SMO Residual\n      Computing Residual.                                                                [ 10.11 s] [  408 MB]\nPre-SMO residual: 0.322034\n    Finished Computing Pre-SMO Residual                                                  [ 10.12 s] [  408 MB]\n\nA MooseException was raised during FEProblemBase::computeResidualTags\n\n==========================\nConvergence not achieved in material model. Requesting timestep cutback.\n0 : Failure in relaxed solve\nINPUT PARAMETERS FOLLOW:\ntime:\n 2.000000e-01, 1.000000e-01,\n\nfparams:\n 2.000000e+00, 1.000000e+04, 1.000000e-08, 2.000000e+00, 3.192203e+00, -3.167845e+01, 2.000000e+00, 1.000000e+04, 1.000000e-08, 2.000000e+00, 0.000000e+00, 0.000000e+00, 2.000000e+00, 0.000000e+00, 0.000000e+00, 2.000000e+00, 0.000000e+00, 0.000000e+00, 2.000000e+00, 0.000000e+00, 0.000000e+00, 2.000000e+00, 0.000000e+00, 0.000000e+00, 2.000000e+00, 0.000000e+00, 0.000000e+00, 2.000000e+00, 6.964416e+02, 1.267138e+02, 5.000000e+00, -1.867498e+01, -3.781732e+01, 1.517765e+01, -2.407120e+01, -5.861821e+00, 1.100000e+01, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 7.925235e+02, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 2.000000e+00, -3.781732e+01, -5.861821e+00, 5.000000e-01, 5.000000e-01, 5.000000e-01, 1.000000e-09, 1.000000e-09,\n\ncurrent_grad_u:\n 1.055797e-03, 5.136526e-04, 1.843982e-03,\n 4.002290e-04, 1.684113e-03, 2.357700e-03,\n -2.437182e-05, -9.028907e-05, -7.940004e-02,\n\ncurrent_phi:\n -1.956531e-04, 3.049702e-06, 1.765037e-05, 2.840806e-06, -1.943198e-04, 2.230603e-05, -1.359193e-05, -1.715515e-05, -3.393720e-04,\n\ncurrent_grad_phi:\n -1.945539e-05, -2.592158e-05, -5.862817e-05,\n -3.320356e-06, -3.467268e-06, -2.339044e-07,\n -2.038262e-05, -4.046447e-06, 1.301341e-05,\n -3.317225e-06, -1.923737e-06, -2.083438e-07,\n -1.566101e-05, -3.290013e-05, -5.876160e-05,\n -3.335579e-06, -2.500360e-05, 1.655791e-05,\n 1.558924e-05, 2.839010e-06, -7.544714e-06,\n 2.378279e-06, 1.869235e-05, -9.588049e-06,\n -1.327543e-05, -2.236166e-05, -8.576912e-05,\n\nprevious_grad_u:\n 1.055797e-03, 5.136526e-04, 1.843982e-03,\n 4.002290e-04, 1.684113e-03, 2.357700e-03,\n -2.437182e-05, -9.028907e-05, -2.470542e-02,\n\nprevious_phi:\n -1.956531e-04, 3.049702e-06, 1.765037e-05, 2.840806e-06, -1.943198e-04, 2.230603e-05, -1.359193e-05, -1.715515e-05, -3.393720e-04,\n\nprevious_grad_phi:\n -1.945539e-05, -2.592158e-05, -5.862817e-05,\n -3.320356e-06, -3.467268e-06, -2.339044e-07,\n -2.038262e-05, -4.046447e-06, 1.301341e-05,\n -3.317225e-06, -1.923737e-06, -2.083438e-07,\n -1.566101e-05, -3.290013e-05, -5.876160e-05,\n -3.335579e-06, -2.500360e-05, 1.655791e-05,\n 1.558924e-05, 2.839010e-06, -7.544714e-06,\n 2.378279e-06, 1.869235e-05, -9.588049e-06,\n -1.327543e-05, -2.236166e-05, -8.576912e-05,\n\nSDVS:\n 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,\n\ncurrent_ADD_DOF:\n\ncurrent_ADD_grad_DOF:\n\nprevious_ADD_DOF:\n\nprevious_ADD_grad_DOF:\n\n\nTo recover, the solution will fail and then be re-attempted with a reduced time step.\n==========================\n\n  Nonlinear solve did not converge due to DIVERGED_FUNCTION_DOMAIN iterations 0\n Solve Did NOT Converge!\n  Finished Solving                                                                       [ 13.82 s] [  408 MB]\nAborting as solve did not converge",
          "url": "https://github.com/idaholab/moose/discussions/28762",
          "updatedAt": "2024-10-11T03:13:10Z",
          "publishedAt": "2024-10-03T05:23:13Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\nWhat is SDVs?\nAnd ADD?\nIn any case, you should not be using the pre-SMO residual?\nuse_pre_SMO_residual should be set to False by default.\nI think you may be using a legacy application that still uses those. See this announcement for the deprecation of using the pre-SMO residual\nhttps://mooseframework.inl.gov/newsletter/2024/2024_04.html\nOtherwise, how do you retrieve the current and previous value in the code?",
                  "url": "https://github.com/idaholab/moose/discussions/28762#discussioncomment-10836196",
                  "updatedAt": "2024-10-03T20:28:34Z",
                  "publishedAt": "2024-10-03T20:28:32Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "NateAM"
                          },
                          "bodyText": "@GiudGiud\nSorry for the confusion, those are internal variables that are passed from my kernel to a material.\n\nIn any case, you should not be using the pre-SMO residual?\nuse_pre_SMO_residual should be set to False by default.\nI think you may be using a legacy application that still uses those. See this announcement for the deprecation of using the pre-SMO residual\nhttps://mooseframework.inl.gov/newsletter/2024/2024_04.html\n\nOh, okay. I wanted to get the values of my materials as outputs in the initial state. Is there a correct way to do this or will it always be assumed that they are zero to start?\n\nOtherwise, how do you retrieve the current and previous value in the code?\n\nI collect the previous and current values of the degrees of freedom by declaring in myKernel.h:\n        const VariableValue    & _u1;\n        const VariableValue    & _u2;\n        const VariableValue    & _u3;\n        const VariableGradient & _grad_u1;\n        const VariableGradient & _grad_u2;\n        const VariableGradient & _grad_u3;\n\n        ...\n\n        const VariableValue    & _old_u1;\n        const VariableValue    & _old_u2;\n        const VariableValue    & _old_u3;\n        const VariableGradient & _old_grad_u1;\n        const VariableGradient & _old_grad_u2;\n        const VariableGradient & _old_grad_u3;\n        ...\n\nand then in myKernel.C in the constructor\nmyKernel::myKernel( const InputParameters & parameters ){\n    ...\n    _u1(coupledValue(\"u1\")),\n    _u2(coupledValue(\"u2\")),\n    _u3(coupledValue(\"u3\")),\n    _grad_u1(coupledGradient(\"u1\")),\n    _grad_u2(coupledGradient(\"u2\")),\n    _grad_u3(coupledGradient(\"u3\")),\n    ...\n    _old_u1(coupledValueOld(\"u1\")),\n    _old_u2(coupledValueOld(\"u2\")),\n    _old_u3(coupledValueOld(\"u3\")),\n    _old_grad_u1(coupledGradientOld(\"u1\")),\n    _old_grad_u2(coupledGradientOld(\"u2\")),\n    _old_grad_u3(coupledGradientOld(\"u3\")),\n    ...\n\nMaybe it's just because the pre-SMO calculation is depreciated that there is this problem at all?",
                          "url": "https://github.com/idaholab/moose/discussions/28762#discussioncomment-10837480",
                          "updatedAt": "2024-10-03T20:58:59Z",
                          "publishedAt": "2024-10-03T20:58:58Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "I wanted to get the values of my materials as outputs in the initial state.\n\nYou can work on setting an initial state of stateful material properties using this action\nhttps://mooseframework.inl.gov/source/actions/ProjectedStatefulMaterialStorageAction.html\nand using the use_interpolated_state parameter on consumers of material properties\nIt's complicated. Do you really need the old value? Is this for a restart simulation?\nCould you just use a different expression for the material on the first time step?",
                          "url": "https://github.com/idaholab/moose/discussions/28762#discussioncomment-10837670",
                          "updatedAt": "2024-10-03T21:29:49Z",
                          "publishedAt": "2024-10-03T21:29:49Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "I collect the previous and current values of the degrees of freedom by declaring in myKernel.h:\n\nok this looks correct.\n\nMaybe it's just because the pre-SMO calculation is depreciated that there is this problem at all?\n\nIt's not deprecated, it's just that the old values of anything is not generally used on the first time step, because they dont generally exist. I would expect them to return 0, but turns out they return the current value. This is probably a safer value for most problems, just not for yours",
                          "url": "https://github.com/idaholab/moose/discussions/28762#discussioncomment-10837678",
                          "updatedAt": "2024-10-03T21:31:12Z",
                          "publishedAt": "2024-10-03T21:31:12Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "NateAM"
                          },
                          "bodyText": "It's complicated. Do you really need the old value? Is this for a restart simulation?\nCould you just use a different expression for the material on the first time step?\n\nOkay, it's mostly just for plotting purposes so maybe I don't. I don't explicitly ask for Pre-SMO anywhere in my input deck so this could be a function of my main.C not being updated to the new standard. I'll try and update and see what happens.\n\nIt's not deprecated, it's just that the old values of anything is not generally used on the first time step, because they dont generally exist. I would expect them to return 0, but turns out they return the current value. This is probably a safer value for most problems, just not for yours\n\nThat makes sense to me. What is confusing to me is that at every time step the pre-SMO residual is called and if my kernel can't converge locally in the pre-SMO residual I find that the current and previous values are the same even when it isn't the first time step. Is that expected?",
                          "url": "https://github.com/idaholab/moose/discussions/28762#discussioncomment-10839365",
                          "updatedAt": "2024-10-04T03:09:17Z",
                          "publishedAt": "2024-10-04T03:09:16Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "I dont think so.\nIf you could make a minimal non-working example I can take a look",
                          "url": "https://github.com/idaholab/moose/discussions/28762#discussioncomment-10839502",
                          "updatedAt": "2024-10-04T03:34:43Z",
                          "publishedAt": "2024-10-04T03:34:42Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "NateAM"
                          },
                          "bodyText": "@GiudGiud\nSorry it's taken me a while to respond. I updated to the most recent version of MOOSE and I'm not able to reproduce the error so maybe this was something that was fixed. I'm still getting the warnings:\nLEGACY MODES ENABLED:\n This application uses the legacy material output option: material properties are output only on TIMESTEP_END, not INITIAL. To remove this message, set 'use_legacy_material_output' to false in this application. If there are gold output files that contain material property output for which output occurs on INITIAL, then these will generate diffs due to zero values being stored, and these tests should be re-golded.\n\nLEGACY MODES ENABLED:\n This application uses the legacy initial residual evaluation behavior. The legacy behavior performs an often times redundant residual evaluation before the solution modifying objects are executed prior to the initial (0th nonlinear iteration) residual evaluation. The new behavior skips that redundant residual evaluation unless the parameter Executioner/use_pre_smo_residual is set to true. To remove this message and enable the new behavior, set the parameter 'use_legacy_initial_residual_evaluation_behavior' to false in *App.C. Some tests that rely on the side effects of the legacy behavior may fail/diff and should be re-golded.\n\n\nThough I don't think I have enabled the pre-SMO explicitly. My executioner has the form:\n[Executioner]\n  type = Transient\n  solve_type = NEWTON\n  petsc_options_iname = \"-pc_type -pc_factor_mat_solver_package\"\n  petsc_options_value = \"lu       superlu_dist                 \"\n  line_search = none\n  automatic_scaling = true\n  nl_rel_tol = 1e-5\n  nl_abs_tol = 1e-7\n  nl_max_its = 10\n  start_time = 0.0\n  end_time = 1.0\n  dtmin = 1e-12\n  dtmax= 0.1\n  [TimeStepper]\n    type = IterationAdaptiveDT\n    optimal_iterations = 5\n    iteration_window = 1\n    linear_iteration_ratio = 1000\n    growth_factor=1.2\n    cutback_factor=0.5\n    dt = 0.1\n  []\n[]\n\nSo does it have to do with using automatic_scaling?",
                          "url": "https://github.com/idaholab/moose/discussions/28762#discussioncomment-10910456",
                          "updatedAt": "2024-10-11T02:40:59Z",
                          "publishedAt": "2024-10-11T02:40:59Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Automatic scaling does trigger an earlier Jacobian evaluation . So a similar effect as the legacy preSMO behavior",
                          "url": "https://github.com/idaholab/moose/discussions/28762#discussioncomment-10910649",
                          "updatedAt": "2024-10-11T03:13:11Z",
                          "publishedAt": "2024-10-11T03:13:10Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "Error with AuxKernal: Invalid function, Syntax error: Unknown identifier",
          "author": {
            "login": "wlindqwister"
          },
          "bodyText": "Check these boxes if you have followed the posting rules.\n\n I have consulted the Posting Guidelines.\n I have searched the Discussions Forum and MOOSE Framework Troubleshooting and have not found what I was looking for\n Q&A Getting Started is the most appropriate category for my question (trouble installing, beginner user, ...)\n\nIssue or question about MOOSE\nHello everyone, I'm relatively new with MOOSE and am trying to calculate an auxiliary variable 'density' based off of nodal distance from a boundary using the the NearestNodeDistanceAux aux kernal paired with ParsedAux (one step beyond what is demonstrated here. I keep running into the following error when trying to calculate:\n\"The following error occurred in the AuxKernel 'density' of type ParsedAux.\nInvalid function\ndistance^2\nin ParsedAux density.\nSyntax error: Unknown identifier\"\nHere is the input file I've been using:\n[Mesh]\n    [file_mesh]\n        type = FileMeshGenerator\n        file = meshes/1H_test.msh\n    []\n    [interior_nodeset]\n        type = BoundingBoxNodeSetGenerator\n        new_boundary = interior_nodeset\n        bottom_left = '-0.01 -0.01 -0.01'\n        top_right = '1.01 1.01 1.01'\n        input = file_mesh\n    []\n[]\n\n[Variables]\n    [./u]\n    [../]\n[]\n\n[AuxVariables]\n    [./distance]\n    [../]\n    [./penetration]\n    [../]\n    [./density]\n    [../]\n[]\n\n[AuxKernels]\n    [./nodal_distance_aux]\n        type = NearestNodeDistanceAux\n        variable = distance\n        boundary = interior_nodeset\n        paired_boundary = hydrosurf\n    [../]\n    [./penetration_aux]\n        type = PenetrationAux\n        variable = penetration\n        boundary = interior_nodeset\n        paired_boundary = hydrosurf\n    [../]\n    [./density]\n        type = ParsedAux\n        variable = density\n        coupled_variable = 'distance'\n        expression = 'distance^2'\n    [../]\n[]\n\n[Problem]\n    type = FEProblem\n    solve = false\n[]\n\n[Executioner]\n    type = Steady\n[]\n\n[Outputs]\n    file_base = densityTest1Hole\n    execute_on = 'timestep_end'\n    exodus = true\n[]\n\nI've looked through the examples on the website and I can't find where my syntax is incorrect. Any help would be greatly appreciated!\n(Optional) code in question / simulation log / errors\nNo response\nEncountering Errors? Please include diagnostic output\nNo response",
          "url": "https://github.com/idaholab/moose/discussions/28157",
          "updatedAt": "2024-10-10T10:30:35Z",
          "publishedAt": "2024-07-17T10:28:13Z",
          "category": {
            "name": "Q&A Getting Started"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "wlindqwister"
                  },
                  "bodyText": "Never mind, I found a small syntax error in ParsedAux that I overlooked. My bad!",
                  "url": "https://github.com/idaholab/moose/discussions/28157#discussioncomment-10072564",
                  "updatedAt": "2024-07-17T11:27:13Z",
                  "publishedAt": "2024-07-17T11:27:12Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "EDIT: (I'm replying to another poster who seemed to have deleted their message)\nYou either have a typo in the expression\nOr one of the terms in the expression should be in one of the other parameters that describe what type it is\nFor example a variable should be specified in coupled_variables, a functor in functor_symbols",
                          "url": "https://github.com/idaholab/moose/discussions/28157#discussioncomment-10902555",
                          "updatedAt": "2024-10-10T10:44:47Z",
                          "publishedAt": "2024-10-10T10:13:01Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "MOOSE on copenhagen university HPC",
          "author": {
            "login": "AndreasHjortsoe"
          },
          "bodyText": "Check these boxes if you have followed the posting rules.\n\n I have consulted the Posting Guidelines.\n I have searched the Discussions Forum and MOOSE Framework Troubleshooting and have not found what I was looking for\n Q&A Getting Started is the most appropriate category for my question (trouble installing, beginner user, ...)\n\nIssue or question about MOOSE\nIssue description\nI am trying to install MOOSE on a HPC cluster in copenhagen.\nI initialize with:\n\nmodule load mpi/mpich-x86_64\nexport CC=mpicc CXX=mpicxx FC=mpif90 F90=mpif90 F77=mpif77\nexport HDF5_DIR=/usr (i tried fixing my issues with this, in order to make sure HDF5 was the correct version, but to no avail)\n\nWhen i run \"./update_and_rebuild_petsc.sh\":\n\nI have added \"  CC=$CC CXX=$CXX FC=$FC F77=$F77 F90=$F90 \" to the configure line in configure_petc.sh\nThere might be issues with HDF5, and this may be the cause. This is the reason i added export HDF5_DIR.\n\nWhen i run \"./update_and_rebuild_libmesh.sh\":\ni got errors, showing that there was no available MPI_Comm, indicating that there are issues with libmesh finding my MPI.\n\nI fixed this by adding  \"--with-mpi-include=\"/usr/include/mpich-x86_64\" to the configure line in moose/scripts/configure_libmesh.sh\n\nNow i can run \"./update_and_rebuild_wasp.sh\", and make without errors.\nRunning tests\nAfter running make, i tried ./run_tests, which yeilded 51/51 failed tests. Can anyone help with troubleshooting please?\nOutput from running ./run_tests -i always_bad: i am unsure why it takes so long to run. Yesterday it ran much faster, but today it is slow. Yesterday i got CODE 1 error for both, instead of the TIMEOUT error.\n[hjortso@hep03 test]$ ./run_tests -i always_bad\ntests/test_harness.always_ok ......................................................................... RUNNING\ntests/test_harness.always_ok: Working Directory: /lustre/hpc/hep/hjortso/temp_dir/moose/test/tests/test_harness\ntests/test_harness.always_ok: Running command: /lustre/hpc/hep/hjortso/temp_dir/moose/test/moose_test-opt -i good.i --error --error-override --libtorch-device cpu\ntests/test_harness.always_ok:\ntests/test_harness.always_ok ..................................................... [FINISHED] FAILED (TIMEOUT)\ntests/test_harness.always_bad: Working Directory: /lustre/hpc/hep/hjortso/temp_dir/moose/test/tests/test_harness\ntests/test_harness.always_bad: Running command: false\ntests/test_harness.always_bad:\ntests/test_harness.always_bad: ################################################################################\ntests/test_harness.always_bad: Tester failed, reason: CODE 1\ntests/test_harness.always_bad:\ntests/test_harness.always_bad ................................................................ FAILED (CODE 1)\n\n\nFinal Test Results:\n--------------------------------------------------------------------------------------------------------------\ntests/test_harness.always_ok ..................................................... [FINISHED] FAILED (TIMEOUT)\ntests/test_harness.always_bad ................................................................ FAILED (CODE 1)\n--------------------------------------------------------------------------------------------------------------\nRan 2 tests in 571.9 seconds. Average test time 150.0 seconds, maximum test time 300.0 seconds.\n0 passed, 0 skipped, 0 pending, 2 FAILED\n\nDiagnostics output - i see nothing out of the ordinary here, but there might be\n####################################################################################################\nInfluential Environment Variables\nCC=mpicc\nCONDA_CHANNEL=https://conda.software.inl.gov/public\nCURL_CA_BUNDLE=\nCXX=mpicxx\nF77=mpif77\nF90=mpif90\nFC=mpif90\nFI_PROVIDER=tcp\nHDF5_DIR=/usr\nLD_LIBRARY_PATH=/usr/lib64/mpich/lib\nMODULESHOME=/usr/share/lmod/lmod\nMOOSE_JOBS=6\nPATH=/usr/lib64/mpich/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/groups/hep/hjortso/bin\nREQUESTS_CA_BUNDLE=\nSSL_CERT_FILE=\n####################################################################################################\nCompiler(s) (CC CXX FC F77 F90):\nwhich $CC; /usr/lib64/mpich/bin/mpicc\n$CC --version; gcc (GCC) 11.4.1 20231218 (Red Hat 11.4.1-3)\n$CC -show; gcc -O2 -flto=auto -ffat-lto-objects -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -fstack-protector-strong -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -march=x86-64-v2 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -I/usr/include/mpich-x86_64 -L/usr/lib64/mpich/lib -Wl,-rpath -Wl,/usr/lib64/mpich/lib -Wl,--enable-new-dtags -lmpi\nwhich $CXX; /usr/lib64/mpich/bin/mpicxx\n$CXX --version; g++ (GCC) 11.4.1 20231218 (Red Hat 11.4.1-3)\n$CXX -show; g++ -O2 -flto=auto -ffat-lto-objects -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -fstack-protector-strong -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -march=x86-64-v2 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -I/usr/include/mpich-x86_64 -L/usr/lib64/mpich/lib -lmpicxx -Wl,-rpath -Wl,/usr/lib64/mpich/lib -Wl,--enable-new-dtags -lmpi\nwhich $FC; /usr/lib64/mpich/bin/mpif90\n$FC --version; GNU Fortran (GCC) 11.4.1 20231218 (Red Hat 11.4.1-3)\n$FC -show; gfortran -O2 -flto=auto -ffat-lto-objects -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -fstack-protector-strong -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -march=x86-64-v2 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -I/usr/lib64/gfortran/modules -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -I/usr/include/mpich-x86_64 -I/usr/lib64/gfortran/modules/mpich -L/usr/lib64/mpich/lib -lmpifort -Wl,-rpath -Wl,/usr/lib64/mpich/lib -Wl,--enable-new-dtags -lmpi\nwhich $F77; /usr/lib64/mpich/bin/mpif77\n$F77 --version; GNU Fortran (GCC) 11.4.1 20231218 (Red Hat 11.4.1-3)\n$F77 -show; gfortran -O2 -flto=auto -ffat-lto-objects -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -fstack-protector-strong -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -march=x86-64-v2 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -I/usr/lib64/gfortran/modules -fallow-argument-mismatch -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -I/usr/include/mpich-x86_64 -I/usr/lib64/gfortran/modules/mpich -L/usr/lib64/mpich/lib -lmpifort -Wl,-rpath -Wl,/usr/lib64/mpich/lib -Wl,--enable-new-dtags -lmpi\nwhich $F90; /usr/lib64/mpich/bin/mpif90\n$F90 --version; GNU Fortran (GCC) 11.4.1 20231218 (Red Hat 11.4.1-3)\n$F90 -show; gfortran -O2 -flto=auto -ffat-lto-objects -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -fstack-protector-strong -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -march=x86-64-v2 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -I/usr/lib64/gfortran/modules -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -I/usr/include/mpich-x86_64 -I/usr/lib64/gfortran/modules/mpich -L/usr/lib64/mpich/lib -lmpifort -Wl,-rpath -Wl,/usr/lib64/mpich/lib -Wl,--enable-new-dtags -lmpi\nOK\n####################################################################################################\nPython Sanity Checks\n/usr/bin/env python3 --version; (reporting as: Python 3.9.18) matches\nwhich python3 python;\n/usr/bin/python3 --version; == Python 3.9.18\n/usr/bin/python --version; == Python 3.9.18\nOK\n####################################################################################################\nPython Modules (TestHarness, run-ability)\nOK\nchecks PASSED\nNo response",
          "url": "https://github.com/idaholab/moose/discussions/28805",
          "updatedAt": "2024-10-10T10:09:18Z",
          "publishedAt": "2024-10-08T07:26:28Z",
          "category": {
            "name": "Q&A Getting Started"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\nCan you please attach the logs for building petsc (if you think there were issues), libmesh (there is a configure.log) that should help and moose?",
                  "url": "https://github.com/idaholab/moose/discussions/28805#discussioncomment-10879901",
                  "updatedAt": "2024-10-08T12:57:46Z",
                  "publishedAt": "2024-10-08T12:57:45Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "also what does ldd moose_test-opt return ?",
                          "url": "https://github.com/idaholab/moose/discussions/28805#discussioncomment-10881640",
                          "updatedAt": "2024-10-08T15:16:23Z",
                          "publishedAt": "2024-10-08T15:16:23Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "AndreasHjortsoe"
                          },
                          "bodyText": "petcs\nPetsc is building fine, and running the \"make test\" commands stated at the end of the \"update_and_rebuild_petcs\" file work without errors, so petcs probably works, but i have added the configure.log anyways as configure(petcs).\nconfigure(petsc).log\nlibmesh\nI found the output of configure from libmesh in here (libmesh_diagnostic.log):\nlibmesh_diagnostic.log\nMOOSE\nI have now run ./configure in the moose directory to generate the configure file for moose:\nconfig(moose).log\nI found config.status as well, maybe that is usefull for you:\nconfig(moose)txt.txt\nmoose_test yeilds a segmentation error, and ldd_moose_test is below:\nldd_moose_test.out.txt\nThanks for taking a look, i hope this is sufficient! Otherwise please let me know what you need.\nRegards Andreas",
                          "url": "https://github.com/idaholab/moose/discussions/28805#discussioncomment-10891435",
                          "updatedAt": "2024-10-09T11:50:41Z",
                          "publishedAt": "2024-10-09T11:42:36Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Nothing obvious to me.\nCan you run an input in a debugger and get us a backtrace for the error?\nThis is a recent version of moose right?\nhttps://mooseframework.inl.gov/application_development/debugging.html",
                          "url": "https://github.com/idaholab/moose/discussions/28805#discussioncomment-10894596",
                          "updatedAt": "2024-10-09T16:05:11Z",
                          "publishedAt": "2024-10-09T16:05:10Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "AndreasHjortsoe"
                          },
                          "bodyText": "Okay, here it is. It looks like the error is in libmesh, in netgen?\ndebug_info.txt\nI believe the version is the most recent one yes. I have done the steps from \"common installation issues (#27046) \"",
                          "url": "https://github.com/idaholab/moose/discussions/28805#discussioncomment-10901214",
                          "updatedAt": "2024-10-10T08:17:27Z",
                          "publishedAt": "2024-10-10T08:17:09Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Yes it does look like it's coming from netgen.\nSo for now, I recommend you disable netgen by passing --disable-netgen to update_and_rebuild_libmesh.sh\nYou ll have to check the log to check if it actually worked because I seem to remember the option was not listed in the help page though it should be working still\nI ll take care of creating an issue so this can be looked at",
                          "url": "https://github.com/idaholab/moose/discussions/28805#discussioncomment-10902515",
                          "updatedAt": "2024-10-10T10:09:19Z",
                          "publishedAt": "2024-10-10T10:09:17Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "mangerij"
                  },
                  "bodyText": "Hi @AndreasHjortsoe\nI'm actually local up at DTU. Are you using Niflheim? If so, I can probably help out.",
                  "url": "https://github.com/idaholab/moose/discussions/28805#discussioncomment-10882122",
                  "updatedAt": "2024-10-08T15:57:50Z",
                  "publishedAt": "2024-10-08T15:57:49Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "AndreasHjortsoe"
                          },
                          "bodyText": "No, unfortunately i am on a small local HPC here at KU",
                          "url": "https://github.com/idaholab/moose/discussions/28805#discussioncomment-10891444",
                          "updatedAt": "2024-10-09T11:43:34Z",
                          "publishedAt": "2024-10-09T11:43:34Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "LineValueSampler with Threshold problem",
          "author": {
            "login": "TFdvd"
          },
          "bodyText": "Check these boxes if you have followed the posting rules.\n\n Q&A General is the most appropriate section for my question\n I have consulted the posting Guidelines on the Discussions front page\n I have searched the Discussions forum and my question has not been asked before\n I have searched the MOOSE website and the documentation does not answer my question\n I have formatted my post following the posting guidelines (screenshots as a last resort, triple back quotes around pasted text)\n\nQuestion\nHello MOOSE community!\nI have tried to extend and customize the LineValueSampler function. I would like to filter its results by imposing a user-defined threshold and save only the first value above the threshold. After compiling the function and finding no errors, the end result is always a .csv with values = num_points (input parameter) and not the desired single value.\nI enclose the .h and .C in question. Any suggestions?\nThanks! :)\n#pragma once\n\n#include \"VectorPostprocessor.h\"\n\n\n// MOOSE includes\n#include \"PointVariableSamplerBase.h\"\n\nclass NeckLineValueSampler : public PointVariableSamplerBase\n{\npublic:\n  static InputParameters validParams();\n\n  NeckLineValueSampler(const InputParameters & parameters);\n\n  /**\n   * Helper function to generate the list of points along a line and a unique ID for each point.\n   * @param start_point The beginning of the line\n   * @param end_point The end of the line\n   * @param num_points The number of points along the line\n   * @param points The vector of points to fill in\n   * @param ids The vector of ids to fill in\n   */\n  static void generatePointsAndIDs(const Point & start_point,\n                                   const Point & end_point,\n                                   unsigned int num_points,\n                                   std::vector<Point> & points,\n                                   std::vector<Real> & ids);\n\n  /**\n   * Gets the value of the variable at a point p.\n   * Used with MultiAppUserObjectTransfer to transfer\n   * variable information from one domain to another.\n   **/\n  virtual Real spatialValue(const Point & p) const override { return getValue(p); }\n\n  /**\n   * Gets the value of the variable at a point p.\n   * Returns zero if p does not lie along the line segment or if no value is above the threshold.\n   **/\n  Real getValue(const Point & p) const;\n\nprotected:\n  const Point _start_point;\n  const Point _end_point;\n\n  unsigned int & _num_points;\n  \n\n  /// Vector connecting the start and end points of the line segment\n  const RealVectorValue _line_vector;\n\n  /// Zero vector\n  const RealVectorValue _zero;\n\n  /// Length of line segment\n  const Real _line_vector_norm;\n\n \n  /// User-defined threshold\n  \n\nprivate:\n\n  Real _threshold;\n  \n  const VectorPostprocessorValue & _vpp_value;\n    \n};\n\n---------------------------------------------------------------\n#include \"NeckLineValueSampler.h\"\n#include <limits>\n#include \"libmesh/utility.h\"\n\nregisterMooseObject(\"ParrotApp\", NeckLineValueSampler);\n\nInputParameters\nNeckLineValueSampler::validParams()\n{\n  InputParameters params = PointVariableSamplerBase::validParams();\n\n  params.addRequiredParam<Point>(\"start_point\", \"The beginning of the line\");\n  params.addRequiredParam<Point>(\"end_point\", \"The ending of the line\");\n\n  params.addRequiredParam<unsigned int>(\"num_points\",\n                                        \"The number of points to sample along the line\");\n\n  params.addRequiredParam<Real>(\"threshold\", \"The threshold value for sampling\");\n\n  params.addClassDescription(\"Samples variable(s) along a specified line and returns the first value greater than or equal to the threshold.\");\n\n  return params;\n}\n\nNeckLineValueSampler::NeckLineValueSampler(const InputParameters & parameters)\n  : PointVariableSamplerBase(parameters),\n    _start_point(getParam<Point>(\"start_point\")),\n    _end_point(getParam<Point>(\"end_point\")),\n    _num_points(declareRestartableData<unsigned int>(\"num_points\", getParam<unsigned int>(\"num_points\"))),\n    _threshold(getParam<Real>(\"threshold\")),\n    _line_vector(_end_point - _start_point),\n    _line_vector_norm(_line_vector.norm()),  \n    _vpp_value(getVectorPostprocessorValueByName(_vpp_name, _variable_names[0]))\n{\n  if (MooseUtils::absoluteFuzzyEqual(_line_vector_norm, 0.0))\n    mooseError(\"NeckLineValueSampler: `start_point` and `end_point` must be different.\");\n\n  generatePointsAndIDs(_start_point, _end_point, _num_points, _points, _ids);\n}\n\n\nvoid\nNeckLineValueSampler::generatePointsAndIDs(const Point & start_point,\n                                       const Point & end_point,\n                                       unsigned int num_points,\n                                       std::vector<Point> & points,\n                                       std::vector<Real> & ids)\n{\n\n  Point difference = end_point - start_point;\n\n  Point delta = difference / Real(num_points - 1);\n\n  points.resize(num_points);\n  ids.resize(num_points);\n\n\n  for (unsigned int i = 0; i < num_points - 1;\n       i++) // -1 so that we can manually put in the end point to get it perfect\n  {\n    Point p = start_point + (i * delta);\n\n    points[i] = p;\n    ids[i] = (p - start_point).norm(); // The ID is the distance along the line \n  }\n\n  // Add the end point explicitly\n  points[num_points - 1] = end_point;\n  ids[num_points - 1] = (end_point - start_point).norm();\n\n}\n\nReal\nNeckLineValueSampler::getValue(const Point & p) const\n{\n  if (_values.size() != 1)\n    mooseError(\"NeckLineValueSampler: When calling getValue() on NeckLineValueSampler, \"\n               \"only one variable can be provided as input to NeckLineValueSampler.\");\n\n  // Check if vectors are sorted by id\n  if (_sort_by != 3)\n    mooseError(\"NeckLineValueSampler: When calling getValue() on NeckLineValueSampler, \"\n               \"`sort_by` should be set to `id`.\");\n\n  Real value = std::numeric_limits<Real>::infinity();\n\n  Real position =\n      (p - _points[0]) * (_points.back() - _points[0]) / Utility::pow<2>(_line_vector_norm);\n\n  if (position >= 0.0 and position <= 1.0)\n  {\n    unsigned int vec_pos =\n        std::lower_bound(_id.begin(), _id.end(), position * _line_vector_norm) - _id.begin();\n\n    if (MooseUtils::absoluteFuzzyEqual(_id[vec_pos], position * _line_vector_norm))\n      value = _vpp_value[vec_pos];\n    else\n    {\n      mooseWarning(\"Value requested outside of sampled points\");\n      value = (_vpp_value[vec_pos - 1] + _vpp_value[vec_pos]) * 0.5;\n    }\n  }\n\nfor (unsigned int i = 0; i < value; ++i)\n  {\n    if (value >= _threshold)\n    { \n      return value; \n    }\n  }",
          "url": "https://github.com/idaholab/moose/discussions/28818",
          "updatedAt": "2024-10-11T11:38:31Z",
          "publishedAt": "2024-10-09T21:54:22Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\n\nAfter compiling the function and finding no errors, the end result is always a .csv with values = num_points (input parameter) and not the desired single value.\n\nThe number of points comes from the points vector. You did not modify it so that list is the same size as it was.\nfor (unsigned int i = 0; i < value; ++i)\n  {\n    if (value >= _threshold)\n    { \n      return value; \n    }\n  } \n\nThis is very curious logic? You go through every integer under value, then check if value is bigger than a certain number?\nWhy do you need the integer loop?",
                  "url": "https://github.com/idaholab/moose/discussions/28818#discussioncomment-10898968",
                  "updatedAt": "2024-10-10T02:59:17Z",
                  "publishedAt": "2024-10-10T02:59:15Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": []
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "How to solve ODEs with spatial variables coupled",
          "author": {
            "login": "keassyguang"
          },
          "bodyText": "Check these boxes if you have followed the posting rules.\n\n Q&A General is the most appropriate section for my question\n I have consulted the posting Guidelines on the Discussions front page\n I have searched the Discussions forum and my question has not been asked before\n I have searched the MOOSE website and the documentation does not answer my question\n I have formatted my post following the posting guidelines (screenshots as a last resort, triple back quotes around pasted text)\n\nQuestion\nHi everyone,\nI am new to the MOOSE framework, and I am dealing with a set of ODEs with spatial variables. As shown in the example below, x is the spatial position, y is the coordinate in Y direction. m, n, and q are the constants. I want to solve B(x,t) and C(x,t) with given initializations as these two variables will be further used in my material models. I have tried to read the tutorials on the MOOSE website, but I cannot find any relevant examples. Can anyone tell me which Kernels should I use? It will be a great help if someone can show me some examples of how to solve it. Many thanks.\nA(x,t) = A(x,t=0)exp(-y);\ndB(x,t) / dt = mA(x,t)B(x,t) + nB(x,t)C(x,t);\ndC(x,t) / dt = qB(x,t)C(x,t)",
          "url": "https://github.com/idaholab/moose/discussions/28695",
          "updatedAt": "2024-10-10T01:59:56Z",
          "publishedAt": "2024-09-24T12:54:45Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\nODEs in moose are solved by:\n\nscalar kernels for a single ODE with a single degree of freedom for the entire mesh\nnodal kernels for ODEs that live on every node of the mesh\nI think you are in the second case here.\nUse\nhttps://mooseframework.inl.gov/source/nodalkernels/TimeDerivativeNodalKernel.html for dB/dt\nthen modify https://mooseframework.inl.gov/source/nodalkernels/CoupledForceNodalKernel.html to create mAB and nBC terms. Right now this kernel only supports something like mA\n\nDo you want to solve for A? It seems like it's entirely predetermined from its initial condition?",
                  "url": "https://github.com/idaholab/moose/discussions/28695#discussioncomment-10739054",
                  "updatedAt": "2024-09-24T13:13:12Z",
                  "publishedAt": "2024-09-24T13:13:11Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "keassyguang"
                          },
                          "bodyText": "Hi @GiudGiud,\nThank you for your reply.\nAccording to your suggestions, I have checked the ODE related kernels, such as the ODEKernel, ODETimeKernel, and ODETimeDerivative, however, there is no access to the coordinate options provided by these kernels. In that case, how can I calculate A(x,t)? Since B(x,t) is directly related with A(x,t), and A(x,t) is determined by it initial condition and the y coordinate, I am not sure if I can solve the problem within these ODE kernels.\nI want to solve B(x,t) and C(x,t) with given initializations",
                          "url": "https://github.com/idaholab/moose/discussions/28695#discussioncomment-10740041",
                          "updatedAt": "2024-09-24T14:34:04Z",
                          "publishedAt": "2024-09-24T14:33:37Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "The ODETimeDerivative only does the dB/dt (and dC/dt) term. They are applied on each node, (x,t) is automatically used.\nyou then use another kernel for each term, for example mA(x,t)B(x,t)\n\nI want to solve B(x,t) and C(x,t) with given initializations\n\ngreat. I would recommend you use an auxiliary 1st order lagrange for A, and work on setting its value using an auxiliary kernel. For example the ParsedAux auxkernel",
                          "url": "https://github.com/idaholab/moose/discussions/28695#discussioncomment-10740200",
                          "updatedAt": "2024-09-24T14:47:58Z",
                          "publishedAt": "2024-09-24T14:47:08Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "keassyguang"
                          },
                          "bodyText": "Thank you very much for your further explanation.\nFor A(x,t), do you mean use the AuxKernel? I can have a try later. But I have another question, I see the _coord member variable in AuxKernel.h. How do I index it? Normally for the coordinates of the current quadrature point, we can use y = _q_point left square bracket _qp right square bracket(1), but for the coordinate of a node, should I use y = _coord(1)?",
                          "url": "https://github.com/idaholab/moose/discussions/28695#discussioncomment-10740416",
                          "updatedAt": "2024-09-24T15:06:14Z",
                          "publishedAt": "2024-09-24T15:03:25Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "should be something like\n_coord_qp for y.\nbut this might be meant for elemental variables, i dont recall\nuse this for nodes\n  (*_current_node)(1)",
                          "url": "https://github.com/idaholab/moose/discussions/28695#discussioncomment-10740527",
                          "updatedAt": "2024-09-24T15:11:44Z",
                          "publishedAt": "2024-09-24T15:11:43Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "keassyguang"
                          },
                          "bodyText": "I would recommend you use an auxiliary 1st order lagrange for A, and work on setting its value using an auxiliary kernel. For example the ParsedAux auxkernel\n\nBased on your advice:\nFor A(x,t), I create a class, variable = A, requiredParam = A0\n// A(x,t) = A(x,t=0)exp(-y);\nclass AParsedAux: public ParsedAux\nAParsedAux::computeValue()\n{return A0 * std::exp(-_coord(1));}. // not sure for the index of y coord\nFor right hand side of second equation, I also create a class, variable = B, requiredParam = m, n,  requiredCoupledVar = A, C\n// dB(x,t) / dt = mA(x,t)B(x,t) + nB(x,t)C(x,t);\nclass BParsedAux: public ParsedAux\nBParsedAux::computeValue()\n{return - _m*_A*_u - _n*_u*_C;}\nFor right hand side of third equation, I also create a class, variable = C, requiredParam = q,  requiredCoupledVar = B\n// dC(x,t) / dt = qB(x,t)C(x,t)\nclass CParsedAux: public ParsedAux\nCParsedAux::computeValue()\n{return - _q*_B*_u;}\nFor the left side of the second and third equation, ODETimeDerivative kernel will be used. Can you help me check the above simplified code?",
                          "url": "https://github.com/idaholab/moose/discussions/28695#discussioncomment-10751873",
                          "updatedAt": "2024-09-25T13:55:16Z",
                          "publishedAt": "2024-09-25T13:55:15Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "you cant use ParsedAux for B and C, you need to solve the equation there, so you need to use kernels\nA parsedAux for A makes sense because A is not coupled to other variables",
                          "url": "https://github.com/idaholab/moose/discussions/28695#discussioncomment-10752249",
                          "updatedAt": "2024-09-25T14:24:26Z",
                          "publishedAt": "2024-09-25T14:24:26Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "keassyguang"
                          },
                          "bodyText": "Thanks. Should I choose a ODEKernel? For example, ODEKernel, ParsedODEKernel, and so on.\n// dB(x,t) / dt = mA(x,t)B(x,t) + nB(x,t)C(x,t);\nclass BODEKernel: public ODEKernel\nBODEKernel::computeQpResidual()\n{return - _m*_A[_i]_u[_i] - _n_u[_i]_C[_i];}\nBODEKernel::omputeQpJacobian()\n{return - _m_A[_i] - _n*_C[_i];}\n// dC(x,t) / dt = qB(x,t)C(x,t)\nclass CODEKernel: public ODEKernel\nCODEKerne::omputeQpResidual()\n{return - _q*_B[_i]_u[_i];}\nCODEKernel::omputeQpJacobian()\n{return  - _q_B[_i];}",
                          "url": "https://github.com/idaholab/moose/discussions/28695#discussioncomment-10752563",
                          "updatedAt": "2024-09-25T14:48:28Z",
                          "publishedAt": "2024-09-25T14:48:28Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "ODEKernel is only for a single DOFs. It s not for a field, with an ODE at each node",
                          "url": "https://github.com/idaholab/moose/discussions/28695#discussioncomment-10753200",
                          "updatedAt": "2024-09-25T15:40:45Z",
                          "publishedAt": "2024-09-25T15:40:44Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "keassyguang"
                          },
                          "bodyText": "Sorry, I am a bit confused with these kernels. Could you recommend a suitable kernel for this problem? It will be better if the ADKernel can be used as the Jacobian is not easy to get under some situations.",
                          "url": "https://github.com/idaholab/moose/discussions/28695#discussioncomment-10753319",
                          "updatedAt": "2024-09-25T15:48:25Z",
                          "publishedAt": "2024-09-25T15:48:25Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Use an ADNodalKernel then. The nodal kernel i mentioned at the beginning is still the recommended one",
                          "url": "https://github.com/idaholab/moose/discussions/28695#discussioncomment-10753653",
                          "updatedAt": "2024-09-25T16:16:26Z",
                          "publishedAt": "2024-09-25T16:16:25Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      }
    ]
  }
}